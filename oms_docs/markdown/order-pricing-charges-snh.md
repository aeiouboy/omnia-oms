# Shipping and Handling

**Permalink:** order-pricing-charges-snh
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Selling/Order Pricing/Charges/Shipping and Handling
**Content Length:** 38,901 characters
**Scraped:** 2025-08-09T21:58:25.008978

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Selling››Order Pricing››Charges ››Shipping and Handling Shipping and Handling Next Eligible Shipping Methods for an ItemS&H Charge CalculationEnabling S&HS&H Rule ConfigurationCharging S&H on InvoiceCharging S&H and other charges on First InvoiceInvoice Charge Calculations on Exempted Charge TypesServicesUIs and EntitiesImplementation FlavorsHow to retain Fulfillment Group Id when S&H charges are overridden from the call center UIHow to calculate S&H charges externally but apply base S&H promotionHow to honour the highest value S&H charge for multiple shipping methods with the same destination addressHow to override new charges during S&H override for imported ordersTroubleshootingWhy are the S&H taxes not getting prorated after cancellation of an order lineUnable to access the shipping and handling config parameter despite having the necessary permissionsRelated Articles The Shipping & Handling (S&H) component maintains eligible shipping methods for each item and shipping charge rules. Eligible Shipping Methods for an Item When a user is browsing items, a list of eligible shipping methods is displayed for each item. The Shipping Method service is used to retrieve a list of eligible shipping methods for a set of items. If no items are included in the request, then all shipping methods are returned. Currently, Manhattan Active® Omni does not allow to limit Shipping Methods by Delivery Method. For example, one cannot configure ShipToStore to have just one shipping method (say Standard) as an option while ShipToAddress to have multiple shipping methods (say Standard, One-day, Two-Day, and so on). If S&H charges are calculated by the shipping method, as opposed to using a rate basis like order value or volumetric weight, then the S&H charges are also returned as part of this service. The list of shipping methods is sorted from least expensive S&H charge to most expensive. Shipping Methods are sorted in ascending order of S&H charge only if the Rate Basis is "Shipping Method". If the Rate Basis is Order Amount or Volumetric Weight, S&H charges are not sorted in any order. To retrieve eligible shipping methods for an item, the S&H component uses the shipping method data which is stored in the Parcel component. Sample data is included in the following table: Shipping Method Description Parcel Permitted Air Permitted Frozen Permitted Return Shipping Method STD Standard shipping False False False False 2D 2 day shipping True True False False EXP Next day shipping True True True False SD Same day shipping True True True False RET-STD Standard shipping False False False True RET-2D 2 day shipping True True False True RET-EXP Next day shipping True True True True RET-SD Same day shipping True True True True The attributes are used by the S&H component to determine if a shipping method is eligible for an item: If an item does not support parcel shipping but is supported through air and is frozen, then only those shipping methods which support air and frozen shipping methods are listed. For example, large and heavy items cannot be shipped on the same day. In the above example, EXP and SD are eligible. If an item supports parcel but cannot be air shipped and is frozen, then only shipping methods which support frozen and parcel are listed. For example, certain hazmat items cannot be shipped via air. In the above example, EXP and SD are eligible. If an item is non-parcel, cannot be air shipped, and is frozen, then only shipping methods that support frozen, and do not support air or parcel are returned. These shipping methods have refrigerated equipment which is required by frozen items. In the above example, no shipping methods are eligible If a shipping method is designated as a return shipping method, then the shipping method is eligible for return lines. Otherwise, the shipping method is eligible for sale lines. Note: The shipping method for an item is eligible if any of the item handling attributes (Parcel, Air and Frozen) is configured as true and matches with the respective shipping method attributes (Parcel, Air and Frozen). Currently, there is no option to display the shipping method in a specific sequence. In the case of return shipping methods for an item, the above logic is applicable for shipping methods which are marked as "ReturnShippingMethod" = true. S&H Charge Calculation When an order is created or updated, the Order component reaches out to the S&H component to calculate S&H charges for the order lines. The S&H service is controlled by the Calculate S&H attribute in Order Configuration. This configuration provides a set of actions for which S&H can optionally be recalculated. If S&H needs to be recalculated for any additional actions or custom attributes, then a user exit can be added. Note: In case of retailers using out of the box S&H and shipping promo engine, any update to the orders that were imported with shipping charges and shipping promotions will trigger the calculate S&H service to recalculate the shipping charges and shipping promotion. It is necessary to have the same configuration used for imported orders, otherwise, the shipping charges/shipping promotions will be reset. The Shipping Charge Basket service is used for S&H calculation. Charges are calculated per fulfillment group, as groups of items within an order can be shipped in different groups based on service level or destination. Before the Order component sends a request to the S&H component to calculate charges, fulfillment groups must be formed within each order. The order lines that can be fulfilled together can be grouped into a single unit called a fulfillment group. For example, consider an order that has two lines being shipped FedEx Ground to the same California address and a third line being shipped FedEx Ground to a New York address. The two lines being shipped to California form a single fulfillment group, and the third line being shipped to New York forms its own unique fulfillment group. Separate S&H charges are calculated for the California and New York shipments. The Order component identifies and groups order lines into fulfillment groups. Order lines are grouped based on the following attributes: Delivery Method Shipping Method Shipping Address or Ship To Location Id If an order is imported with fulfillment groups populated for each order line, then the Order component will honor the imported values. After order fulfillment groups have been formed, the Order component invokes the S&H component to calculate charges for each fulfillment group. Before calling this service, the Order component needs to populate a flag called "Calculate Shipping Charge" to indicate if S&H charge calculation is required for each order line. If the "Calculate Shipping Charge" flag is set to true, then charges are calculated for the line. This flag is set to false if an exchange line should not be re-priced, or if the delivery method does not require charge calculations. The following table shows the logic to populate this flag: Exchange Line Re-price Exchange Line Shipping Charge Required for Delivery Method Orderline Exempted from "Shipping" Charges Calculate Shipping Charge False NA True Not Defined True False NA True Defined False False NA False NA False True True True NA True True True False NA False True False True NA False True False False NA False In addition to the above logic, the S&H service is not required in the two additional scenarios: If S&H charges have already been calculated by an external system such as e-commerce, then the S&H service is not required during order creation. In these scenarios, orders should be imported with the IsAlreadyCharged attribute set to "false." If the S&H charge has been overridden, then the charge is never recalculated. Note: When the S&H charges are overridden by the call center, the Fulfillment Group Id is set to null. This base behavior cannot be changed. Refer implementation flavor to retain Fulfillment Group Id when charges are overridden. Once the request is received by the S&H component with fulfillment groups formed, then the S&H retrieves the configured S&H rules for each fulfillment group, based on whether the group is a return or sale group. S&H charges can be calculated using one of three rate bases: Shipping method which charges a flat rate per shipping method Amount which uses the sum of order line subtotals for all items within a fulfillment group Volumetric weight, which uses the sum of volumetric weights of all items within a fulfillment group Note: Shipping and handling charges take quantity across lines into account. For example, if volumetric rates are defined as: 0-70 LB being $10.00 and 70-150 LB being $15.00, and if a customer orders 3 units of Item A, which weighs 25 LB. Two possible scenarios exist: 3 units of Item A are added as a single line. 3 units of Item A are added as 3 separate lines with each line having the same/different shipping address. In both scenarios, the total weight would be calculated as 3*25 LB = 75 LB, hence the shipping charges would amount to $20.00. While calculating S&H charges based on 'Amount,' note that the order line subtotals are calculated as item price times quantity and do not take discounts into account. For example, free shipping is available for shipments over $150. If the item subtotal is $200, but a $75 appeasement was applied, then the item subtotal remains $200 and the shipment still qualifies for free shipping, even though the customer paid only $125 after discounts. In addition to S&H charges, additional charges can be applied. These charges are added to the existing fulfillment group charge; no new charge details are created. Four types of additional charges can be configured, and the total additional charge is the sum of all additional charges: Order charges: This adds a flat charge for each fulfillment group. To charge a flat $8 rate S&H across all orders and shipping methods, set this field to $8. Additional order line charges: This adds a flat charge for each order line in a fulfillment group. For example, if a group contains 3 order lines and this field is set to $0.10, then 3 x $0.1 = $0.30 is the additional charge. Additional quantity charges: This adds a flat charge for each quantity in each order line of a fulfillment group. If an order line has a quantity of 1, then this charge is not applicable. For example, if an order line has quantity = 3 and a second order line has quantity = 2, and the additional charge is $0.10 per unit, then the additional charges are (3-1) x $0.10 for the first line, and (2-1) x $0.10 for the second line, for a total additional charge of $0.30. Hazmat charges: This adds a flat charge for each fulfillment group, if any order line in the group contains a hazmat item (identified by the order line IsHazmat attribute). For example, if an order has two lines, both of which are hazmat items, and the additional charge is configured at $5, then an additional charge of $5 is calculated. After calculating the charges, the S&H component responds with a S&H charge for each fulfillment group. The S&H charge is a sum of the S&H charges and additional charges for each fulfillment group. The Order component creates charge details for each charge present in the S&H response and saves the charges on the order header. Note: In case of a Buy Online Pick-up In Store, no shipping charges are applied. Even if in the Order Configuration, it has been configured to apply shipping charges on the first shipment and if the BOPIS line is first to be picked, then still no S&H charge is applied to a BOPIS item. Enabling S&H S&H calculation can be enabled or disabled by order type via the order configuration. For example, e-commerce orders require S&H calculation, but replenishment orders do not. To achieve this, the order configuration for e-commerce orders can enable S&H, while the order configuration for replenishment orders can disable S&H. When S&H is enabled, then the Order component calls the S&H component to calculate S&H charges. Otherwise, no call to the S&H component is made. To update the setting which enables and disables S&H calculation for a set of order types, navigate to the Order Configurations UI and select the Shipping & Handling check box. S&H Rule Configuration The shipping and handling configuration is a set of parameters which define how charges are applied to a customer or return order. S&H charges can be calculated based on the order value or a flat charge per shipping method, and an additional charge can be added on top of the variable charge rate. Separate configurations exist for sale and return order lines. For example, for sale lines, S&H charges could be based on order value, but for return order lines, S&H charges could be defined as a flat charge per shipping method. Perform the following steps to configure S&H charges: Configure a shipping charge list in the Shipping & Handling Charge Lists UI. This list is the parent entity which encompasses the shipping rules for a given set of orders. Separate lists can be created for different seasons or businesses. Configure shipping charge rules with or without a shipping charge list. In the shipping charge rule, define the rate basis for the shipping charge calculation as shipping method, order value, or volumetric weight. For each list, two shipping charge rules should be created: one for return lines and one for sales line. Configure shipping charge rules in the Shipping & Handling Charge Rules UI. For the list, configure individual shipping charges which store the lowest level of charge data. For example, the charge defines the shipping charge rate per shipping method. If an order value or volumetric weight is used to calculate charges, then a range of order values or weights can be defined for each charge. Configure shipping charges in the Shipping & Handling Charges UI. If Override Charge To Zero check box is selected in the Shipping & Handling Charge Rules UI, SnH charges will be overridden by the system to zero if the order line is converted from BOPIS (Ship To Store Delivery Method Id) to Ship To Home (Ship To Address Delivery Method, which is identified by the Prior Delivery Method Id in Order Line Additional; PriorDeliveryMethodId = ShipToAddress). By default, this configuration will be set to true. Note: Charge rule ID should be unique in the charge configuration. If it is not unique and multiple charge rules are configured with the same ID but different rates basis, a rule will be selected randomly. Charging S&H on Invoice The logic to copy the order charge details to invoice charge details is based on the delivery method configuration. When orders are shipped, the order charge details will be copied to invoice charge details only for delivery methods with Shipping Charge Required = true. If the Shipping Charge Required is set to false, the invoice charge details will remain empty. Charging S&H and other charges on First Invoice S&H, VAS, Hazmat, Handling and Surcharge - charges applied on the order header level can be charged in one of two ways: either when the first invoice is created or prorated across all shipments. On the Order Configuration UI, if 'Charge entire charge on first Invoice' is enabled for the respective charge type, then the entire charge will be invoiced when the first invoice of the fulfillment group is created. If it is disabled, then the charges will be prorated across each shipment and invoice based on the item value. It is important to note that if the charge is not fully billed on first invoice, there are some cases where the remaining charge will be billed using an adjustment invoice after the rest of the order is canceled. - if the charge is at header level and part of the order is canceled, the system will still bill the remaining value of the charge - if the charge is at line level and the line is partially canceled, the system will still bill the remaining of the value of the charge - if the charge is at line level and the line is fully canceled, then this specific charge will not be invoiced and billed to the customer. Invoice Charge Calculations on Exempted Charge Types During invoice charge calculations any charge type that is exempted on the order line will not be charged during shipment. See example below, Exempt "Shipping" charges with "Charge on First Invoice" set to True for "Shipping" ChargesOrder bridged with exempt charge on Item "Dressing Table". In the below scenario, the "Shipping" charges is $300 and "Charge on First Invoice" configured as true for "Shipping" charges in order configuration. OrderLineId Item Unit Price ExemptCharge 1 Queen Bed $5000 2 Single Seater Sofa $1000 3 Side Tables $2000 4 Side Table Lamps $2000 5 Dressing Table $1000 Shipping When Shipment invoice is created for item "Dressing Table"  shipping charges will be exempted, Scenario 1: Order Total: $11,000, Shipping Charges $300 Order-line “Dressing Table” shipped, Shipment Invoice is created for $1000 without any Shipping charges. Scenario 2: Order Total: $11,000, Shipping Charges $300 Order-line “Queen Bed” and “Side Tables” shipped, Shipment Invoice is created for $7300, including the individual item prices, and the entire Shipping charges $300. Shipping charges $300 on the shipment invoice will be prorated to both the lines based on their line weightage. Scenario 3: Order Total: $11,000, Shipping Charges $300 Order-line “Queen bed” and “Dressing Table” shipped, Shipment Invoice is created for $6300, including the individual item prices and the entire Shipping charges $300. Shipping charges $300 on the shipment invoice will be prorated to only item “Queen Bed”. Exempt "Shipping" charges with "Charge on First Invoice" set to False for "Shipping" ChargesOrder bridged with exempt charge on Item "Dressing Table". In the below scenario, the "Shipping" charges is $300 and "Charge on First Invoice" configured as false for "Shipping" charges in order configuration. OrderLineId Item Unit Price ExemptCharge 1 Queen Bed $5000 2 Single Seater Sofa $1000 3 Side Tables $2000 4 Side Table Lamps $2000 5 Dressing Table $1000 Shipping When Shipment invoice is created for item "Dressing Table"  shipping charges will be exempted, Scenario 1: Order Total: $11,000, Shipping Charges $300 Order-line “Dressing Table” shipped, Shipment Invoice is created for $1000 without any Shipping charges. Scenario 2: Order Total: $11,000, Shipping Charges $300 Order-line “Queen Bed” and “Side Tables” shipped, Shipment Invoice is created for $7190.9, including the individual item prices, and the prorated Shipping charges $190.9 based on individual line weightage. Scenario 3: Order Total: $11,000, Shipping Charges $300 Order-line “Queen bed” and “Dressing Table” shipped, Shipment Invoice is created for $6136.36, including the individual item price and the prorated Shipping charges $136.36 on item “Queen Bed”. Services The following APIs are related to the pricing functionality. Refer to the API documentation for additional details on each service. Service Component Group Service Endpoint Shipping Charge Basket Snh shipping-charge-basket-controller /snh/api/snh/basket/calculateCharges Shipping Method Snh ShippingCharge Services /snh/api/snh/shippingMethod UIs and Entities The configuration UIs mentioned in this document are listed in the table below along with the information to navigate to the API documentation. UI Name Component Group Seed Data Present? Seed Data Profile Order Configurations Order OrderConfig services Yes Base Shipping & Handling Charge Lists SnH ShippingChargeList services Yes Base Shipping & Handling Charge Rules SnH ShippingChargeRule services Yes Base Shipping & Handling Charges SnH ShippingCharge services Yes Base Charge Types Order ChargeType services Yes System Augmentable Implementation Flavors How to retain Fulfillment Group Id when S&H charges are overridden from the call center UI If the order has only one address, then leverage UI command router entry on Override SnH call and implement reverting to the original Fulfilment Group Id through custom component logic and then call save order. If multiple addresses are supported in an order, leverage UI command router entry on Override SnH and implement proration of the charges across groups respectively and implement reverting to the original Fulfilment Group Id through custom component logic. Call save order with new charge record, set Overridden Charge flag as true and original Fulfillment Group Id. How to calculate S&H charges externally but apply base S&H promotion Implement Order:Order:UserExit:CalculateSNH to completely externalize S&H calculation. To call the base promo component to calculate S&H promotions, Order:Order:UserExit:PostCalculateSNH user exit should be implemented with base service CalculateSNHPromo user exit. Refer to proactive documentation to understand how to implement user exit Order:Order:UserExit:CalculateSNH and Order:Order:UserExit:PostCalculateSNH. How to honour the highest value S&H charge for multiple shipping methods with the same destination address Implement Order:Order:UserExit:PostCalculateSNH user exit Keep the highest ChargeTotal (OrderChargeDetail) record and add Actions{“OrderChargeDetail”: ”RESET”} Ensure to populate and send the ChargeDetailId from the user exit How to override new charges during S&H override for imported orders Out of the box, shipping and handling charges are applied only at header level, and hence during S&H override, the UI sends OrderChargeDetail reset at header level and does not impact any charge details at order line level. As a result, when importing an order with shipping charges at line level, the charges are retained despite overriding the shipping charges from UI. Solution: Intercept the override S&H call and filter out the shipping charges at line level and send OrderLineChargeDetail reset from the incoming payload. Branch to custom code based on the presence of OrderChargeDetail reset in the payload, which is an indication that a user has attempted to override or revert the shipping charges. However, ensure to cover the scenario of S&H revert, as it will not add back the S&H charges at line level. Troubleshooting Why are the S&H taxes not getting prorated after cancellation of an order line For the S&H taxes to be prorated after cancelation of an order line, "Calculate Tax" service should be enabled for the "Cancel Line" mod type. Unable to access the shipping and handling config parameter despite having the necessary permissions Follow the steps below: Post the following API: POST {{url}}/snh/api/snh/snhConfigParameters/save { "UseAdvancedShippingRestrictions": false, "SnhConfigParameterId": "defaultSnhConfigParameters" } Verify the configuration using: GET {{url}}/snh/api/snh/snhConfigParameters Resend the same API request as in Step 1, but set UseAdvancedShippingRestrictions to true. Ensure the seed data is present and that the profile synchronization is complete. Related Articles Value Added Services (VAS)