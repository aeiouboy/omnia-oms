# Retail Delivery Fees

**Permalink:** retail-delivery-fees
**Content Length:** 20,872 characters
**Scraped:** 2025-08-09T22:34:23.969947

---

Home &rsaquo;&rsaquo;Manhattan Active® Omni&rsaquo;&rsaquo;Order Management&rsaquo;&rsaquo;Process & Configuration Guides&rsaquo;&rsaquo;Order Selling&rsaquo;&rsaquo;Order Pricing&rsaquo;&rsaquo;Tax ››Retail Delivery Fees Retail Delivery Fees Previous&nbsp;I&nbsp; &nbsp; OverviewColoradoMinnessotaShipping ChargesTax Provider SetupVertex SetupQuotation TaxesVertex Quotation TaxInvoice TaxesVertex Invoice TaxReturns and RefundsDelivery Fee Adjustment and Distribute TaxOrder ParametersTroubleshootingColorado Retail Delivery Fees Missing from Shipment Invoice on Order Import Overview Certain US states are beginning to adopt retail delivery fees that are levied as taxes against sales made and delivered to that destination state. These may vary from state to state, but the common assumption across states so far is that the delivery taxes are charged once per sale, including sales containing multiple shipments to the applicable tax destination, as well as the ineligibility of a refund for the delivery fee when delivered items are returned. This page contains details on the steps for adoption to charge retail delivery fees to the end customer using the Manhattan Active® Omni invoicing and tax processes. Colorado Refer to the&nbsp;Colorado Department of Revenue. Minnessota Refer to the Minnesota Department of Revenue. Shipping Charges In order for the tax provider to apply a delivery fee to an order or invoice, an appropriate tax code must be included on the tax request line item that corresponds to the order shipping charge for the shipment going to the applicable destination state. This assumption applies to both quotation and invoice tax requests. The shipping charge in question can be $0 for deliveries that contain free shipping, but also require the inclusion of a delivery fee. For orders that contain shipments to different destinations that may both include a delivery fee, a shipping charge with an appropriate tax code is required for each shipment to allow&nbsp;the tax provider to accurately apply the delivery fee to the appropriate shipments. Tax Provider Setup The tax provider used for quotation and invoice tax may have variations in setting up this behavior, but in general, the following assumptions are made: The tax provider should be able to charge the retail delivery fee once per transaction, when the tax request contains the destination and shipping&nbsp;tax code combination as a request line item For scenarios when the default delivery tax behavior of the tax provider should not apply (example,&nbsp;the 2nd shipment of an order where the delivery tax has already been charged), the tax provider should be able to charge or exempt the delivery tax based on a true/false flag provided within the tax request Check with your tax provider to understand how delivery fees are handled by the state and how to achieve the outlined behavior. Vertex Setup When integrating out of the box with Vertex as a tax provider, it is assumed that Vertex will calculate and charge the delivery fee by default when all conditions are met, and rules are set up within Vertex to modify the tax request using a Flexible Code Field passed by Manhattan Active Omni in scenarios that circumvent the traditional rules that determine whether a delivery fee should or should not be levied against the transaction. In the following examples, the tax code stored on the order shipping charge&nbsp;remains the same, but a tax rule exists to modify this tax code internally within&nbsp;Vertex based on the destination state present on the shipping line item of the tax request. Example Colorado setup: MAO Tax Code Vertex Tax Driver Vertex Tax Category Flex Field Value Apply RDF Shipping Shipping Default delivery tax category true or null Always Shipping ExemptCODelivery Default delivery tax category Colorado Retail Delivery Fee 100% Exempt false Never Example Minnessota Setup: MAO Tax Code Vertex Tax Driver Vertex Tax Category Flex Field Value Apply RDF Shipping Shipping Default delivery tax category Delivery Fee Passthrough null Tax provider decision Shipping ChargeMNDelivery Default delivery tax category MN RDF Threshold Reached true Always Shipping ExemptMNDelivery Default delivery tax category false Never Quotation Taxes In nearly all cases, it is the sole&nbsp;responsibility of the tax provider to appropriately charge the delivery tax as part of the quotation tax process, as the entire order picture is available within&nbsp;each quotation tax request. If the quotation tax request needs to include an override flag to indicate that the tax provider should either charge or exempt the delivery fee during the quotation process, a customization to the quotation tax request&nbsp;is required. When the quotation response is received from the tax provider,&nbsp;the IsRetailDeliveryFee flag at the order tax detail level should be set to true for the corresponding tax record to handle the tax processing correctly for invoicing and refunds. If Vertex is not the tax provider, this needs to be handled as part of the custom tax integration. Additionally, orders captured using an external e-commerce system and imported already containing quotation taxes should flag the delivery fee tax records appropriately using the IsRetailDeliveryFee flag. Vertex Quotation Tax Out of the box, the base quotation tax request to Vertex does not contain any override flag in the form of a flexible code field. Vertex is expected to determine whether a delivery tax applies to a particular order. The only exception to this rule is orders containing only even exchange lines, in which case a flexible code field is passed to Vertex as 'false', to indicate that no delivery tax applies to the order when Vertex may have otherwise calculated one. When the quotation tax response from Vertex is received and the tax records are persisted to the order,&nbsp;the IsRetailDeliveryFee flag&nbsp;is set as 'true' automatically when the Imposition Type is "48" for the respective tax line item. Invoice Taxes To handle scenarios where multiple shipments take place during the life-cycle of&nbsp;a particular order,&nbsp;the invoice tax request contains an indicator which can be used by the tax provider to apply the delivery fee to the taxes of a particular invoice. The 'charge delivery fee' indicator&nbsp;is used for this purpose, and is&nbsp;determined by pre-defined logic, primarily to indicate to the tax provider&nbsp;that a particular shipment invoice is the first invoice on the order or a subsequent invoice on an order with multiple shipments.&nbsp;This flag is not persisted to the invoice directly, but is included on the tax request input when the invoice is created and sent to the tax provider. By default, the charge delivery fee indicator is included and conditionally set to 'true' based on the following criteria. This is to ensure that the delivery fee is always charged on the first applicable invoice if the delivery fee was provided during quotation tax. If any of the following&nbsp;conditions are not met, the 'charge delivery fee' flag is set to 'false': The invoice type = Shipment The invoice contains a tax detail entry&nbsp;with IsRetailDeliveryFee = true with a tax amount greater than $0 This invoice contains at least one line where IsEvenExchange = false Similar to quotation tax responses, it is required to flag delivery fee tax records with IsRetailDeliveryFee = true&nbsp;to handle them appropriately. This is automatically handled by the out of box Vertex tax integration. Vertex Invoice Tax The 'charge delivery fee' attribute is mapped to a configurable flexible code field in the invoice tax request to Vertex. This flexible code field number is configured within Manhattan Active® Omni. Depending on which flex code is used within the Vertex rules to override the delivery tax logic, the same should be configured as the target field for the ChargeDeliveryFee source field. This can be configured via API. POST /vertex/api/tax/vertexFlexFieldMapping/save { &nbsp; &nbsp; "SourceField": "ChargeDeliveryFee", &nbsp; &nbsp; "TargetField": "{Vertex flexible code field number}" } Refer to Vertex Setup for more information on how to utilize this flex field within Vertex. Returns and Refunds As part of the invoicing process, tax line items determined to be a retail delivery fee are marked with the flag IsRetailDeliveryFee = true. This flag impacts how refunds are processed against the order, and how taxes at the header are prorated. As part of the refunding process, the order has a calculated returnable line total&nbsp;which is used to determine the eligible amount to be refunded. Tax details marked with IsRetailDeliveryFee = true, will not be considered in the returnable line total&nbsp;calculation, and refund calculations done against the order will not consider the delivery fee&nbsp;as refundable. A similar rule holds for returns. If a return order is created against a parent which has tax details with IsRetailDeliveryFee = true, this tax record will not be copied to the return order, and will not be refunded when the item(s) is processed. Delivery Fee Adjustment and Distribute Tax Though unlikely, it is possible that a delivery fee is applied during the quotation tax process, charged as part of the invoice tax process, and later removed during a future quotation tax. When this happens, an adjustment invoice is created for the value of the delivery fee to be refunded to the customer, and a distribute tax call is made to the tax provider against the first shipment invoice to update the tax ledger. Consider the following example: The Minnesota delivery fee requires that the total sale value must meet a minimum amount in order for the delivery fee to apply to the order. Required sale amount&nbsp;= $100 Order Taxable Line Item Subtotal Taxes Shipping Charge $5 Delivery fee Order Line 1 $50 Merchandise tax 1 Order Line 2 $100 Merchandise tax 2 Total $155 Merchandise tax 1 & 2 + delivery fee During the quotation tax process, the tax provider applies the delivery fee because a shipping charge is present, and more than $100 worth of goods are&nbsp;present on the order. Now consider the first order line is shipped, and the second order line is canceled at a later point. Shipment Invoice Invoice Invoice Taxable Line Items Taxes #1 $5 Shipping Charge Delivery fee #1 $50 Order Line 1 Merchandise tax 1 At this point, the order picture has changed, and the output of the quotation tax does not include a delivery fee because the $100 threshold is no longer met. Order Taxable Line Item Subtotal Taxes Shipping Charge $5 N/A Order Line 1 $50 Merchandise tax 1 Order Line 2 (Canceled) $0 N/A Total $55 Merchandise tax 1 Adjustment Invoice Invoice Invoice Taxable Line Items Taxes #2 Order Line 2 Delivery fee (negative) Order Parameters Enable the&nbsp;configuration "Enable Retail Delivery Fee" in the Order Parameters menu or via API. POST&nbsp;/order/api/order/orderParameters/save { &nbsp; &nbsp; "OrderParametersId": "defaultOrderParameters", &nbsp; &nbsp; "EnableRetailDeliveryFee": true } &nbsp; Troubleshooting Colorado Retail Delivery Fees Missing from Shipment Invoice on Order Import To ensure the retail delivery fee is included in the shipment invoice during order import, make sure the following configurations are in place: Set EnableRetailDeliveryFee to true in Order Parameters. Populate both OrderLineTaxDetail and OrderTaxDetail with the appropriate Jurisdiction and JurisdictionTypeId.