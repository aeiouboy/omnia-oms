# How Release Works

**Permalink:** how-release-works
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Processing/Order Fulfillment/Order Release/How Release Works
**Content Length:** 98,428 characters
**Scraped:** 2025-08-09T21:57:21.514378

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Processing››Order Fulfillment››Order Release ››How Release Works How Release Works Previous I Next In this section let's understand some basic concepts of release that include how release works, remorse period etc. How Release WorksCustomizing the Release IDImmediate ReleaseBatch ReleaseAd-hoc ReleaseRemorse PeriodOrder Line Remorse PeriodOrder Line Remorse Process FlowBypassing Order Line Remorse PeriodValidations Performed During ReleaseReleasing Digital GoodsDigital Goods Fulfillment PipelineAuthorization On ReleaseConfigurationBatch Release Pipeline ConfigurationBatch Release Agent ConfigurationRemorse Period ConfigurationRemorse Period Configuration via APIOrder Line Remorse Period ConfigurationOrder Line Remorse Period Configuration via APIRelease Cut-Off Time Grace PeriodImplementation FlavorsSet up an order line remorse period of 60 mins for MPOS orders where ShippingMethod is not (“SMDY PM”, “SMDY AM”)How to prevent the release of lines allocated to "On Hand Available Soon" supply typeHow to evaluate release consolidation rules in PreReleaseOrder / IsReleasable UE. Do we have the consolidation rules API exposedHow to evaluate releasable criteria for Merge shipmentHolding Digital GoodsSplit Release for specific Order Type onlyHow to accommodate manual changes through DoNotReleaseBefore date and trigger the releaseHow to find if a fulfillment location is of type Store or DC  How to change the pipeline for gift card items purchased online to move the order lines directly from open to fulfilledHow to copy the extended order/order line attribute values to release/release lineHow to disable change shipping address for orders in the remorse periodRelated Article(s) How Release Works An order can be released in three ways. Immediate Release: Order is release immediately after allocation with an optional remorse period. For example, 30 minutes after the order is confirmed. Batch Release : Order is release in scheduled batches. For example, every day at 6 AM, 12 PM, and 6 PM. Ad-hoc Release: Order is released in the UI or via API. Regardless of the method used, the release service works by picking allocations, grouping them into releases based on origin, destination, and other parameters listed below, and creating releases. The outbound release message is then published to the corresponding fulfillment system, which will later respond with ship, pickup, or short messages. Release IDs are computed by appending a counter at the end of the order Ids. For order ID ORD001, the associated releases will have release Ids: ORD0011, ORD0012, ORD0013, etc... Because order Is are unique, this logic will ensure release Id are unique as well. This means even if release Id's repeat, as long as the order Id is distinct, there will be a unique identifier for each entry. Note: Currently, the system does not perform a tax call before release by default, and there is no out-of-the-box configuration available to enable this. Implementing such functionality would require a custom solution. Customizing the Release ID If the standard way of computing release ID is not compatible with the fulfillment system format, it is possible to implement a user exit Order:Order:UserExit:GenerateReleaseId to customize the way the release ID is generated. Immediate Release Immediate release allows orders to be released instantly after allocation. An optional remorse period can be added to delay the release, so that customers can update or cancel orders. However, if no remorse period configuration is added, then order lines are released immediately after allocation. Immediate release is configured by default for all orders. This is controlled by the release service in the order pipeline. Batch Release Batch release can be used to release orders to fulfillment systems based on a schedule (e.g. every 4 hours, or every day at 7 AM and 8 PM). For example, batch release can be used to release orders to the DC based on the scheduled work shifts. The batch release process uses the same filters, validations, and rules that immediate allocation uses. Batch release can be used in conjunction with immediate allocation or batch allocation. If used in conjunction with immediate allocation, then orders are allocated immediately to reserve inventory, but they are not released until the batch release scheduler runs. An out of the box pipeline called 'OrdersWithScheduledRelease' can be used for these types of orders. The pipeline does not have any criteria which are used to identify eligible orders/order lines. This criteria must be configured for this pipeline definition. Refer How to Configure Batch Release Pipeline. If used in conjunction with batch allocation, the orders are allocated based on the batch allocation scheduler, and are then released when the batch release scheduler runs. To use this combination, modify the pipeline to include batch allocation and batch release. Once the pipeline is modified then configure batch release agent to post the messages to the release queue. Refer How to Configure Batch Release Agent. Ad-hoc Release In the normal course of operations, the immediate and batch release services ensure all orders get released. However, during troubleshooting or testing there are other tools which can be used to trigger release for an individual order line, order, or set of orders: On the Order List UI, select order(s) and click the 'Release' button On the Order List UI, select search criteria and click the 'Release All' button. Refer Mass Release for more details. On the Order List UI, select an order and select 'Order Details' > Select one or more lines on the order and click the 'Release' button, or select the header 'Release' button to release all lines On the Order Line List UI, select order line(s) and click the 'Release' button Call the API directly: Use the following API, REST APIS and USER Exits <url>/order/api/order/order/{orderId}/release - GET method to release an order <url>/order/api/order/order/release - POST menthod to release list of orders <url>/order/api/order/order/orderLine/release - POST method to release list of order lines Remorse Period A remorse period is a way to introduce a delay between placing an order and releasing an order. Because order edits are very limited once an order is released, introducing this delay gives customers a chance to update quantities, shipping address, cancel items, and so on. Once an order is released, these edits are no longer permitted. The remorse period is achieved by setting a date called DoNotReleaseBefore on the order header. For each order, the release service checks if the DoNotReleaseBefore date is in the past before releasing the order. DoNotReleaseBefore date will be stored in UTC time zone always. All the dates in Manhattan Active® Omni needs to be passed in UTC time zone. For example, if an order is confirmed at 8:00 and a 45-minute remorse period is in place, then the DoNotReleaseBefore date on the order is set to 8:45. The milestone scheduler runs frequently and checks for orders with DoNotReleaseBefore dates in the past, so that it can release them. When the scheduler runs at 8:32, this order is not released. When the scheduler runs at 8:45, then this order is released. There are two ways to enforce a remorse period delay: Configure a remorse period (for example, 30 minutes) in Active® Omni For imported orders, you can alternatively populate the DoNotReleaseBefore date in an external system. Even if remorse period is configured in Active® Omni, the imported value will be honored and not overridden by the milestone configuration. If a remorse period is configured in Active® Omni, then the DoNotReleaseBefore is populated based on the DependentMilestoneId plus the expected time rule duration. For example, the DependentMilestoneId: "Order::Milestone::Confirmed" in the expected time rule is configured with a duration of 35 minutes. When an order is confirmed on 01-30-2020 at 10:00 AM, the DoNotReleaseBefore is set to 01-30-2020 10:35 UTC. A milestone scheduler runs frequently to pick orders with DoNotReleaseBefore dates in the past and release them. In the milestone configuration, Restrict By Date has significance only with respect to the Released milestone. For example, the Released milestone is configured with "Expected 3 hours after Confirmed Milestone" and "Restrict By Date" enabled. This indicates that after the order has been confirmed, it will not get released for next 3 hours. When "Restrict By Date" is selected, the system populates the attribute "DoNotReleaseBefore". This Restrict By Date functionality is not supported for any milestones other than Released. It is currently not possible to vary the remorse period based on time of day. For example, when it's closer to carrier pick up time, the remorse period should be shorter so that the orders can be ready for the carrier. This is not possible in Active® Omni, but an external system or middleware can be used to populate the DoNotReleaseBefore date with an appropriate value. There is no method to 'pause' updates to an order while users are making updates in the remorse period. For example, if a 1-hour remorse period is in place, and the customer calls at 58 minutes to update their address, then there is a chance that the order gets released while a CSR is making updates. The only way to prevent the order from being released is for the CSR to hold the order while making updates, then unhold the order when updates are completed. To configure remorse periods, see: How to configure a remorse period via the Order Configuration UI How to configure a remorse period via API Order Line Remorse Period An order line remorse period is a way to introduce a delay between placing an order and releasing an order line. Lately, we have seen the emergence of newer service levels like Same Day Delivery, which requires some or all of the lines in specific orders to be released immediately to meet the same day SLAs and carrier cut off times. Similarly, Retail Order lines are required to be released immediately. The remorse period is achieved by setting a date called DoNotReleaseBefore on the order line. For each order line, the release service checks if the DoNotReleaseBefore date is in the past before releasing the order line. There are two ways to enforce a remorse period delay: Configure order line remorse period (for example, 30 minutes) in Active® Omni. For imported orders, you can alternatively populate the DoNotReleaseBefore date in an external system. Even if the order line remorse period is configured in Active® Omni, the imported value will be honored and not overridden when isImport flag under Order Actions is set to true. "OrderActions": { "IsImport": "true" } Note: IsImport flag sent as "true" will suppress any other base or custom events that would trigger. So it is recommended that when IsImport flag sent as true should only include "DoNotReleaseBefore" date value and no other attributes which may trigger base or custom events. An Order line Remorse Config is characterised by the combination of Order Type, Delivery Method, and Shipping Method employed by an order line. The order line remorse period can be configured by defining a remorse period on the Order Line Remorse Config UI. The remorse period that is set in the Remorse Config UI (in minutes) is added to the order confirmation time to arrive at the ‘DoNotReleaseBefore’ for each Order line. While determining the remorse config, if more than one matching config is found, then the below priority sequence is used for choosing one, DeliveryMethodExactMatch & OrderTypeExactMatch  & ShippingMethodExactMatch DeliveryMethodExactMatch & OrderTypeExactMatch  & ShippingMethodNullMatch DeliveryMethodExactMatch & OrderTypeNullMatch & ShippingMethodNullMatch DeliveryMethodExactMatch Example: A remorse config with No OrderType - is eligible for selection for order lines of every order type. A remorse config with No OrderType and No ShippingMethod - is eligible for selection by any order line that just matches the Delivery Method Note : The 'DoNotReleaseBefore' on the order line takes precedence over the 'DoNotReleaseBefore' over the header. If there exists no Order line Remorse config that matches an Order line’s Delivery and Shipping method, the ‘DoNotReleaseBefore’ at header is considered for releasing the order line if it exists. Order Line Remorse Process Flow Order Line Remorse Process Flow To configure remorse period on order line, see: How to configure a remorse period via the Order Line Remorse Configuration UI How to configure a order line remorse period via API In case of order line modification (like ShippingMethodId or DeliveryMethodId or OrderType) during the remorse period, system re-calculates ‘DoNotReleaseBefore’ based on the remorse period present on the matched RemorseConfig. In the case of addition of a new order line to an existing order, the ‘DoNotReleaseBefore’ is calculated as per the line’s creation time and remorse period on the matching RemorseConfig. Note : “When the order line’s DoNotReleaseBefore is updated by external intervention or manually to a past date, a manual trigger (like a Click on Release) is needed for evaluating the Order line for the release process. User should not expect that release will be attempted automatically in such cases. Bypassing Order Line Remorse Period Retailers may want to bypass the order line remorse period for some order lines even though it is aplicable and configured for other order lines in the order. For example, if an order has a bunch of ship to address order lines but one of the item/order-line in that order is picked up by the customer in the store and reserved for shipping, the retailer may want to immediately allocate that order line even though a order line level remorse period is configured for the ship to home order lines. Such types of order lines are identified by the attribute DeliveryMethodSubType = 'SendSale' with DeliveryMethodId = ShipToAddress To bypass the order line remorse period configured in the system for such order lines, perform the following steps: Hit the API: GET {{url}}/order/api/tags/tagGroup?size=22 (request body is not required) Verify if the below-mentioned Tag group is available in the response "TagGroupId": "OrderLineRemorsePeriod" - The Tag Group Id has to be defined exactly as mentioned here; else it will not be considered for determining the order line remorse period by the system "TagConditionId": "DeliveryMethodSubTypeConditionOnOrderLine" "TagExpression": "DeliveryMethodSubType == 'SendSale'" - This is the value of the DeliveryMethodSubType attribute on the order line that the Label framework will evaluate for populating the label. Any other attribute on the order line can be used in the Tag Expression "Label": "RemorsePeriod:0" - Here 0 (zero) represents the remorse period in terms of minutes; the label has to be defined exactly as mentioned here; else it will not be considered for determining the order line remorse period by the system. Any other value in terms of minutes can be defined instead of 0 (zero). Refer to the details mentioned below for the exact response. OrderLineRemorsePeriodTagGroup { "Description": "RemorsePeriodGroup contains set of conditions with various Tag Expressions(MVEL expressions)", "TagGroupId": "OrderLineRemorsePeriod", "TagCondition": [ { "Description": "Send Sale OrderLine", "ConditionLabels": [ { "Label": "RemorsePeriod:0" } ], "TagConditionId": "DeliveryMethodSubTypeConditionOnOrderLine", "TagExpression": "DeliveryMethodSubType == 'SendSale'" } ] } If the Tag Group mentioned above is not available, use the below-mentioned API to create it. API: POST {{url}}/order/api/tags/tagGroup/save - with the response given above as the request body. In the order if an order line has DeliveryMethodSubType as 'SendSale'" an Entity Labels section will be populated in the order line as detailed below. LineLevelRemorsePeriodEntityLabel "EntityLabels": { "Annotations": null, "InheritedLabels": null, "RuleLabels": { "RemorsePeriod": "0" }, "AttributeLabels": null } The order line with the Entity Label populated with "Label": "RemorsePeriod:0" - will be immediately released irrespective of the order line remorse period configured in the system. Note: The remorse period is applied automatically and Release Configuration need not be modified. The above-mentioned Tag Group has been provided in the base profile seed data and will be available automatically if the profile is synched/copied. If the default behaviour for 0 (zero) remorse period is not required for the order lines with DeliveryMethodSubType as 'SendSale'", the TagGroup has to be manually deleted or updated using Tag Group API's. Refer to swagger for details. Validations Performed During Release Order lines must meet all the following criteria to be released: Matching release template should be found Order should be confirmed Units must be allocated DoNotReleaseBefore should be in the past (remorse period should be over) Supply must be configured as eligible for release, via the release demand type Releasing Digital Goods For items which do not track inventory, such as e-gift cards or other digital items, the allocation step is skipped and orders are directly released. A separate digital goods pipeline is used for lines with delivery method ‘Email’. This pipeline moves units from Open directly to Released status. For quantities which enter the release service without allocations, a release and release lines are created directly from the order and order line data. The fulfillment location config 'ALL' template is used for publishing the outbound releases for digital goods, as there is no ship from location on the release. The Order Configuration UI Modification Rules should have "resubmit Pipeline" as true for any modification that occur between open and released for these orders to get to released status properly. Note: Digital goods lines do not go through release template evaluation or consider Release configurations. Remorse period functionality can still be leveraged for digital goods by populating the "DoNotReleaseBefore" timestamp attribute at the order or order line level. However, if for example, your order remorse period is evaluated during the allocation milestone, then no remorse period will be calculated as digital goods do not go through the allocation process. Digital Goods Fulfillment Pipeline Authorization On Release When the configuration Process Payment On Release is enabled, the release process goes through an additional check upfront to verify that the amount attempting to be released has been paid for. In addition to other release eligibility checks (remorse period, release configuration, and so on), an order line(s) cannot be released unless there is a successful authorization or settlement to cover the releasable amount. If there is not enough paid on the order to cover the amount to be released, no release is created. At a high level, this is handled by tracking the amount on the order that is eligible for release, and comparing it to the amount of payment that has been authorized or settled. If nothing has been authorized or settled, the releaseable amount is used to create auth or settlement transactions against an eligible payment method. Refer to Authorization On Release For Pre-Orders for more details. This behavior is NOT compatible with payment status validation in the respective release configuration. If this configuration is enabled, it is required to set the release configuration to not restrict release by payment status. Otherwise, if, for example, the payment status is "Awaiting Payment Info", and the order is not authorized, the release process will not be able to trigger authorization because the releasable amount will be calculated as 0. This configuration assumes the same release consolidation and grouping logic still applies. The calculated releasable amount value is done for all of the releasable units, not on an individual unit basis. Depending on the amount of payment that was captured upfront, it is possible that release creation is prevented because the amount authorized or settled does not cover the entire amount that can be released. In other words, if an order is authorized enough to cover 1 unit eligible for release, but not all units eligible for release, no release creation will happen. Note: Though unlikely, if release is attempted but ultimately unsuccessful because the corresponding authorization failed, the inventory reservation will still indicate the item(s) has been released. If this happens, certain inventory processes such as inventory rise/drop and continuous allocation will not function properly. The item(s) can still be released when eligible, as well as go through re-allocation or cancellation. Configuration Batch Release Pipeline Configuration This section gives details on how to modify the pipeline to perform batch release based on certain rule conditions. Steps to Configure Batch Release PipelineReminder on pipeline configuration. Multiple objects are involved in the configuration of a pipeline: A Pipline, a Rule, a Rule Action and a Rule condition. The Rule Condition includes the filter used to select specific orders. That filter is generated using the 'ConditionValue' specific syntax. Look for examples in the existing rule conditions. The Rule Action contains the name of the pipeline that is going to be invoked with the following rule: RuleActiob.ActionValue = Pipeline.PipelineID. The Rule links the Rule Action and the Rule condition together. Step 1: Rule Condition: Rule condition needs to be added. In this example, the rule condition contains all the orders of doc type "Customer order" <url>/order/api/rules/ruleCondition/save { "RuleConditionId": "RULE_CONDITION_CUSTOMER_ORDER", "ConditionValue": "{\"expression\":{\"lhs\":{\"operandType\":\"attribute\",\"attribute\":\"orderLine.parentOrder.docType.docTypeId\"},\"rhs\":{\"operandType\":\"constant\",\"value\":\"CustomerOrder\"},\"operator\":\"=\"}}" } Step 2: Pipeline: The pipeline that invokes Batch release needs to contains the "batchRelease" service instead of the "releaseOrder" service. Below is an example of a pipleine with BatchRelease service <url>/order/api/ServiceDefinition/pipeline/save { "Messages": null, "PickupService": [ { "FromStatus": "0000", "ComponentId": "Order", "ServiceId": "createOrder" }, { "FromStatus": "2000", "ComponentId": "Order", "ServiceId": "updateOrder" }, { "FromStatus": "1500", "ComponentId": "Order", "ServiceId": "updateOrder" }, { "FromStatus": "1000", "ComponentId": "Order", "ServiceId": "allocateOrder" }, { "FromStatus": "1000", "ComponentId": "Order", "ServiceId": "batchAllocate" }, { "FromStatus": "1000", "ComponentId": "Order", "ServiceId": "allocateBackOrder" }, { "FromStatus": "1500", "ComponentId": "Order", "ServiceId": "allocateOrder" }, { "FromStatus": "1500", "ComponentId": "Order", "ServiceId": "batchAllocate" }, { "FromStatus": "2000", "ComponentId": "Order", "ServiceId": "batchRelease" }, { "FromStatus": "2000", "ComponentId": "Order", "ServiceId": "deAllocateOrder" }, { "FromStatus": "3000", "ComponentId": "Order", "ServiceId": "shortOrder" }, { "FromStatus": "3000", "ComponentId": "Order", "ServiceId": "processOrder" }, { "FromStatus": "3000", "ComponentId": "Order", "ServiceId": "pickOrder" }, { "FromStatus": "3000", "ComponentId": "Order", "ServiceId": "packOrder" }, { "FromStatus": "3000", "ComponentId": "Order", "ServiceId": "fulfillOrder" }, { "FromStatus": "3500", "ComponentId": "Order", "ServiceId": "unProcessOrder" }, { "FromStatus": "3500", "ComponentId": "Order", "ServiceId": "shortOrder" }, { "FromStatus": "3500", "ComponentId": "Order", "ServiceId": "pickOrder" }, { "FromStatus": "3500", "ComponentId": "Order", "ServiceId": "packOrder" }, { "FromStatus": "3500", "ComponentId": "Order", "ServiceId": "fulfillOrder" }, { "FromStatus": "3600", "ComponentId": "Order", "ServiceId": "packOrder" }, { "FromStatus": "3600", "ComponentId": "Order", "ServiceId": "shortOrder" }, { "FromStatus": "3600", "ComponentId": "Order", "ServiceId": "fulfillOrder" }, { "FromStatus": "3700", "ComponentId": "Order", "ServiceId": "shortOrder" }, { "FromStatus": "3700", "ComponentId": "Order", "ServiceId": "fulfillOrder" }, { "FromStatus": "7000", "ComponentId": "Order", "ServiceId": "createReturn" }, { "FromStatus": "8000", "ComponentId": "Order", "ServiceId": "confirmReturn" }, { "FromStatus": "8000", "ComponentId": "Order", "ServiceId": "cancelReturn" }, { "FromStatus": "8500", "ComponentId": "Order", "ServiceId": "cancelReturn" } ], "PipelineId": "OrdersWithScheduledRelease", "ProcessTypeId": "ORDER_EXECUTION", "Description": "Orders with Scheduled Release", "DropStatusDetermination": [ { "ConditionText": null, "FromStatus": "0000", "Sequence": 1, "DropStatus": "1000", "ComponentId": "Order", "IntendedDropStatus": "1000", "ServiceId": "createOrder" }, { "ConditionText": null, "FromStatus": "1000", "Sequence": 1, "DropStatus": "1500", "ComponentId": "Order", "IntendedDropStatus": "1500", "ServiceId": "allocateOrder" }, { "ConditionText": null, "FromStatus": "1000", "Sequence": 1, "DropStatus": "2000", "ComponentId": "Order", "IntendedDropStatus": "2000", "ServiceId": "allocateOrder" }, { "ConditionText": null, "FromStatus": "1500", "Sequence": 1, "DropStatus": "2000", "ComponentId": "Order", "IntendedDropStatus": "2000", "ServiceId": "allocateOrder" }, { "ConditionText": null, "FromStatus": "1000", "Sequence": 1, "DropStatus": "1500", "ComponentId": "Order", "IntendedDropStatus": "1500", "ServiceId": "batchAllocate" }, { "ConditionText": null, "FromStatus": "1000", "Sequence": 1, "DropStatus": "2000", "ComponentId": "Order", "IntendedDropStatus": "2000", "ServiceId": "batchAllocate" }, { "ConditionText": null, "FromStatus": "1500", "Sequence": 1, "DropStatus": "2000", "ComponentId": "Order", "IntendedDropStatus": "2000", "ServiceId": "batchAllocate" }, { "ConditionText": null, "FromStatus": "2000", "Sequence": 1, "DropStatus": "1500", "ComponentId": "Order", "IntendedDropStatus": "1500", "ServiceId": "deAllocateOrder" }, { "ConditionText": null, "FromStatus": "2000", "Sequence": 1, "DropStatus": "1000", "ComponentId": "Order", "IntendedDropStatus": "1000", "ServiceId": "updateOrder" }, { "ConditionText": null, "FromStatus": "1500", "Sequence": 1, "DropStatus": "1000", "ComponentId": "Order", "IntendedDropStatus": "1000", "ServiceId": "updateOrder" }, { "ConditionText": null, "FromStatus": "2000", "Sequence": 1, "DropStatus": "3000", "ComponentId": "Order", "IntendedDropStatus": "3000", "ServiceId": "batchRelease" }, { "ConditionText": null, "FromStatus": "3000", "Sequence": 1, "DropStatus": "1500", "ComponentId": "Order", "IntendedDropStatus": "1500", "ServiceId": "shortOrder" }, { "ConditionText": null, "FromStatus": "3000", "Sequence": 1, "DropStatus": "3500", "ComponentId": "Order", "IntendedDropStatus": "3500", "ServiceId": "processOrder" }, { "ConditionText": null, "FromStatus": "3000", "Sequence": 1, "DropStatus": "3600", "ComponentId": "Order", "IntendedDropStatus": "3600", "ServiceId": "pickOrder" }, { "ConditionText": null, "FromStatus": "3000", "Sequence": 1, "DropStatus": "3700", "ComponentId": "Order", "IntendedDropStatus": "3700", "ServiceId": "packOrder" }, { "ConditionText": null, "FromStatus": "3000", "Sequence": 1, "DropStatus": "7000", "ComponentId": "Order", "IntendedDropStatus": "7000", "ServiceId": "fulfillOrder" }, { "ConditionText": null, "FromStatus": "3500", "Sequence": 1, "DropStatus": "3000", "ComponentId": "Order", "IntendedDropStatus": "3000", "ServiceId": "unProcessOrder" }, { "ConditionText": null, "FromStatus": "3500", "Sequence": 1, "DropStatus": "1500", "ComponentId": "Order", "IntendedDropStatus": "1500", "ServiceId": "shortOrder" }, { "ConditionText": null, "FromStatus": "3500", "Sequence": 1, "DropStatus": "3600", "ComponentId": "Order", "IntendedDropStatus": "3600", "ServiceId": "pickOrder" }, { "ConditionText": null, "FromStatus": "3500", "Sequence": 1, "DropStatus": "3700", "ComponentId": "Order", "IntendedDropStatus": "3700", "ServiceId": "packOrder" }, { "ConditionText": null, "FromStatus": "3500", "Sequence": 1, "DropStatus": "7000", "ComponentId": "Order", "IntendedDropStatus": "7000", "ServiceId": "fulfillOrder" }, { "ConditionText": null, "FromStatus": "3600", "Sequence": 1, "DropStatus": "1500", "ComponentId": "Order", "IntendedDropStatus": "1500", "ServiceId": "shortOrder" }, { "ConditionText": null, "FromStatus": "3600", "Sequence": 1, "DropStatus": "3700", "ComponentId": "Order", "IntendedDropStatus": "3700", "ServiceId": "packOrder" }, { "ConditionText": null, "FromStatus": "3600", "Sequence": 1, "DropStatus": "7000", "ComponentId": "Order", "IntendedDropStatus": "7000", "ServiceId": "fulfillOrder" }, { "ConditionText": null, "FromStatus": "3700", "Sequence": 1, "DropStatus": "1500", "ComponentId": "Order", "IntendedDropStatus": "1500", "ServiceId": "shortOrder" }, { "ConditionText": null, "FromStatus": "3700", "Sequence": 1, "DropStatus": "7000", "ComponentId": "Order", "IntendedDropStatus": "7000", "ServiceId": "fulfillOrder" }, { "ConditionText": null, "FromStatus": "7000", "Sequence": 1, "DropStatus": "8000", "ComponentId": "Order", "IntendedDropStatus": "8000", "ServiceId": "createReturn" }, { "ConditionText": null, "FromStatus": "8000", "Sequence": 1, "DropStatus": "8500", "ComponentId": "Order", "IntendedDropStatus": "8500", "ServiceId": "confirmReturn" }, { "ConditionText": null, "FromStatus": "8000", "Sequence": 1, "DropStatus": "7000", "ComponentId": "Order", "IntendedDropStatus": "7000", "ServiceId": "cancelReturn" }, { "ConditionText": null, "FromStatus": "8500", "Sequence": 1, "DropStatus": "7000", "ComponentId": "Order", "IntendedDropStatus": "7000", "ServiceId": "cancelReturn" } ] } Step 3: Rules Action: the rule action will link the pipline to the Rule configired in Step 4 <url>/order/api/rules/ruleAction/save { "RuleActionId": "ORDER_BATCH_RELEASE_MODE", "ActionDescription": "Order Batch Pipeline Action", "ActionValue": "OrdersWithScheduledRelease" } Step 4: Configure the Rule <url>/order/api/rules/rule/save { "RuleId": "RULE_BATCH_RELEASE", "RuleGroupId": "DELIVERYORDER_PIPELINE_RULE_GROUP", "RuleDescription": "batchrelease Order Rule", "Component": "Order", "RuleStatus": "active", "RuleVersion": "1", "Salience": "5", "DisplaySequence": "1", "ActivationDate": null, "ExpirationDate": null, "RuleConditionId": "RULE_CONDITION_CUSTOMER_ORDER", "RuleActionId": "ORDER_BATCH_RELEASE_MODE" } Batch Release Agent Configuration There are two versions of the batch release process. One with an Agent and another with a job. Both are documented below. How to choose between a batch release agent or job? - If you are a new customer or an existing customer who wants to start using batch release, go with the job. - if you are an existing customer with batch release agent configuration; - If your selection criteria for the agent is at the order or order line level, stay with the agent. - if you want to use an allocation level selection criteria, moving to batch release job is encouraged but not mandatory. Use below steps to configure batch release job. Steps to Configure Batch Release JobStep 1: Verify ext point to message type POST {{url}}/order/api/ServiceDefinition/extPointToMessageType/save { "ExtensionPointId": "Order:Order:Event:OnBatchReleaseOrder", "MessageType": "BatchReleaseOrderEventMSGType" } Step 2: Verify outbound message type POST {{url}}/order/api/ServiceDefinition/outBoundMessageType/save { "MessageType": "BatchReleaseOrderEventMSGType", "Transactional": true, "PersistMessageToMsgStore": false } Step 3: Verify inbound message types POST {{url}}/order/api/ServiceDefinition/inBoundMessageType/save { "MessageType": "BatchReleaseOrderEventMSGType", "NoOfConsumer": 10, "MinNoOfConsumer": 1, "Idempotent": true, "ExternalIntegrationRequired": false, "MaxDesiredInstances": 6, "ScaleUpTimeWindow": 10, "ScaleDownTimeWindow": 20, "Description": "This queue is used to pick the allocated orders and process them for release", "ServiceId": "batchReleaseOrderEvent" } Step 4: Verify Job type definition POST {{url}}/order/api/batch/jobTypeDefinition/save { "JobTypeId": "allocationBatchReleaseJob", "JobTypeDescription": "Job to perform release of allocation batch by picking order ids based on the criteria passed on job parameters", "JobType": "SERVICE", "InvocationServiceId": "allocationBatchRelease" } Step 5: Create Job schedule POST {{url}}/order/api/batch/jobSchedule/save { "JobScheduleId":"allocationBatchReleaseJobId", "JobTypeId":"allocationBatchReleaseJob", "CronExpression":"0 0/1 * * * ? *", "JobParameters":[ { "InputKey":"Query", "InputValue":"ItemId == 'Item1'" } ] } Query Examples: Below are some example queries which can be use in the job schedule. User can use different filter criteria based on different fields in allocation/orderline/order entity to filter the orders. By default, the job is referring to a field on the allocation. Only fields outside of the allocation need to be clearly called out with "orderLine.xxx" "ItemId = 'iPhone8:1'" (here, ItemId refers to the item id on the allocation) "OrderLine.ItemId = 'iPhone8:1'" (here, OrderLine.ItemId refers to the item id on the order line) "OrderLine.Order.OrderType.OrderTypeId = 'Ecom Order'" "OrderLine.Order.OrderType.OrderTypeId = 'Ecom Order' AND OrderLine.ShippingMethodId = '2Day' AND ItemId = 'iPhone8:1'"; (here, item Id refers to the item on the allocation) "OrderLine.Order.OrderType.OrderTypeId = 'Ecom Order' AND ItemId = 'iPhone8:1'"; (here, item Id refers to the item on the allocation) Step 6 If required to test: Trigger the job POST: <url>/order/api/batch/jobSchedule/trigger { "JobScheduleId": "allocationBatchReleaseJobId" } Use below steps to configure batch release agent. Steps to Configure Batch Release AgentStep 1: Create a response template - Login as system POST <url>/order/api/fwcore/responseTemplate/save { "BaseEntity": "Order", "TemplateJson": { "OrderId": null }, "TemplateId": "batchReleaseOrderTemplate" } Step 2: Create a handler for the scheduler POST <url>/order/api/ServiceDefinition/extensionHandler/save { "ExtensionHandlerId": "ReleaseAgentHandler", "ExtensionhandlerRoute": [{ "ExtensionhandlerRouteId": "ReleaseAgentHandlerRouteId", "Source": "ON_EVENT", "Destination": "releaseOrder", "IsSync": "true" }] } Step 3: Create an agent, which includes the frequency at which the scheduler runs POST <url>/order/api/batch/agent { "name": "ReleaseAgent_Batch", "cronSchedule": "0/10 0 0 3/1 * ? *", "query": "order.minFulfillmentStatusId=\"2000\"", "queryLimit": "5000" "entity": "Order", "handlerName": "ReleaseAgentHandler", "TemplateId": "batchReleaseOrderTemplate" } Some sample queries : Example 1 : Release job to pick orders which are in allocated status (MinFulfillmentStatusId=\"2000\" or MaxFulfillmentStatusId=\"2000\") Example 2 : Release job to pick orders which are in allocated status and not to pick backordered and open orders (MinFulfillmentStatusId in (\"1500\", \"2000\") and MaxFulfillmentStatusId not in (\"1500\") Step 4: Check to ensure the job schedule exists <url>/order/api/batch/jobSchedule/jobScheduleId/ReleaseAgent_Batch-AgentSchedule { "Messages": null, "ProfileId": "locc-na-us", "UpdatedTimestamp": "2019-10-16T21:26:04.013", "CreatedBy": "admin@locc-na-us.com", "CreatedTimestamp": "2019-10-16T21:18:12.154", "IsDisabled": false, "IsAdHoc": false, "Process": null, "StartDelay": null, "TriggerKey": "ReleaseAgent_Batch-AgentSchedule-trigger", "UpdatedBy": "admin@locc-na-us.com", "TimeZone": null, "JobTypeId": "ReleaseAgent_Batch-AgentJob", "ContextId": "df17c134-c81b-4f6e-90f1-f0730a904ca2", "CronExpression": "0 0/1 * 1/1 * ? *", "PK": "5712606921545778562", "JobParameters": [ { "ProfileId": "locc-na-us", "UpdatedBy": "admin@locc-na-us.com", "UpdatedTimestamp": "2019-10-16T21:18:12.154", "CreatedBy": "admin@locc-na-us.com", "CreatedTimestamp": "2019-10-16T21:18:12.154", "InputValue": "MaxFulfillmentStatusId=\"2000\"", "ContextId": "2c513b65-8f19-46fe-98f8-9a15cd7f7b14", "ParentJobSchedule": { "PK": 5712606921545778562 }, "Process": null, "PK": "5712606921545786782", "InputKey": "Query" }, { "ProfileId": "locc-na-us", "UpdatedBy": "admin@locc-na-us.com", "UpdatedTimestamp": "2019-10-16T21:18:12.154", "CreatedBy": "admin@locc-na-us.com", "CreatedTimestamp": "2019-10-16T21:18:12.154", "InputValue": "Order", "ContextId": "2c513b65-8f19-46fe-98f8-9a15cd7f7b14", "ParentJobSchedule": { "PK": 5712606921545778562 }, "Process": null, "PK": "5712606921545797805", "InputKey": "Entity" }, { "ProfileId": "locc-na-us", "UpdatedBy": "admin@locc-na-us.com", "UpdatedTimestamp": "2019-10-16T21:18:12.154", "CreatedBy": "admin@locc-na-us.com", "CreatedTimestamp": "2019-10-16T21:18:12.154", "InputValue": "ReleaseAgentHandler", "ContextId": "2c513b65-8f19-46fe-98f8-9a15cd7f7b14", "ParentJobSchedule": { "PK": 5712606921545778562 }, "Process": null, "PK": "5712606921545806224", "InputKey": "HandlerName" }, { "ProfileId": "locc-na-us", "UpdatedBy": "admin@locc-na-us.com", "UpdatedTimestamp": "2019-10-16T21:18:12.154", "CreatedBy": "admin@locc-na-us.com", "CreatedTimestamp": "2019-10-16T21:18:12.154", "InputValue": "ReleaseAgent_Batch-AgentJob", "ContextId": "2c513b65-8f19-46fe-98f8-9a15cd7f7b14", "ParentJobSchedule": { "PK": 5712606921545778562 }, "Process": null, "PK": "5712606921545813576", "InputKey": "MessageType" }, { "ProfileId": "locc-na-us", "UpdatedBy": "admin@locc-na-us.com", "UpdatedTimestamp": "2019-10-16T21:18:12.155", "CreatedBy": "admin@locc-na-us.com", "CreatedTimestamp": "2019-10-16T21:18:12.155", "InputValue": "DEDICATED_MESSAGE_TYPE", "ContextId": "2c513b65-8f19-46fe-98f8-9a15cd7f7b14", "ParentJobSchedule": { "PK": 5712606921545778562 }, "Process": null, "PK": "5712606921545825766", "InputKey": "MessageTypeMode" }, { "ProfileId": "locc-na-us", "UpdatedBy": "admin@locc-na-us.com", "UpdatedTimestamp": "2019-10-16T21:26:04.005", "CreatedBy": "admin@locc-na-us.com", "CreatedTimestamp": "2019-10-16T21:26:04.005", "InputValue": "5000", "ContextId": "df17c134-c81b-4f6e-90f1-f0730a904ca2", "ParentJobSchedule": { "PK": 5712606921545778562 }, "Process": null, "PK": "5712611640054534705", "InputKey": "QueryLimit" }, { "ProfileId": "locc-na-us", "UpdatedBy": "admin@locc-na-us.com", "UpdatedTimestamp": "2019-10-16T21:26:04.006", "CreatedBy": "admin@locc-na-us.com", "CreatedTimestamp": "2019-10-16T21:26:04.006", "InputValue": "batchReleaseOrderTemplate", "ContextId": "df17c134-c81b-4f6e-90f1-f0730a904ca2", "ParentJobSchedule": { "PK": 5712606921545778562 }, "Process": null, "PK": "5712611640064543788", "InputKey": "Template" }, { "ProfileId": "BB-US", "UpdatedBy": "satish@BB.com", "UpdatedTimestamp": "2020-02-27T20:48:32.577", "CreatedBy": "satish@BB.com", "CreatedTimestamp": "2020-02-27T20:48:32.577", "InputValue": "Rest", "ContextId": "af39234a-d42c-4fa6-b18e-14ba68bb32fe", "ParentJobSchedule": { "PK": 5827617985321331468 }, "Process": null, "PK": "5828365125779758356", "InputKey": "QueryType" } ], "JobScheduleId": "ReleaseAgent_Batch-AgentSchedule", "RepeatInterval": null } Step 5: Create orders and allocate them Step 6: Trigger the job POST: <url>/order/api/batch/jobSchedule/trigger { "JobScheduleId": "ReleaseAgent_Batch-AgentSchedule" } Step 7: Verify that orders are released Remorse Period Configuration Search for 'Order Type' in the application menu. In the Order Types UI, identify the order type for which you want to configure a remorse period. Find the Order Config for that order type. Search for 'Order Configuration' in the application menu. Open the Order Config from the previous step. Open the Order Monitoring tab and go to the Released milestone. Add the expected time rule for Released milestone. Specify the remorse period duration in hours (for example, 0.5 hours is 30 minutes). Select the dependent milestone as Confirmed (or another value from the list based on requirements). Select the Restrict by Date check box, and then click OK. In the same Released milestone section, add a monitoring rule. Add the rule name, and specify the remorse period duration in hours. Select the event "Ready for Release" from the drop-down. Remorse Period Configuration via API Follow the below steps to configure a 10 minute remorse period for order type 'CallCenter'. With this configuration, if we confirm an order (which allocates successfully), then it will be automatically released after 10 minutes. Steps to Configure Remorse Period via APIStep 1: Create Order Config POST: /order/api/order/orderConfig/save Step 2: Associate Order Config to Order type POST: /order/api/order/orderType/save Step 3: In the Order Config, add an Expected Time Rule for the Released milestone The below sample JSON is used to set the remorse period to 10 minutes (600 Seconds) { "RestrictByDate": true, "DependentMilestoneId": "Order::Milestone::Confirmed", "MilestoneDefinitionId": "Order::Milestone::Released", "Duration": 600, "OrderConfigId": "CSRConfig", "Type": "AFTER_MILESTONE" } Verify if the expected time rule is created using GET /order/api/order/orderExpectedTimeRule?query=OrderConfigId=EcommConfig Step 4: Add a Monitoring Rule which raises the 'OnReadyForRelease' event POST /order/api/order/orderMonitoringRule { "CreatedBy": "seeddata-importer", "RuleId": "RaiseEventOnReleaseDue", "MilestoneDefinitionId": "Order::Milestone::Released", "Duration": 0, "Process": null, "EventName": "Order:Order:Event:OnReadyForRelease", "RaiseAlways": false, "UpdatedBy": "seeddata-importer", "Type": "EXPECTED_TIME", "OrderConfigId": "CSRConfig", "RepeatInterval": null } Verify if the expected time rule is created using  GET {{url}}/order/api/order/orderMonitoringRule?query=OrderConfigId=EcommConfig Step 5: Add a Job Schedule which will monitor the milestones and raise events as configured POST: /order/api/batch/jobSchedule/save { "JobScheduleId": "orderMileStoneJob", "JobTypeId": "orderMileStoneJob", "CronExpression": "0 0/1 * 1/1 * ? *", "StartDelay": null, "RepeatInterval": null, "TriggerKey": "orderMileStoneJob" } Verify if the job schedule is saved GET /scheduler/api/scheduler/jobSchedule?size=150 GET /order/api/batch/jobSchedule?size=150 Step 6: Create a trigger for the schedule POST: /order/api/batch/jobSchedule/trigger { "JobScheduleId": "orderMileStoneJob" } Order Line Remorse Period Configuration Identify the delivery method and shipping method for which you want to configure a remorse period. Search for 'Order Line Remorse Config' in the application menu. In the Order Line Remorse Config UI, create a new remorse configuration by selecting the Delivery Method ID, Order Type ID, and Shipping Method ID from the corresponding drop-down list of available methods, and provide a remorse period (in minutes) and save the configuration. Note: The attribute selection does not support multi-selection. For example, users cannot define a single remorse config for 60 mins to apply for list of shipping methods. Instead, users have to define the same remorse config duration for each of those shipping methods. Note: The attribute selection does not support != to condition. For example, users cannot define a single remorse config for 60 mins to exclude one or many Same Day Delivery Shipping Methods. Order Line Remorse Period Configuration via API Steps to Configure Order Line Remorse Period via API Step 1: Create Remorse Config POST: POST /order/api/order/orderLineRemorse/save { "DeliveryMethodId": "PickUpAtStore", "OrderTypeId": "Ecom Order", "ShippingMethodId": null, "RemorsePeriod": 0 } Verify that the remorse config is saved GET /order/api/order/orderLineRemorseConfig?size=10 Release Cut-Off Time Grace Period When an order allocation happens before the cut-off time and the release process is triggered post cut-off, i.e, the latest batch release process of the day, then the dates in the release will not be aligned with what was promised to the customer as it will consider the cut-off for the next working day. This feature will allow for configurable minutes of grace period past the location cut-off time to release an order still meeting the committed delivery date. For example, if the cut-off time is 4:00 p.m. and the release job takes 15 minutes to run, this parameter should be set at a minimum of 15 min. The release cut-off time grace period can be configured using the following API or using the Promising Config Parameters UI. POST {{url}}/promising/api/promising/promisingConfigParameters/save { "PromisingConfigParameterId": "defaultPromisingConfigParameterId", "CutoffGraceTimeInMinutes": 10.0 } Implementation Flavors Set up an order line remorse period of 60 mins for MPOS orders where ShippingMethod is not (“SMDY PM”, “SMDY AM”) Individual order line remorse config should be defined for each of the shipping. How to prevent the release of lines allocated to "On Hand Available Soon" supply type In the inventory demand type configuration, remove the "OH Available Soon" supply type. This will prevent orders from being released if they are allocated to the "OH Available Soon" supply type. How to evaluate release consolidation rules in PreReleaseOrder / IsReleasable UE. Do we have the consolidation rules API exposed Consolidation rules API should not be exposed due to technical reasons. The only option is to implement the logic in the custom code. Refer to Release Grouping and Creation for details on how the consolidation logic works. How to evaluate releasable criteria for Merge shipment For a multi-leg merge fulfillment, the base automatically attempts to ship the second leg of the fulfillment when the first Ship Event is processed. While release conditions for the second leg must still be valid, the second leg fulfillment does not pass through the pipeline, and IsReleasable UE is therefore not invoked. Instead, event Order:Allocation:Event:OnMultiplePicuUpStatusChange is triggered. If the implementation requires that both the first and second legs of the fulfillment pass through the release pipeline and be evaluated by the IsReleasable UE, it is recommended to prevent the release from being eligible automatically by modifying the release template to not include demand status of 'In Transit'. Holding Digital Goods Requirement: Since digital goods are automatically released, customers are unable to hold such orders for fraud checks. Hence, customers need an ability to hold digital goods lines in an order before releasing them. Implementation: Make pipeline changes and define a new custom status 1000.500 in between 1000 and 3000 for the release pipeline (“Fraud Hold Resolved” status which can be used for digital goods lines). So that the digital line does not go to released directly. Update Release Service logic to not pick up digital goods from open status 1000.00 and instead pick only in custom status 1000.500 When Fraud hold is removed on the order, then check if any digital goods exist on the line. If yes, then change the order line using a change status API from 1000.000 to 1000.500. POST /api/order/order/changeStatus Split Release for specific Order Type only Requirement: Which user exit should be implemented to split releases based on custom logic for specific order type(s). Implementation: Use Order::Order::UserExit::ReleaseSplit UE for Release split. As part of the extension handler definition for this UE, you can specify the entry condition to filter a specific order type for split release. The remaining order types which are not part of this entry condition will be excluded from the release split. Extension Handler { "ExtensionHandlerId": "ReleaseSplit", "ExtensionhandlerRoute": [ { "ExtensionhandlerRouteId": "ReleaseSplit", "Source": "ON_EVENT", "SourceId": "ON_EVENT", "Destination": "ReleaseSplit", "DestinationId": "ReleaseSplit", "IsSync": "true" } ], "RegisteredExtensionPoints": [ { "ExtensionPointId": "Order:Order:UserExit:ReleaseSplit", "EntryCondition": ""EntryCondition": "OrderType.OrderTypeId == 'Customer'"" } ] } Note: The release split user exit does not support splitting digital goods orders into multiple releases How to accommodate manual changes through DoNotReleaseBefore date and trigger the release Requirement: If orders are created with a certain remorse period through order monitoring rule, is it possible to accommodate manual changes to this date through DoNotReleaseBefore date from an external system Implementation:  The delayed payload is specifically for releasing the order via milestone. It is not designed to accommodate manual changes to the DoNotReleaseBefore date from an external system. If you want order to monitor the DoNotReleaseBefore date and trigger the release after that data has passed, you have a few options: Modify the Order Monitoring rule for release and use the DoNotReleaseBefore as the “Expected Time” for release to happen. But this will mean, the DoNotReleaseBefore should always come in the order and you cannot use milestone to set the do not release, and the remorse period functionality will be lost. Add an extension and every time the DoNotReleaseBefore is modified, you can create a delayed payload via an extension handler. The outbound message type will be ReleaseOrderMsgType and the delivery time will be equal to the DoNotReleaseBefore time. The AWPF framework will automatically post the message to the release queue after the time has past. How to find if a fulfillment location is of type Store or DC The location type is not stored in order. Hence, this can be done using the APIs below. GET {{url}}/order/api/order/order/release?query=ReleaseId=<ReleaseId> -> Fetch ShipFromLocationId from Release object GET {{url}}/organization/api/organization/location/locationId/<ShipFromLocationId> -> Use LocationType from the response How to change the pipeline for gift card items purchased online to move the order lines directly from open to fulfilled Out of the box, order lines cannot skip the release process and should move only from open to released. However, this can be implemented by using the release object to generate an OrderEvent and post it back. How to copy the extended order/order line attribute values to release/release line Implement the Order:Order:UserExit:PostReleaseOrder user exit to copy the extended order/order line attribute values to release/release line. However, the extended attributes from order header/lines on the release outbound message will automatically get populated in "ExtendedFields" : { } and "ExtendedLineFields" : { } sections, provided the attributes are configured in the release template. How to disable change shipping address for orders in the remorse period The change shipping address option is displayed irrespective of remorse period out of the box depending on the permitted modification type for an order. However, to disable this option specifically during the remorse period across Digital Self-Service, Customer Service, and Customer Engagement, perform the following steps: Implement the Order:Order:UserExit:GetPermittedModTypes user exit. Remove the permitted modification type for address change for the orders in remorse period. Related Article(s) OverviewTroubleshootingMass ReleaseRelease Grouping and CreationREST APIs and User ExitsPublish Release