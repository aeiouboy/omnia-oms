# How Payment Processing Works

**Permalink:** how-payment-processing-works
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Selling/Payment/How Payment Processing Works
**Content Length:** 68,303 characters
**Scraped:** 2025-08-09T21:58:40.430839

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Selling››Payment ››How Payment Processing Works How Payment Processing Works Previous I Next This section explains the payment life cycle for each payment type, how payment status is calculated, and how payment transactions are created and processed. Payment Life CyclesPayment StatusUpdating Order Payment StatusPayment RulesPayment Processing using the Payment SummaryPayment Summary Attribute DefinitionsUpdates to the Payment SummaryPayment Summary Creation LogicReturn Credit CalculationsRelated Articles Payment Life Cycles Typical credit card and debit payments have a life cycle which holds an authorization until items are fulfilled, at which time a settlement is created. Some gift card or store credit payment processors which support authorization can also use this life cycle. The life cycle for such payments is as follows: Some payment types do not hold authorizations, but instead these payments are directly settled upon capturing the payment. For instance, many gift card or store credit payment processors do not hold authorizations. The life cycle for such payments are as follows: Pre-paid payment types such as cash, check, and traveler's check are assumed to be settled when the payment method is saved. The life cycle is as follows: E-Check payments follow a unique life cycle, because these electronic funds transfers can take a few days to transfer funds from one account to another. This asynchronous process differs from payments such as credit cards or gift cards which are immediately deducted from the payee's account. The e-check life cycle is as follows: PayPal payments follow a slightly different life cycle, since these payments are authorized outside of the system. When a PayPal payment is imported with an authorization, the life cycle is as follows: Payment Status Payment status is calculated for each payment header and can be used to track the payment life cycle of an order. The payment status is calculated as the lowest numeric payment status on the order. For example, if a $100 order has $50 authorized and $50 paid, then the payment status is "Authorized". There are no failure-specific payment statuses; when authorization, settlement, or refund fails, then the Awaiting Payment Info and Awaiting Refund statuses are used to signal that action needs to be taken on the order. The following table provides an overview of each payment status. All payment statuses except for Not Applicable are maintained in the Payment component. Not Applicable status is calculated by the Order component in scenarios where payment processing is disabled. Status Status Id Description Not Applicable 0 Payment is not required for this order. Occurs when payment is disabled for the given order type (for example, replenishment orders), or when the order total is zero. Awaiting Payment Info 1000 Insufficient payment has been captured for the value of the ordered items. Occurs when items are added to an order, but no payment has been added, or when an authorization or settlement fails. Awaiting Authorization 2000 Sufficient payment has been provided, but authorization has not yet been attempted. Occurs when open authorizations are pending to be executed. Once the execute service is invoked for the open authorizations, then the authorization transactions are closed, and the payment status is updated to Authorized (if authorization is successful) or Awaiting Payment Info (if authorization fails). Authorized 3000 Sufficient payment has been authorized for the order. Indicates that the order can be released to the DC or stores for fulfillment. Awaiting Settlement 4000 Open settlements are pending. Once settlement is executed, then the transactions are closed, and the payment status is updated to Paid (if settlement succeeds) or Awaiting Payment Info (if settlement fails). Paid 5000 Sufficient payment has been settled for the order. For non pre-paid payments, this occurs after all items are fulfilled and settlements have been processed. For pre-paid payments, this occurs when an order is captured with closed, successful settlements. Awaiting Refund 6000 The order total is negative, and the refund is pending. Occurs when an appeasement or return triggers an open refund to be created, but the Payment component has not yet attempted to execute the refund. Once the execute service is invoked for the open refunds, then the refund transactions are closed and the payment status is updated to Refunded. This status is also used when an order total is negative, and insufficient refund transactions exist for the order. If payment refund fails or goes unavailable and all the retries are exhausted, the order payment status is moved back to Paid. Refunded 7000 The order has been fully refunded. Occurs when a full order refund has been issued via an appeasement, or after all items on an order have been returned. Custom Payment Statuses It's currently not possible to define custom payment statuses or to customize the payment status displayed in the order or contact center UIs. If this is required, an extended attribute can be added for custom payment status. This attribute can be calculated by a custom component and displayed on the UI via an extension point. Updating Order Payment Status When the payment status changes, the payment component updates the order with the latest status. The order payment status can be updated in both synchronous and asynchronous scenarios. Both scenarios leverage a single set of payment status calculation logic which exists in the order component. In asynchronous flows, the payment component puts the order Id in a queue to notify the order component that the payment status has changed. The order component picks up the order id from the queue and calculates the payment status. For example, if the payment component initiates an authorization which fails, then the order is updated with payment status Awaiting Payment Info. In synchronous flows, the order component's payment status calculation logic is invoked with an input order id, and the order payment status is updated. Payment Rules The payment rule is used to choose a payment configuration and a payment gateway for each payment type. For each payment type, a payment rule is selected using three attributes: payment type, order type, and card type. One payment rule is required per payment type. Within a payment type, unique payment rules can optionally be configured by order type and/or card type. If multiple rules are eligible for a payment type, then the rule which matches the card type and order type is selected. If no such rule exists, then a rule with matching card type and null order type is selected. If no such rule exists, then a rule with matching order type and null card type is selected. To configure payment rules, navigate to the Payment Rule UI. Payment Processing using the Payment Summary The Payment Summary table is a ledger which keeps record of debits and credits for each order. Throughout the life cycle of an order, the payment summary tracks the amount to be authorized for ordered items, the amount to be settled for fulfilled items, and the amount to be refunded for returned items or appeasements. Since the payment summary is the master record of all order payments, this table is used for: Calculating balance due Determining if any payment transactions need to be created Calculating order payment status To view the payment summary totals for an order, the Total Payment Summary API can be used. This service returns the sum of all Payment Summary columns as well as the total balance due. Payment Summary Attribute Definitions Column Definition Master record of data Credit Amount Amount the customer has paid; amount the retailer has collected for the order Payment transactions Debit Amount Amount the customer owes the retailer, or total value of goods and services that the retailer has provided to the customer Order invoices Book Amount Total value of ordered items, or goods and services that the retailer has promised to the customer but not yet fulfilled Order; Calculated as order total minus sum of invoice totals Authorized Amount Amount which is authorized for an order Payment transactions Requested Authorization Amount Amount for which open authorization records exist Payment transactions Requested Settlement Amount Amount for which open settlement records exist Payment transactions Requested Refund Amount Amount for which open refund records exist Payment transactions Credit In Amount of return credit which has been borrowed from the original order, in case of a return Order lines Credit Out Amount of return credit which has been loaned to return orders; tracked on the original order Order lines Returned Amount Total value of return items which have been booked but not yet shipped to the return center Order lines These columns are used when calculating the types of payment transactions that need to be created, if any. For instance, if a $300 order has not yet been shipped and has a $300 authorization, then the Payment component recognizes that Book Amount = 300 and Authorized Amount = 300, so no new payment transactions are required. However, if a $300 order has not yet been shipped and has a $100 authorization, then the Payment component recognizes there is $200 that still needs to be authorized. Updates to the Payment Summary There are two types of events which result in updates to the payment summary: order updates and payment updates. Order updates reflected in the payment summary include any change in order totals or invoice totals. The sum of order total minus invoice totals is used to calculate the amount due at a later point in time, for which an authorization is required. For instance, if a $50 order is placed online for items to ship to a customer's address, then the order total is $50. Order totals are reflected in the Book Amount column. Invoice totals, or the sum of shipment, adjustment, and return invoices, are used to calculate the amount due immediately, for which a settlement or refund is required. For instance, if a $50 order is placed online for items to ship to a customer's address, then the invoice total is $0. Once the $50 worth of items ship, then the invoice total is $50. Invoice totals are reflected in the Debit Amount column. Payment updates reflected in the payment summary include any updates to payment transactions. For instance, when an open authorization payment transaction is created but has not yet been sent to the payment gateway, the Requested Authorization Amount column is updated. Similarly, when an open settlement or refund transaction is created, the Requested Settlement Amount or Requested Refund Amount columns are updated, respectively. A payment summary record is also created each time a payment transaction is updated. For instance, when an open authorization payment transaction is sent to the payment gateway and the payment gateway responds with a success decision, then the Authorized Amount is updated. Similarly, when an open settlement or refund transaction is successfully executed, the Credit Amount column is increased in case of settlement or decreased in case of refund. Update Type Event Record Created in Payment Summary Payment A payment method is captured for an order. None Payment A payment transaction is created against a payment method and is in open status. If transaction type = Authorization, then create record with Requested Auth Amount. If transaction type = Settlement, then create record with Requested Settlement Amount. If transaction type = Refund, then create record with Requested Refund Amount. Payment An open payment transaction is processed successfully. If transaction type = Authorization, then create record which moves the amount from Requested Auth Amount to Authorized Amount. If transaction type = Settlement and an invoice exists for the payment transaction, then create record which moves the amount from Requested Settlement Amount to Credit Amount. If transaction type = Refund, then create record which moves the amount from Requested Refund Amount to Credit Amount. Payment An open payment transaction is processed, but the transaction fails. If transaction type = Authorization, then create record which decreases Requested Auth Amount. If transaction type = Settlement, then create record which decreases Requested Settlement Amount. If transaction type = Refund, then create record which decreases Requested Refund Amount. Order A shipment invoice is created for an order. Create a record which moves invoice amount from Book Amount to Debit Amount. Order An adjustment invoice is created for an order. Create a record which moves invoice amount from Book Amount to Debit Amount. Order A return is created against an existing order. Create a record against the parent order with Credit Out equal to return credit loaned. Create a record against the return order with Credit In equal to return credit borrowed and Returned amount equal to return order total. Order A return invoice is created for an order. Create a record which moves invoice amount from Book Amount to Debit Amount. Move payment transactions from parent to return order and decrease Credit In and Credit Out. Payment Summary Creation Logic New records are created to capture any change in the payment summary. Records in the Payment Summary table are not updated. The Payment component makes a web service call to the Order component to get the order total and a list of invoice totals. Based on the response, payment summary records get created as follows For each invoice, create a record with Book = -Debit with reference to the invoice ID If Book Amount is not equal to Order Total - sum(Invoice Totals), then create a record to adjust Book Amount Payment Summary Examples Order Creation and Fulfillment Event Credit Debit Book Authorized Requested Auth Requested Settle Requested Refund Invoice Id For example, when a customer places an order in the call center with one $60 item and one $40 item, then the Customer Service UI generates a payment request and the Book Amount is updated with the order total of $100. 100 After adding a credit card payment method, the customer confirms the order, and the Customer Service UI generates a payment request and an open authorization is created for $100. The Requested Auth Amount is updated with $100. 100 When the payment gateway response is received and indicates that authorization was successful, then the $100 moves from Requested Auth Amount to Authorized Amount. 100 -100 When the $60 item ships, then a shipment invoice INV01 is created for $60, and the Order component generates a payment request. $60 moves from Book Amount to Debit Amount. 60 -60 INV01 An open settlement transaction is created against the authorization, and the Requested Settle Amount is increased by $60. -60 60 When the payment gateway response is received and indicates that settlement was successful, then the $60 moves from Requested Settle Amount to Credit Amount. 60 -60 When the $40 item ships, then a shipment invoice INV02 is created for $40, and the Order component generates a payment request. $40 moves from Book Amount to Debit Amount. 40 -40 INV02 An open settlement transaction is created against the authorization, and the Requested Settle Amount is increased by $40. -40 40 When the payment gateway response is received and indicates that settlement was successful, then the $40 moves from Requested Settle Amount to Credit Amount. At this point, the total Credit Amount = $100 and total Debit Amount = $100, so the order is fully paid. 40 -40 When the customer calls to complain about a delayed shipment and the CSR applies a -$15 appeasement, then an adjustment invoice INV03 is created for -$15. The Debit Amount decreases by $15. -15 INV03 An open refund transaction is created against the settlement, and the Requested Refund Amount is increased by $15. 15 When the payment gateway response is received and indicates that settlement was successful, then the $15 moves from Requested Refund Amount to Credit Amount. -15 -15 Scenarios resulting in an Adjustment Invoice Appeasement Applied After Shipment (prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 $80 worth of items ship 80 -80 $30 appeasement - create Adjustment Invoice -30 $30 is refunded -30 Scenarios not resulting in an Adjustment Invoice Order Line Cancellation (prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 $30 line is canceled -30 $30 is refunded -30 $50 ships - Shipment Invoice 50 -50 Appeasement Applied Before Shipment (prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 $30 appeasement -30 $30 is refunded -30 $80 ships 50 -50 Order Cancellation (prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 Order canceled -80 $80 refunded -80 Order Line Cancellation (prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 $50 worth of items ship 50 -50 $30 line is canceled -30 $30 is refunded -30 Scenarios resulting in an Adjustment Invoice Appeasement Applied After Shipment (not prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 $80 worth of items ship 80 -80 Settle $80 80 -80 $30 appeasement - create Adjustment Invoice -30 $30 is refunded -30 Scenarios not resulting in an Adjustment Invoice Order Line Cancellation (not prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 $30 line is canceled -30 Reduce authorization -30 $50 worth of items ship - Shipment Invoice 50 -50 Settle $50 50 -50 Appeasement Applied Before Shipment (not prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 $30 appeasement applied -30 Reduce authorization -30 $50 worth of items ship 50 -50 Settle $50 50 -50 Order Line Cancellation (not prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 $50 worth of items ship 50 -50 Settle $50 50 -50 $30 line is canceled -30 Reduce authorization -30 Order Cancellation (not prepaid) Event Credit Debit Book Auth Customer places $80 order 80 80 Order canceled -80 Reduce authorization -80 Return Credit Calculations Return credit is the mechanism to transfer funds from the parent order to the return order and can be used to issue a refund or can be used towards exchange of items. The payment summary is used to manage the borrowing and transfer of return credit. For ship to return center order lines, return credit is borrowed from the parent order when a return order is created. When credit is borrowed, the parent order Credit Out is increased to reflect outgoing credit. The return order Credit In amount is increased to reflect incoming credit, and the Returned amount reflects the total value of return items. When a return invoice is created, then the return credit is fully transferred from the parent order to the return order in the form of settlement transactions. On the return order, the invoiced amount moves from the Credit In column to the Credit column, signifying that the amount is no longer borrowed but has been secured. On the parent order, a return credit payment transaction is created to ensure that the transferred amount is deducted from the available funds. The Returned amount is updated on both the parent and the return order, and the Credit and Credit Out amounts are decreased to reflect the transfer of credit to the return order. Example 1: Pure Return Order For example, when if a $100 parent order is fully shipped and settled, and a -$40 ship to return center order is created against it, then the Customer Service UI generates a payment request when the return order is created, and an entry is created for the return order with Book Amount = -40. $40 of return credit is "borrowed" from the parent order, to reserve these funds so that they cannot be used for other refunds, which increments the Credit In Amount on the return order and the Credit Out Amount on the parent order. Order Credit Debit Book Authorized Requested Auth Requested Settle Requested Refund Returned Credit In Credit Out Invoice Id Parent Order 100 100 Return Order -40 Parent Order 40 Return Order 40 When the return items are received and verified, a return invoice INV01 is created for -$40, which triggers a payment request to be sent from the Order component to the Payment component. This return invoice updates the return order payment summary by moving -$40 from the Book Amount to the Debit Amount, which triggers the movement of payment methods and settlement transactions from the parent order to return order. When the $40 payment method and $40 settlement is copied from the parent to return, then the return order Credit Amount is incremented, Credit In is decremented (since the funds are fully transferred and no longer "borrowed"), and the Returned amount is updated to reflect the return invoice total. On the parent order, when the settlement is copied and a $40 return credit transaction is created, then the Credit Amount and Credit Out are decreased, and the Returned amount is increased to track the total value of returned items against this order. Order Credit Debit Book Authorized Requested Auth Requested Settle Requested Refund Returned Credit In Credit Out Invoice Id Parent Order 100 100 Return Order -40 Parent Order 40 Return Order 40 Return Order 40 Return Order -40 INV01 Return Order 40 -40 -40 Parent Order -40 40 -40 When the calculate service runs, which could be immediately or via the next scheduled run (depending on configuration), then an open refund transaction is created against the copied settlement on the return order, which increments Requested Refund Amount by $40. When the execute service runs, the open refund is executed, and the $40 moves from Requested Refund to decrement Credit Amount. Order Credit Debit Book Authorized Requested Auth Requested Settle Requested Refund Returned Credit In Credit Out Invoice Id Parent Order 100 100 Return Order -40 Parent Order 40 Return Order 40 Return Order 40 Return Order -40 INV01 Return Order 40 -40 -40 Parent Order -40 40 -40 Return Order 40 Return Order -40 -40 Example 2: Even Exchange Order For example, when if a $100 parent order is fully shipped and settled, and an even exchange order is created with a -$40 ship to return center item and a $40 ship to address item, then the Customer Service UI generates a payment request when the exchange order is created. $40 of return credit is "borrowed" from the parent order, which increments the Credit In Amount on the exchange order and the Credit Out Amount on the parent order. Order Credit Debit Book Authorized Requested Auth Requested Settle Requested Refund Returned Credit In Credit Out Invoice Id Parent Order 100 100 Parent Order 40 Exchange Order 40 When the return items are received and verified, a return invoice INV01 is created for -$40. -$40 is moved from the Book Amount to the Debit Amount, which triggers the movement of payment methods and settlement transactions from the parent order to exchange order. When the payment method and $40 settlement is copied to the exchange order, then the exchange order Credit Amount is incremented, Credit In is decremented, and the Returned amount is updated to reflect the return invoice total. On the parent order, a $40 return credit transaction is created, the Credit Amount and Credit Out are decreased, and the Returned amount is increased. Order Credit Debit Book Authorized Requested Auth Requested Settle Requested Refund Returned Credit In Credit Out Invoice Id Parent Order 100 100 Parent Order 40 Exchange Order 40 Exchange Order 40 Exchange Order -40 INV01 Exchange Order 40 -40 -40 Parent Order -40 40 -40 When the calculate service runs, no updates occur on the exchange order, since there is still $40 worth of exchange items which are pending shipment. When the exchange items ship, a shipment invoice INV02 is created, and $40 moves from Book Amount to Debit Amount on the exchange order. When the calculate service runs, no new transactions are created, since the balance due is zero. Order Credit Debit Book Authorized Requested Auth Requested Settle Requested Refund Returned Credit In Credit Out Invoice Id Parent Order 100 100 Parent Order 40 Exchange Order 40 Exchange Order 40 Exchange Order -40 INV01 Exchange Order 40 -40 -40 Parent Order -40 40 -40 Exchange Order 40 -40 INV02 Related Articles Payment Health DashboardAuthorizationRest APIs and User ExitsOther Transaction TypesCapturing PaymentPayment Schedulers & Batch ProcessingPayment FailuresInvoicing and Sales PostingPayment OverviewSettlementRefundsFraudPayment TypesPayment Gateway IntegrationeInvoice Testing & Troubleshooting Payment