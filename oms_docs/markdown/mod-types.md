# Mod Types

**Permalink:** mod-types
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Orchestration/Mod Types
**Content Length:** 188,939 characters
**Scraped:** 2025-08-09T21:56:42.410996

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Orchestration ››Mod Types Mod Types Previous I Next OverviewHow Mod Types WorkModification RulesOrder Level Modification RulesOrder Line Level Modification RulesReturn Line Level Modification RulesQuantity Level Modification RulesHow TosHow to Configure Modification RulesHow to Add New Mod Types ?How to Add Mod Types to Order ConfigurationHow to Sync Newly Added Mod TypesImplementation FlavorsHow to add a custom user exit for a mod type ?Which user exit should be used to update the extended attribute when a quantity is backordered?Update discount or promotion value on quantity decrease when evaluate Price is not configuredHow can an STS Order be canceled when the order is between "Shipped" from DC1 and "Released" at DC2How to update customer ID beyond restricted statusMod Type for specific field in address objectChange event format which can be defined for modification typeHow to prevent multiple allocations for ship to store orders while updating Requested Delivery Date(RDD)  How to add modification type for quantity field in OrderLineComponentWhich user exit should be used to perform actions when carrier delivery statuses are customizedTroubleshootingWhat if mod type based on a newly added extended attribute is not triggering the required service?What if the mod type is updated, but changes are not being shown on UIWhy is my mod type not getting triggeredHow can I verify if a mod type is being triggered or notCustom mod type is not invoked when inserting new values to the extended AttributeRelated Articles Overview Changes to order attributes or groups of attributes are defined as a Modification Type, or "mod type". Certain mod types such as update customer information occur at the order level, while other mod types like update quantity occur at the order line level. The entity on which the update occurs is called the Modification Level. Mod types are categorized by modification level, so that the rules can be defined distinctly by order, order lines, return lines, and quantity detail. A Modification Rule is used to configure services which are required to be enabled or executed for each mod type. For example, a modification rule is configured for the Update Shipping Address mod type, and this modification rule ensures that re-evaluate reservation service is invoked to re-allocate the line. How Mod Types Work Mod Types - Process Flow When a certain order or order line and return order line and order line quantity detail attributes are updated, a related change event is triggered in the system. Each changeEvent has a type to it which is provided by the Entity framework. Mod types are configured to have one or more than one change event. Once the change event is triggered, the related mod type  gets triggered and which in turn executes the respective services enabled for it. For example, if there is a change in any of the these three fields - "FieldName": "RequestedDeliveryDate, LatestDeliveryDate, DoNotShipBeforeDate", then "ModTypeId": "OrderLine::DeliveryDate" will be invoked and "ChangeEventType": "Group::LineDeliveryDate" will call the services which are configured. Each mod type has a mod type Id which is a unique identifier for order event modification type and the entity on which the update occurs is called the Modification Level. In order to configure the services which are required for each mod type, modification rules are defined. Note: Historical or migrated orders imported into the system using the IsImport flag will not trigger any mod-type controlled behavior such as publish order, calculate tax, evaluate shipping restriction, etc. Modification Rules Each modification rule enables the business to restrict each modification type for orders that reach a certain state. For example, the shipping address cannot be updated for order lines which have already been released to a distribution center (DC) or store. The modification rule table allows for the following restrictions to be enabled for each mod type. The Order Configuration UI enables you to configure modification rules for four categories. Refer How to Configure Modification Rules for more details. Order Level Order Line Level Return Line Level Quantity Level Note: Return Orders are covered in order mod type and are not categorized differently. Order Level Modification Rules Order modification rules are defined for any order level attributes or entities which can be modified. For example, updating order selling location, canceling an order, and applying an appeasement are categorized as order mod types. For each order mod type, the following services can be configured: Service Description Example Calculate Price If an order level mod type occurs for which this service is enabled, then all order lines are re-priced. It is recommended to enable evaluate promotion, calculate S&H charge, and calculate tax services whenever this service is enabled. In the pricing call, the Order component includes all sale lines and return lines which have a null parent order ID/parent order line ID. Updating the order selling location causes all lines on the order to be re-priced. Consider an order with two order lines, OL1 and OL2. Updating the order selling location at order level for which mod type occurs will result in repricing of OL1 and OL2. Evaluate Promotion If an order level mod type occurs for which this service is enabled, then the order is sent to the Price and Promotion component to reevaluate promotions for the entire order. It is recommended to enable calculate tax whenever this service is enabled. Applying a new promotion code to order requires reevaluation of promotions. Calculate S&H Charge If an order level mod type occurs for which this service is enabled, then the order is sent to the S&H component to calculate S&H charges for the entire order. It is recommended to enable calculate tax whenever this service is enabled. In the request sent to the S&H component, the Order component includes return lines only if the line delivery method is configured to require shipping charges. Modifying carrier code or service level code requires recalculation of charges. Calculate Return Fee If an order level mod type occurs for which this service is enabled, then the Order component calculates return fees for the order by using local return fee configuration. Updating Customer Type or Customer Id requires recalculation of return fees. Calculate Tax If an order level mod type occurs for which this service is enabled, then the order is sent to the Vertex component to recalculate tax for the entire order. The Order component excludes return lines for quotation tax calls, unless the return line has a null parent order ID/parent order line ID. Applying a discount on order requires tax calculation. Change Status If any order level mod type occurs for which a status is configured, then the quantity for all order lines will be dropped into configured status. Any status which is less than 2000.000 (Allocated) can be configured as the change status, so that the quantity re-attempts allocation. This status is common for all order lines, so ensure that the status exists in all pipelines which could be used for this order type. This service is not applicable on return lines. If Reevaluate Pipeline is enabled, then Change Status should not be enabled. Modifying the promising location ID at order level causes the order to be re-allocated. Evaluate Pipeline If any order level mod type occurs for which this service is enabled, then the pipeline determination logic is called to select a pipeline for each line and drop the quantity at the beginning of that pipeline. If the pipeline determination logic selects the current pipeline, then the quantity is dropped at the beginning of the current pipeline. This is service is not applicable on return lines. If Evaluate Pipeline is enabled, then Change Status should not be enabled. Changing an order line from Store Sale delivery method to Pick up in Store delivery method requires a new pipeline. Cancel Reservation If any order level mod type occurs for which this service is enabled, then the Order component calls the Inventory component to cancel the reservations of all order lines. This service is not applicable on return lines. If Change Status or Evaluate Pipeline is enabled for a mod type, then this service may be required. When an order is canceled, then the reservation for all the lines should be canceled. Publish Order If any order level mod type occurs for which this service is enabled, then the order, including all the other entities related to it like order lines, allocation, release, and so on.  is published in the form of a message at the end of the transaction. If this option is enabled for multiple mod types, and such mod types occur in a single transaction, then only one outbound order is published. When an order is confirmed, an outbound order is published so that an email marketing system can send the customer an order confirmation email. The format and the attributes that get published can be controlled by a template that can be configured on the Order Configuration -> General Tab - > Publish Order -> Publish Order Template dropdown after creating a custom template. Publish Email When an Email Message option is configured, respective Email Message is published. Multiple email messages can be selected for the same Mod Type, and when such mod types occur in a single transaction, all the configured Email Messages are published. When return order is confirmed, Return Confirmation email message is published so that an email marketing system can send the customer a ship confirmation email. Publish Text When a Text Message option is configured, respective Text Message is published. Multiple text messages can be selected for the same Mod Type, and when such mod types occur in a single transaction, all the configured Text Messages are published. When order is confirmed 'OrderConfirmation' Text Message is published. Restrict Post Confirmation If any order level mod type is enabled for this setting, then it prevents the mod type from occurring after the order IsConfirmed flag is set to true. If disabled for a mod type, then order can be updated even after confirmation. There is a system level restriction for some mod types, so this setting may not be editable. Once an order is confirmed, the selling location cannot be updated. Restrict from Status If restrict from status is set for any order level mod type, then the modification type is not permitted once the order maximum fulfillment status has reached the configured status. If restrict from status is not set, then order can be updated with same modification type at any status. There is a system level restriction for some mod types, so this setting may not be editable. Order cannot be canceled once maximum fulfillment status reaches released status. Restrict from Return Status If restrict from return status is set for any order level mod type, then the modification type is not permitted once the order maximum return status has reached the configured status. If restrict from status is not set, then order can be updated with same modification type at any status. There is a system level restriction for some mod types, so this setting may not be editable. Order cannot be canceled once the configured maximum return status is reached. Calculate EffectiveRank If any mod type occurs for which this service is enabled, then Effective Rank of all the Order Lines will be recalculated. This service can be enabled for individual Prioritization Attributes which is selected in the Fulfillment Order Prioritization Configuration - Prioritization Rule. If value of a Prioritization Attribute is modified after Effective Rank was calculated, the Effective Rank may have to be recalculated to reflect this modification. Some services cannot be triggered for certain mod types, which is a system level restriction to prevent data anomalies and hence, the checkboxes for such services are grayed out by default on the order configuration -> modification rules UI and should not be modified/altered in any way which may result in undesirable system behaviour. Similarly, Restrict from Status and Restrict from Return Status can be modified only if it is allowed by the UI. Altering the base behaviour to enable the statuses that can be selected in Restrict from Status and Restrict from Return Status dropdown and selecting them may result in undesirable system behaviour. Click here for more on Order Level Mod Types ChangeEventType ModTypeId Description ChangeEventEntity FieldName Field::IsConfirmed::True Order::Confirmed This mod type will be triggered when the order “Is confirm” flag is set to true. It is expected the order is not released before it is confirmed. Order IsConfirmed Field::CustomerId Order::CustomerId Any change in the customer ID field will trigger this mod type. Order CustomerId Group::CustomerHold Order::CustomerInfo Change in the customer information such as the customer name, telephone, email  will trigger this mod type Order CustomerFirstName, CustomerLastName, CustomerPhone, CustomerEmail Field::OrderType Order::OrderType A change in the order type of the order will trigger this mod type. It is important to note that the order type can only be modified in the customer service before the order is allocated. Order OrderType Field::SellingLocationId Order::SellingLocationId The Selling location ID is an optional field on an order outside of orders captured in store. An update of the selling location will triger this mod type. Order SellingLocationId Field::IsCancelled Order::Cancel This modtype is triggered if the complete order is cancelled. Check line level mod types as well as they will be triggered too when the order is cancelled. Order IsCancelled Field::IsPostVoided Order::PostVoid Post voiding is a POS process that cancels the confirmed order. If an order is post void, then the order and the associated payment will be cancelled. If the payment was already saved, then a void transaction will be sent to the payment gateway to prevent the funds to be captured from the customer account. If its already settled then a refund will be granted. This mod type will be trigger in case of post void in store. Order IsPostVoided Entity::OrderPromotionRequest::Add::New Order::PromotionRequest::Add A promotion request is an object added on the order used to send to a promotion engine the promotion entered by the user. For example when a user uses a coupon code on the order, it is sent to the coupon validating engine using a promotion request. The promotion request will remain on the order with a closed status even if the promotion is not validated and applied by the external promotion engine. This mod type is triggered when the promotion request is added to the order. OrderPromotionRequest Entity::OrderPromotionRequest::Remove Order::PromotionRequest::Remove This mot type is triggered when a promotion request is deleted from the order. See Order::PromotionRequest::Add for more information on what is a promotion request. Order Entity::OrderPromotionRequest::Update Order::PromotionRequest::Update This mod type is triggered when an existing promotion request is updated. See Order::PromotionRequest::Add for more information on what is a promotion request. Order Field::PaymentType OrderPaymentMethod::PaymentType This mod type is triggered when a payment type is added to the order. This is done when payment-based promotions are enabled in payment paramters. OrderPaymentMethod PaymentType Entity::OrderPaymentMethod::Remove Order::OrderPaymentMethod::Remove This mod type is triggered when a payment method is removed on the order this mod type gets triggered. This is not triggered when the payment method is suspended or voided. Order Entity::OrderChargeDetail::Shipping::Add Order::ChargeDetail::Shipping::Apply This mod type is triggered when an order level charge of type shipping is applied on the order. Note: Order charge detail related mod types are split by charge types so this applies only to shipping charges. OrderChargeDetail ChargeType Entity::OrderChargeDetail::Shipping::Remove Order::ChargeDetail::Shipping::Remove This mod type is triggered when an order level charge of type shipping is removed from the order. Note: Order charge detail related mod types are split by charge types so this applies only to shipping charges. OrderChargeDetail Group::OrderChargeDetail::Shipping::Update Order::ChargeDetail::Shipping::Update This mod type is triggered when an order level charge of type shipping is modified. This does not applies to shipping overrides. Note: Order charge detail related mod types are split by charge types so this applies only to shipping charges. OrderChargeDetail TaxCode, FulfillmentGroupId, ChargeTotal, IsInformational, IsOrderDiscount, ChargePercent, IsTaxIncluded, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Field::OrderChargeDetail::Shipping::IsOverridden::True Order::ChargeDetail::Shipping::Override::Apply OrderChargeDetail IsOverridden Field::OrderChargeDetail::Shipping::IsOverridden::False Order::ChargeDetail::Shipping::Override::Remove OrderChargeDetail IsOverridden Entity::OrderChargeDetail::Discount::Add Order::ChargeDetail::Discount::Apply OrderChargeDetail ChargeType Entity::OrderChargeDetail::Discount::Remove Order::ChargeDetail::Discount::Remove OrderChargeDetail Group::OrderChargeDetail::Discount::Update Order::ChargeDetail::Discount::Update OrderChargeDetail TaxCode, FulfillmentGroupId, ChargeTotal, IsInformational, IsOrderDiscount, ChargePercent, IsTaxIncluded, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderChargeDetail::Appeasement::Add Order::ChargeDetail::Appeasement::Apply OrderChargeDetail ChargeType Field::Order::PaymentStatus::AwaitingAuth Order::PaymentStatus::AwaitingAuth Order PaymentStatus Field::Order::PaymentStatus::Authorized Order::PaymentStatus::Authorized Order PaymentStatus Field::Order::PaymentStatus::Paid Order::PaymentStatus::Paid Order PaymentStatus Field::Order::PaymentStatus::AwaitingPaymentInfo Order::PaymentStatus::AwaitingPaymentInfo Order PaymentStatus Field::Order::PaymentStatus::AwaitingSettlement Order::PaymentStatus::AwaitingSettlement Order PaymentStatus Field::Order::PaymentStatus::AwaitingRefund Order::PaymentStatus::AwaitingRefund Order PaymentStatus Field::Order::PaymentStatus::Refunded Order::PaymentStatus::Refunded Order PaymentStatus Field::Order::PaymentStatus::NotApplicable Order::PaymentStatus::NotApplicable Order PaymentStatus Field::SuspendedOrderId Order::Resume Order SuspendedOrderId Entity::OrderChargeDetail::Appeasement::Remove Order::ChargeDetail::Appeasement::Remove OrderChargeDetail Field::AssociateId OrderSalesAssociate::AssociateId OrderSalesAssociate AssociateId Group::OrderChargeDetail::Appeasement::Update Order::ChargeDetail::Appeasement::Update OrderChargeDetail TaxCode, FulfillmentGroupId, ChargeTotal, IsInformational, IsOrderDiscount, ChargePercent, IsTaxIncluded, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderChargeDetail::VAS::Add Order::ChargeDetail::VAS::Apply OrderChargeDetail ChargeType Entity::OrderChargeDetail::VAS::Remove Order::ChargeDetail::VAS::Remove OrderChargeDetail Group::OrderChargeDetail::VAS::Update Order::ChargeDetail::VAS::Update OrderChargeDetail TaxCode, FulfillmentGroupId, ChargeTotal, IsInformational, IsOrderDiscount, ChargePercent, IsTaxIncluded, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderChargeDetail::Promotion::Add Order::ChargeDetail::Promotion::Apply OrderChargeDetail ChargeType Entity::OrderChargeDetail::Promotion::Remove Order::ChargeDetail::Promotion::Remove OrderChargeDetail ChargeType Group::OrderChargeDetail::Promotion::Update Order::ChargeDetail::Promotion::Update OrderChargeDetail TaxCode, FulfillmentGroupId, ChargeTotal, IsInformational, IsOrderDiscount, ChargePercent, IsTaxIncluded, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderChargeDetail::Coupon::Add Order::ChargeDetail::Coupon::Apply OrderChargeDetail ChargeType Entity::OrderChargeDetail::Coupon::Remove Order::ChargeDetail::Coupon::Remove OrderChargeDetail ChargeType Group::OrderChargeDetail::Coupon::Update Order::ChargeDetail::Coupon::Update OrderChargeDetail TaxCode, FulfillmentGroupId, ChargeTotal, IsInformational, IsOrderDiscount, ChargePercent, IsTaxIncluded, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderChargeDetail::ReturnFee::Add Order::ChargeDetail::ReturnFee::Apply OrderChargeDetail ChargeType Entity::OrderChargeDetail::ReturnFee::Remove Order::ChargeDetail::ReturnFee::Remove OrderChargeDetail Group::OrderChargeDetail::ReturnFee::Update Order::ChargeDetail::ReturnFee::Update OrderChargeDetail TaxCode, FulfillmentGroupId, ChargeTotal, IsInformational, IsOrderDiscount, ChargePercent, IsTaxIncluded, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Field::OrderChargeDetail::ReturnFee::IsOverridden::True Order::ChargeDetail::ReturnFee::Override::Apply OrderChargeDetail IsOverridden Field::OrderChargeDetail::ReturnFee::IsOverridden::False Order::ChargeDetail::ReturnFee::Override::Remove OrderChargeDetail IsOverridden Entity::OrderChargeDetail::Charge::Add Order::ChargeDetail::Charge::Apply OrderChargeDetail ChargeType Entity::OrderChargeDetail::Charge::Remove Order::ChargeDetail::Charge::Remove OrderChargeDetail Group::OrderChargeDetail::Charge::Update Order::ChargeDetail::Charge::Update OrderChargeDetail TaxCode, FulfillmentGroupId, ChargeTotal, IsInformational, IsOrderDiscount, ChargePercent, IsTaxIncluded, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Group::DeliveryDate Order::PromisingInfo::DeliveryDate OrderPromisingInfo RequestedDeliveryDate, PromisedDeliveryDate, LatestDeliveryDate Group::ShippingInfo Order::PromisingInfo::ShippingInfo OrderPromisingInfo CarrierCode, ServiceLevelCode Group::PromisingLocationInfo Order::PromisingInfo::Location OrderPromisingInfo ShipFromLocationId, ShipToLocationId, ShipThroughLocationId Field::StatusApply Order::Hold::Apply OrderHold StatusId Field::StatusResolved Order::Hold::Resolve OrderHold StatusId Entity::OrderNote::Instruction::Add::New Order::Note::Instruction::Add OrderNote Entity::OrderNote::Instruction::Remove Order::Note::Instruction::Remove OrderNote Group::OrderNote::Instruction::Update Order::Note::Instruction::Update OrderNote NoteCategory, NoteType, DisplaySequence, NoteText, IsVisible Entity::OrderNote::Add::New Order::Note::Add OrderNote Entity::OrderNote::Remove Order::Note::Remove Order Group::OrderNoteUpdate::New Order::Note::Update OrderNote NoteCategory, NoteType, DisplaySequence, NoteText, IsVisible Entity::OrderAttribute::Add::New Order::Attribute::Add OrderAttribute Entity::OrderAttribute::Remove Order::Attribute::Remove Order Group::OrderAttributeUpdate Order::Attribute::Update OrderAttribute AttributeName, AttributeValue Entity::OrderTagDetail::Add Order::Tag::Add Order Entity::OrderTagDetail::Remove Order::Tag::Remove Order Group::OrderTaxExempt Order::TaxExempt Order IsTaxExempt,TaxExemptId Field::IsTaxOverridden::True Order::TaxOverridden::Apply Order IsTaxOverridden Field::IsTaxOverridden::False Order::TaxOverridden::Remove Order IsTaxOverridden Field::OrderChargeDetail::VAS::IsOverridden::False Order::ChargeDetail::VAS::Override::Remove OrderChargeDetail IsOverridden Field::OrderChargeDetail::VAS::IsOverridden::True Order::ChargeDetail::VAS::Override::Apply OrderChargeDetail IsOverridden Field::ChargeType::Update Order::ChargeDetail::ChargeType::Update OrderChargeDetail ChargeType Entity::OrderSalesAssociate::Add Order::OrderSalesAssociate::Add Order Entity::TransactionReference::Add Order::TransactionReference::Add This mod type comes into effect when the Sell More function is triggered from the Confirm Pickups UI. This leads to creation of a transaction reference for the BOPIS Sell More order. Order Entity::Order::Add Order::Add This mod type will be triggered when order is added to the system. By default, all the services will be false. Order NA There are a few services which have system data but are not editable for certain modification types. This is because either those services are mandatory to execute or not applicable for such mod types. For example, Cancel Reservation is not enabled and non-editable for applying discount, since this is not relevant. However, cancel reservation is enabled and non-editable for cancel order, because it is a mandatory service for cancel orders. Order Line Level Modification Rules Order line modification rules are defined for any order line level attributes or entities which can be modified. For example, updating delivery date, increasing quantity, and applying a value added service (VAS) are categorized as order line mod types. The order line mod types are applicable only to sale lines, which are defined by IsReturn = false. For each order line mod type, the following services can be configured: Service Description Example Calculate Price If an order line level mod type occurs for which this service is enabled, then the order line is re-priced. It is recommended to enable evaluate promotions, calculate S&H charge, and calculate tax services whenever this service is enabled. Adding a new line requires a price calculation. Consider an order with two order lines, OL1 and OL2. Adding a new line, OL3, will result in repricing of only OL3. Updating the line quantity requires a price calculation. Consider an order with two order lines, OL1 and OL2. Any change in the quantity of OL1 will reprice only OL1 and OL2 will not be repriced. Evaluate Promotion If an order line level mod type occurs for which this service is enabled, then the order is sent to the Price and Promotion component to reevaluate promotions for the entire order. It is recommended to enable calculate tax service whenever this service is enabled. Updating line quantity requires reevaluation of promotions. Calculate S&H Charge If an order line level mod type occurs for which this service is enabled, then the order is sent to the S&H component to calculate S&H charges for the entire order. It is recommended to enable calculate tax service whenever this service is enabled. Changing a line shipping method requires calculation of S&H charges. Calculate Tax If an order line level mod type occurs for which this service is enabled, then the order is sent to the Vertex component to recalculate tax for the entire order. The Order component excludes return lines for tax calculation, unless the return line has a null parent order ID/parent order line ID. Applying a VAS on an order line requires tax to be recalculated. Change Status If any order line level mod type occurs for which a status is configured, then the quantity for the order line is dropped into the configured status. Any status which is less than 2000.000 (Allocated) can be configured as the change status, so that the quantity re-attempts allocation. If Evaluate Pipeline is enabled, then Change Status should not be enabled. When a line shipping address is updated, the line must be re-allocated based on the new destination. Order Change Status If any order line level mod type occurs for which a status is configured, then all the order lines are dropped into the configured status. Any status which is less than 3000.000 (Released) can be configured as the order change status, so that the entire order re-attempts allocation. If Evaluate Pipeline is enabled, then Order Change Status can not be enabled. When a new line is added to the existing allocated order, then the entire order must be moved to open/back ordered and go for allocation for optimized fulfillment. Evaluate pipeline If any order line level mod type occurs for which this service is enabled, then the pipeline determination logic is called to select a pipeline for the line and drops the quantity at the beginning of that pipeline. If the pipeline determination logic selects the current pipeline, then the quantity is dropped at the beginning of the current pipeline. If Evaluate Pipeline is enabled, then Change Status should not be enabled. Modifying delivery method from Ship to Address to Store Sale requires a pipeline evaluation. Cancel Reservation If any order line level mod type occurs for which this service is enabled, then the Order component calls the Inventory component to cancel the reservations of that order line. If Change Status or Evaluate Pipeline is enabled for a mod type, then this service may be required. When an order line is canceled, then the reservations for that line should be canceled. Publish Order If any order line level mod type occurs for which this service is enabled, then a copy of the order including all order lines is published at the end of the transaction. If this option is enabled for multiple mod types, and such mod types occur in a single transaction, then only one outbound order is published. When a line has been canceled, an outbound order is published so that the customer can be notified via email.The format and the attributes that get published can be controlled by a template that can be configured on the Order Configuration -> General Tab - > Publish Order -> Publish Order Line Template dropdown after creating a custom template. Publish Order Line If any order line level mod type occurs for which this service is enabled, then a copy of the order including only order lines which were modified is published at the end of the transaction. If this option is enabled for multiple mod types, and such mod types occur in a single transaction, then only one outbound order is published. When a new line has been added, an outbound message with only the newly-added line is published so that the customer can be notified via email. Publish Email When an Email Message option is configured, the respective Email Message is published. Multiple email messages can be selected for the same Mod Type, and when such mod types occur in a single transaction, all the configured Email Messages are published. Email messages can be published when an order line is canceled by the system. (not available out of the box) Publish Text When a Text Message option is configured, the respective text message is published. Multiple text messages can be selected for the same Mod Type, and when such mod types occur in a single transaction, all the configured Text Messages are published. Text messages can be published when an order line is canceled by the system. (not available out of the box) Restrict Post Confirmation If any order line level mod type is enabled for this setting, then it prevents the mod type from occurring after the order IsConfirmed flag is set to true. If disabled for a mod type, then the order can be updated even after confirmation. There is a system level restriction for some mod types, so this setting may not be editable. Quantity updates can be restricted once an order has been confirmed. Restrict from Status If restrict from status is set for any order line level mod type, then the modification type is not permitted once the order line maximum fulfillment status has reached the configured status. If restrict from status is not set, then the modification can be performed at any status. There is a system level restriction for some mod types, so this setting may not be editable. Shipping address cannot be modified once the maximum fulfillment status reaches released status. Calculate EffectiveRank If any mod type occurs for which this service is enabled, then Effective Rank for the Order Line will be recalculated. This service can be enabled for individual Prioritization Attributes which is selected in the Fulfillment Order Prioritization Configuration - Prioritization Rule. If value of a Prioritization Attribute is modified after Effective Rank was calculated, the Effective Rank may have to be recalculated to reflect this modification. Update Reservation Match Quantity When there is a change in allocated quantity in the Reservation match, inventory triggers an event ( event Name: ReservationMatchQtyChange) and invoke the mod type "Update Reservation Match Quantity" to publish Order or Orderline An order is allocated to PO1, Qty=10 EA, Allocated Qty=10 EA. PO quantity is updated to 8 EA with same ETA. Order is reallocated. Here system will trigger Quantity change event Update Reservation Match ETA When there is a change in ETA in the Reservation match, inventory triggers an event ( event Name: ReservationMatchETAChange) and invoke the mod type "Update Reservation Match ETA" to publish Order or Orderline When there is change in Reservation match, system will look for quantity change by ETA, if for the same ETA the sum of the allocated quantity changes across supply types for a location, system will trigger the ETA change event The service "Apply to unreleased units and split line" (splitOrderLine) and the order line mod type "OrderLine::SplitLine" (Split Line) has been deprecated to prevent post-release updates. Some services cannot be triggered for certain mod types, which is a system level restriction to prevent data anomalies and hence, the checkboxes for such services are grayed out by default on the order configuration -> modification rules UI and should not be modified/altered in any way which may result in undesirable system behaviour. When order line hold is applied - Sample JSON{ "OrderLineHold": [ { "UpdatedTimestamp": "2022-01-17T10:44:36.574", "HoldTypeId": "ShippingRestriction", "CreatedBy": "admin@ecomorg.com", "CreatedTimestamp": "2022-01-17T10:44:36.574", "Process": null, "ResolveReasonId": null, "ExternalCreatedDate": null, "ResolveReasonComments": null, "OrgId": "ecomorg", "UpdatedBy": "admin@ecomorg.com", "ExternalCreatedBy": null, "ContextId": "7f66968d-5a13-448f-a962-dce5135f5134", "StatusId": "1000", "ApplyReasonComments": "10004:Product class: Tops cannot be shipped to Country: US State: GA Postal Code: 30339 Po Box .", "PK": "6424162765742478777", "Unique_Identifier": "6424162765742478777__ShippingRestriction" } ] } Click here for more on Order Line Mod Types ChangeEventType ModTypeId Description ChangeEventEntity FieldName Entity::OrderLine::Add::New OrderLine::Add This mod type is triggered when an order is created but also when a line is added to the order asyncronously. OrderLine Field::OrderLine::Quantity::Increase OrderLine::Quantity::Increase OrderLine Quantity Field::OrderLine::Quantity::Decrease OrderLine::Quantity::Decrease OrderLine Quantity Field::DeliveryMethod OrderLine::DeliveryMethod OrderLine DeliveryMethod Field::SellingLocationId OrderLine::SellingLocationId OrderLine SellingLocationId Field::IsCancelled OrderLine::Cancel OrderLine IsCancelled Entity::OrderLine::Delete OrderLine::Remove OrderLine Field::OrderLine::ShipToLocationId::PickUpAtStore OrderLine::ShipToLocationId::PickUpAtStore OrderLine ShipToLocationId Field::OrderLine::ShipToLocationId::ShipToStore OrderLine::ShipToLocationId::ShipToStore OrderLine ShipToLocationId Field::FulfillmentGroupId OrderLine::FulfillmentGroupId OrderLine FulfillmentGroupId Field::IsPriceOverridden::True OrderLine::PriceOverride::Apply OrderLine IsPriceOverridden Field::IsPriceOverridden::False OrderLine::PriceOverride::Remove OrderLine IsPriceOverridden Field::TaxOverride::Apply OrderLine::TaxOverride::Apply OrderLine IsTaxOverridden Field::TaxOverride::Remove OrderLine::TaxOverride::Remove OrderLine IsTaxOverridden Group::LineDeliveryDate OrderLine::DeliveryDate OrderLine RequestedDeliveryDate, LatestDeliveryDate, DoNotShipBeforeDate Group::LineShippingInfo OrderLine::ShippingInfo OrderLine ShippingMethodId, CarrierCode, ServiceLevelCode Field::AddressId OrderLine::AddressId OrderLine AddressId Entity::OrderLinePromotionRequest::Add::New OrderLine::PromotionRequest::Add OrderLinePromotionRequest Entity::OrderLinePromotionRequest::Remove OrderLine::PromotionRequest::Remove OrderLine Entity::OrderLinePromotionRequest::Update OrderLine::PromotionRequest::Update OrderLine Field::StrategyType OrderLine::PromisingInfo::StrategyType OrderLinePromisingInfo StrategyType Entity::OrderLineChargeDetail::Discount::Add OrderLine::ChargeDetail::Discount::Add OrderLineChargeDetail Field::AssociateId OrderLineSalesAssociate::AssociateId OrderLineSalesAssociate AssociateId Event::OrderLine::ReturnQuantityCancel OrderLine::ReturnCancel OrderLine null Entity::OrderLineChargeDetail::Discount::Remove OrderLine::ChargeDetail::Discount::Remove OrderLineChargeDetail Group::OrderLineChargeDetail::Discount::Update OrderLine::ChargeDetail::Discount::Update OrderLineChargeDetail TaxCode, Status, ChargeTotal, IsInformational, IsLineDiscount, ChargeReferenceId, ChargeType, FulfillmentGroupId, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderLineChargeDetail::Appeasement::Add OrderLine::ChargeDetail::Appeasement::Add OrderLineChargeDetail Entity::OrderLineChargeDetail::Appeasement::Remove OrderLine::ChargeDetail::Appeasement::Remove OrderLineChargeDetail Group::OrderLineChargeDetail::Appeasement::Update OrderLine::ChargeDetail::Appeasement::Update OrderLineChargeDetail TaxCode, Status, ChargeTotal, IsInformational, IsLineDiscount, ChargeReferenceId, ChargeType, FulfillmentGroupId, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderLineChargeDetail::VAS::Add OrderLine::ChargeDetail::VAS::Add OrderLineChargeDetail Entity::OrderLineChargeDetail::VAS::Remove OrderLine::ChargeDetail::VAS::Remove OrderLineChargeDetail Group::OrderLineChargeDetail::VAS::Update OrderLine::ChargeDetail::VAS::Update OrderLineChargeDetail TaxCode, Status, ChargeTotal, IsInformational, IsLineDiscount, ChargeReferenceId, ChargeType, FulfillmentGroupId, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderLineChargeDetail::Promotion::Add OrderLine::ChargeDetail::Promotion::Add OrderLineChargeDetail Entity::OrderLineChargeDetail::Promotion::Remove OrderLine::ChargeDetail::Promotion::Remove OrderLineChargeDetail Group::OrderLineChargeDetail::Promotion::Update OrderLine::ChargeDetail::Promotion::Update OrderLineChargeDetail TaxCode, Status, ChargeTotal, IsInformational, IsLineDiscount, ChargeReferenceId, ChargeType, FulfillmentGroupId, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderLineChargeDetail::Coupon::Add OrderLine::ChargeDetail::Coupon::Add OrderLineChargeDetail Field::ItemId OrderLine::ItemId::Update OrderLine Entity::OrderLineChargeDetail::Coupon::Remove OrderLine::ChargeDetail::Coupon::Remove OrderLineChargeDetail Group::OrderLineChargeDetail::Coupon::Update OrderLine::ChargeDetail::Coupon::Update OrderLineChargeDetail TaxCode, Status, ChargeTotal, IsInformational, IsLineDiscount, ChargeReferenceId, ChargeType, FulfillmentGroupId, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Entity::OrderLineChargeDetail::Charge::Add OrderLine::ChargeDetail::Charge::Add OrderLineChargeDetail ChargeType Entity::OrderLineChargeDetail::Charge::Remove OrderLine::ChargeDetail::Charge::Remove OrderLineChargeDetail Group::OrderLineChargeDetail::Charge::Update OrderLine::ChargeDetail::Charge::Update OrderLineChargeDetail TaxCode, Status, ChargeTotal, IsInformational, IsLineDiscount, ChargeReferenceId, ChargeType, FulfillmentGroupId, RelatedChargeDetailId, RelatedChargeType, RequestedAmount Group::PromisingPurchaseOrderInfo OrderLine::PromisingInfo::PurchaseOrder OrderLinePromisingInfo PoId, PoDetailId Group::PromisingShipmentInfo OrderLine::PromisingInfo::Shipment OrderLinePromisingInfo AsnId, AsnDetailId Group::PromisingLocationInfo OrderLine::PromisingInfo::Location OrderLinePromisingInfo ConsolidatationLocationId, ShipThroughLocationId, ShipFromLocationId Group::PromisingInventoryInfo OrderLine::PromisingInfo::Inventory OrderLinePromisingInfo InventorySegmentId, ReqCapacityPerUnit, InventoryTypeId, ProductStatusId, BatchNumber, CountryOfOrigin Group::PromisingItemInfo OrderLine::PromisingInfo::ItemAttribute OrderLinePromisingInfo ItemAttribute1, ItemAttribute2, ItemAttribute3, ItemAttribute4, ItemAttribute5 Entity::OrderLineHold::Add::New OrderLine::Hold::Apply OrderLineHold Entity::OrderLineHold::Resolve OrderLine::OrderLineHold::Resolve OrderLineHold StatusId Entity::OrderLineNote::Instruction::Add::New OrderLine::Note::Instruction::Add OrderLineNote Entity::OrderLineNote::Instruction::Remove OrderLine::Note::Instruction::Remove OrderLine Group::OrderLineNote::Instruction::Update OrderLine::Note::Instruction::Update OrderLineNote NoteCategory, NoteType, DisplaySequence, NoteText, IsVisible Entity::OrderLineNote::Add::New OrderLine::Note::Add OrderLineNote Entity::OrderLineNote::Remove OrderLine::Note::Remove OrderLine Group::OrderLineNoteUpdate::New OrderLine::Note::Update OrderLineNote NoteCategory, NoteType, DisplaySequence, NoteText, IsVisible Entity::OrderLineAttribute::Add::New OrderLine::Attribute::Add OrderLineAttribute Entity::OrderLineAttribute::Remove OrderLine::Attribute::Remove OrderLine Group::OrderLineAttributeUpdate OrderLine::Attribute::Update OrderLineAttribute AttributeName, AttributeValue Entity::OrderLineTagDetail::Add OrderLine::Tag::Add OrderLine Field::EffectiveRank OrderLine::EffectiveRank OrderLine EffectiveRank Entity::OrderLineTagDetail::Remove OrderLine::Tag::Remove OrderLine Field::LastPossibleDeliveryDate OrderLine::PromisingInfo::LastPossibleDeliveryDate OrderLinePromisingInfo LastPossibleDeliveryDate Entity::OrderLineHold::Remove OrderLine::Hold::Resolve OrderLine Field::ChargeType::Update OrderLine::ChargeDetail::ChargeType::Update OrderLineChargeDetail ChargeType Field::IsGift OrderLine::IsGift OrderLine IsGift Entity::OrderLineSalesAssociate::Add OrderLine::OrderLineSalesAssociate::Add OrderLine Field::IsTaxOverridden::True OrderLine::TaxOverridden::Apply OrderLine IsTaxOverridden Field::IsTaxOverridden::False OrderLine::TaxOverridden::Remove OrderLine IsTaxOverridden Field::IsPriceOverridden::UnitPrice::Update OrderLine::PriceOverride::UnitPrice OrderLine UnitPrice Event::OrderLine::SplitLine OrderLine::SplitLine This mod type is triggered when a line is split as a result of an update OrderLine Event::OrderLine:MergeLegFulfillment OrderLine::MergeLegFulfillment This mod type is triggered when a movement of the fulfilled quantity occurs for a merge leg. This applies to any shipment of any merge leg, ship to address or ship to store. ReleaseLine FufilledQuantity Return Line Level Modification Rules Return line modification rules are defined for any return line level attributes or entities which can be modified. For example, updating item condition and applying a return fee are categorized as return line mod types. The return line mod types are applicable only to return lines, which are defined by IsReturn = true. For each return line mod type, the below services can be configured: Service Description Example Calculate Price This service is applicable only to standalone return lines, which have a null parent order ID/parent order line ID. If a return line level mod type occurs for which this service is enabled, then the order line is re-priced. It is recommended to enable calculate return fee, calculate S&H charge, and calculate tax services whenever this service is enabled. Adding a new return line without parent order & Order line ID requires price calculation. Calculate S&H Charge If a return line level mod type occurs for which this service is enabled, then the order is sent to the S&H component to calculate S&H charges for the entire order. Changing return line shipping method requires recalculation of S&H charges. Calculate Return Fees If a return line level mod type occurs for which this service is enabled, then the Order component calculates return fees for that line by using local return fee configuration. Updating line quantity requires recalculation of return fees. Calculate Tax This service is applicable only to standalone return lines, which have a null parent order ID/parent order line ID. If a return line level mod type occurs for which this service is enabled, then the order is sent to the Vertex component to recalculate tax for the entire order. Updating Line quantity requires tax to be recalculated. Publish Order If any return line level mod type occurs for which this service is enabled, then a copy of the order including all order lines is published at the end of the transaction. If this option is enabled for multiple mod types, and such mod types occur in a single transaction, then only one outbound order is published. When a line has been canceled, an outbound order is published so that the customer can be notified via email. The format and the attributes that get published can be controlled by a template that can be configured on the Order Configuration -> General Tab - > Publish Order -> Publish Order Template dropdown after creating a custom template. Publish Order Line If any return line level mod type occurs for which this service is enabled, then a copy of the order including only order lines which were modified is published at the end of the transaction. If this option is enabled for multiple mod types, and such mod types occur in a single transaction, then only one outbound order is published. When a new line has been added, an outbound message with only the newly-added line is published so that the customer can be notified via email. The format and the attributes that get published can be controlled by a template that can be configured on the Order Configuration -> General Tab - > Publish Order -> Publish Order Line Template dropdown after creating a custom template. Publish Email When an Email Message option is configured, the respective Email Message is published. Multiple email messages can be selected for the same Mod Type, and when such mod types occur in a single transaction, all the configured Email Messages are published. Email messages can be published when return order line is approved for return refund. (not available out of the box) Publish Text When a Text Message option is configured, the respective Text Message is published. Multiple text messages can be selected for the same Mod Type, and when such mod types occur in a single transaction, all the configured Text Messages are published. Text messages can be published when return order line is approved for return refund. (not available out of the box) Restrict Post Confirmation If any return line level mod type is enabled for this setting, then it prevents the mod type from occurring after the order IsConfirmed flag is set to true. If disabled for a mod type, then the order can be updated even after confirmation. There is a system level restriction for some mod types, so this setting may not be editable. Quantity updates can be restricted post confirmation, since return ASN and labels have already been generated. Restrict from Return Status If restrict from return status is set for any return line level mod type, then the modification type is not permitted once the order line maximum return status has reached the configured status. If no restrict from status is set, then the modification can be performed at any status. There is a system level restriction for some mod types, so this setting may not be editable. Cancelation of return line can be restricted once return items have been received. Some services cannot be triggered for certain mod types, which is a system level restriction to prevent data anomalies and hence, the checkboxes for such services are grayed out by default on the order configuration -> modification rules UI and should not be modified/altered in any way which may result in undesirable system behaviour. Similarly, Restrict from Return Status can be modified only if it is allowed by the UI. Altering the base behaviour to enable the statuses that can be selected in Restrict from Return Status dropdown and selecting them may result in undesirable system behaviour. Click here for more on Return Line Mod Types ChangeEventType ModTypeId Description ChangeEventEntity FieldName Entity::OrderLine::Add::New ReturnOrderLine::Add "ReturnOrderLine::Add" mod will be invoked when return line is added (i.e when order line is added where isReturn = true) OrderLine IsReturn Field::OrderLine::Quantity::Increase ReturnOrderLine::Quantity::Increase ReturnOrderLine::Quantity::Increase will be invoked when the return line qty is increased OrderLine Quantity Field::OrderLine::Quantity::Decrease ReturnOrderLine::Quantity::Decrease ReturnOrderLine::Quantity::Increase will be invoked when the return line qty is decreased OrderLine Quantity Field::ShipFromAddressId ReturnOrderLine::ShipFromAddressId ReturnOrderLine::ShipFromAddressId will be invoked when the return line ship from address Id is added or updated. OrderLine ShipFromAddressId Field::SellingLocationId ReturnOrderLine::SellingLocationId OrderLine SellingLocationId Group::LineShippingInfo ReturnOrderLine::ShippingInfo OrderLine ShippingMethodId, CarrierCode, ServiceLevelCode Field::FulfillmentGroupId ReturnOrderLine::FulfillmentGroupId OrderLine FulfillmentGroupId Field::OrderLine::ShipToLocationId::ShipToReturnCenter ReturnOrderLine::ShipToLocationId::ShipToReturnCenter OrderLine ShipToLocationId Field::IsReceiptExpected ReturnOrderLine::ReceiptExpected OrderLine IsReceiptExpected Entity::OrderLineHold::Add::New ReturnOrderLine::Hold::Apply OrderLineHold Entity::OrderLineHold::Remove ReturnOrderLine::Hold::Resolve OrderLine Entity::OrderLineNote::Add::New ReturnOrderLine::Note::Add OrderLineNote Entity::OrderLineNote::Update ReturnOrderLine::Note::Update OrderLine Entity::OrderLineNote::Remove ReturnOrderLine::Note::Remove OrderLine Entity::OrderLineAttribute::Add::New ReturnOrderLine::Attribute::Add OrderLineAttribute Entity::OrderLineAttribute::Remove ReturnOrderLine::Attribute::Remove OrderLine Entity::OrderLineAttribute::Update ReturnOrderLine::Attribute::Update OrderLine Entity::OrderLineChargeDetail::ReturnFee::Add ReturnOrderLine::ChargeDetail::ReturnFee::Add OrderLineChargeDetail Entity::OrderLineChargeDetail::ReturnFee::Remove ReturnOrderLine::ChargeDetail::ReturnFee::Remove OrderLineChargeDetail Group::OrderLineChargeDetail::ReturnFee::Update ReturnOrderLine::ChargeDetail::ReturnFee::Update OrderLineChargeDetail TaxCode, ChargeTotal, IsInformational, IsLineDiscount, FulfillmentGroupId, RelatedChargeDetailId, RelatedChargeType, RequestedAmount, ChargePercent, IsTaxIncluded Field::ChargeType::Update ReturnOrderLine::ChargeDetail::ChargeType::Update OrderLineChargeDetail ChargeType Field::IsReturn::False ReturnOrderLine::IsReturn::False OrderLine IsReturn Field::ParentOrderId ReturnOrderLine::ParentOrderId OrderLine ParentOrderId Field::ParentOrderLineId ReturnOrderLine::ParentOrderLineId OrderLine ParentOrderLineId Entity::OrderLine::Delete ReturnOrderLine::Remove OrderLine Field::IsCancelled ReturnOrderLine::Cancel OrderLine IsCancelled Field::ReturnReason ReturnOrderLine::ReturnReason OrderLineAdditional ReturnReason Field::ItemCondition ReturnOrderLine::ItemCondition OrderLineAdditional ItemCondition Field::DeliveryMethod ReturnOrderLine::DeliveryMethod OrderLine DeliveryMethod Field::OrderLineChargeDetail::ReturnFee::IsOverridden::True ReturnOrderLine::ChargeDetail::ReturnFee::Override::Apply OrderLineChargeDetail IsOverridden Field::OrderLineChargeDetail::ReturnFee::IsOverridden::False ReturnOrderLine::ChargeDetail::ReturnFee::Override::Remove OrderLineChargeDetail IsOverridden Field::IsPriceOverridden::True ReturnOrderLine::PriceOverride::Apply OrderLine IsPriceOverridden Field::IsPriceOverridden::False ReturnOrderLine::PriceOverride::Remove OrderLine IsPriceOverridden Quantity Level Modification Rules Quantity modification rules are configured based on quantity status changes. The configuration allows an order to be published each time the quantity in a status increases. For example, an outbound order line should be published each time the Fulfilled quantity increases. Similarly, an outbound order line should be published each time the Canceled status increases. Both sale and return line quantities are eligible for quantity level modification rules. Manhattan's Digital Self-Service URL is also included in the Publish Order Outbound at Order Line level which is populated currently for order lines with Pickup At Store and Ship To Store delivery method (irrespective of the Delivery Method Sub Type) When an Email Message option is configured for Publish Email, the respective Email Message is published. Multiple email messages can be selected for the same Mod Type, and when such mod types occur in a single transaction, all the configured Email Messages are published. For example when order is shipped, Shipment Confirmation email message is published so that an email marketing system can send the customer a ship confirmation email. This modification type is independent of the order line status but listens to the quantity detail table. Each status, including extended statuses, is displayed in the quantity modification rule table. For each quantity modification type, two services can be enabled: Publish Order and Publish Order Line. Note: Currently, there is no Modification Rule or Mod Type available for Canceled Quantity. One workaround is to use Quantity Decrease Mod Type to trigger the required service. For example, Publish Order Line. If Cancel Reason Id is required, it is available in Order Line Cancel History and you can match the Context Id of the Order and the Context Id available on the Order Line Cancel History to find the details of quantities canceled for the current transaction. How Tos How to Configure Modification Rules The modification rules for Order Level, Order Line Level, Return Line Level, and Quantity Level can be configured in the Order Configuration UI.  Refer to the following sections for more details on the services that can be configured for each mod type: Order Level Order Line Level Return Line Level Quantity Level How to Add New Mod Types ? To support customer requirements, new mod types are added periodically to the mod types table. These are added to the order config table in order to use them. There are a few ways to do this: If an environment is new - in this case, all order configs would have the current list of mod types. Run a sync API in Postman - in this case, all order configs would have the current list of mod types. POST /api/order/orderConfig/sync (no body) Manually add these via Postman to an individual order config. Though this is not recommended as sync is cleaner and consistent across all configs, it's possible to do it this way. How to Add Mod Types to Order Configuration Use the following import API to add mod types to order configuration POST : url/order/api/order/modType/import How to Sync Newly Added Mod Types For existing Order Config, the newly added mod types will not be displayed automatically. You need to sync the Order configuration and refresh the UI. Use the following API to sync order configuration POST {{url}}/order/api/order/modTypeConfig/sync { "data": [ { "OrderConfigId": "EcommConfig", "ModTypes": [ { "ModTypeId": "Order::Add" } ] } ] } For newly created order config (that is, if the environment is new), the new mod types will be automatically displayed. Implementation Flavors How to add a custom user exit for a mod type ? Click here for details on how to add a custom user exit for a mod type Get the required order config using: {{url}}/order/api/order/orderConfig/orderConfigId/<<configId>> Find the mod type for which user exit has to be added in the ModTypeConfig section Add the below section to the required ModTypeConfig CustomServiceConfig "CustomServiceConfig": [ { "CustomServiceExtensionPointId": "Order:Order:UserExit:CustomExtensionService1" } ] Example { "RestrictFromStatus": "3000", "PublishOrder": false, "ResubmitPipeline": false, "CustomServiceConfig": [ { "CustomServiceExtensionPointId": "Order:Order:UserExit:CustomExtensionService1" } ], "RestrictPostConfirmation": false, "Status": null, "ChangeStatus": null, "UpdatedTimestamp": "2018-11-02T07:37:56.653", "PublishOrderLine": false, "CalculateReturnFee": false, "RestrictFromReturnStatus": null, "ReevaluatePipeline": false, "ModType": { "ModTypeId": "OrderLine::Quantity::Decrease" }, "CancelReservation": false, "CalculateSnh": true, "CalculatePrice": true, "CalculateTax": true, "EvaluatePromotion": true } Create ExtensionHandler: Create an extension handler to call the custom component. POST {{url}}/order/api/ServiceDefinition/extensionHandler/save Payload { "RegisteredExtensionPoints": [ { "EntryCondition": null, "ExtensionPointId": "Order:Order:UserExit:CustomExtensionService1" } ], "ExtensionhandlerRoute": [ { "Destination": "<<DestinationID>>", "SourceId": "ON_EVENT", "IsSync": true, "DestinationId": "<<DestinationID>>", "Source": "ON_EVENT", "ExtensionhandlerRouteId": "<<RouteID>>", "DestinationParams": [] } ], "ExtensionHandlerId": "<<ExtensionHandlerID>>" } Adding new Mod Type: POST  {{url}}/order/api/order/modType/save Payload { "IsCalculateSnhEditable": true, "IsResubmitPipelineEditable": true, "DisplaySequence": 530, "IsReevaluatePipelineEditable": true, "RestrictFromStatus": null, "IsCalculatePriceEditable": true, "IsCalculateReturnFeeEditable": true, "ResubmitPipeline": false, "ModLevel": "Order", "ChangeEventType": "Field::PublishStatus", "IsCancelReservationEditable": true, "IsCalculateTaxEditable": true, "FieldName": "PublishStatus", "RestrictPostConfirmation": false, "ChangeStatus": "1000", "CalculateReturnFee": false, "RestrictFromReturnStatus": null, "IsChangeStatusEditable": true, "ReevaluatePipeline": false, "IsEvaluatePromotionEditable": true, "ChangeEventEntity": "Order", "ModTypeId": "PublishStatus", "CancelReservation": false, "CalculateSnh": true, "CalculatePrice": true, "EvaluatePromotion": true, "CalculateTax": true } Hint: ModLevel = The entity name ChangeEventType = If it is a field, then Field::<<Field_Name>>. If it is a child entity change then either of below values: Entity::OrderLine::Add Entity::OrderLine::Update Entity::OrderLine::Remove Entity::OrderLine::List::Clear Note: The order component has to be restarted when a new Mod Type is added. Sync the newly added mod type to all the order config: To add the new created mod type to all then existing Order Config, use the below api: POST: {{url}}/order/api/order/orderConfig/sync How to add a new mod type with extended attributes ? Extended attributes added to Order and Order Line can be used for adding custom mod types. Follow the steps below to add an order and order line extended attribute and use them in the modTypes : Only extended attributes added to Order and Order Line can be used for adding custom mod types. Extended attributes added to any other child entity other than order and order line cannot be used for defining custom mod types. Custom mod types on extended attributes are only supported for Order, OrderAttribute, OrderChargeDetail, OrderHold, OrderLineAttribute, OrderLineChargeDetail, OrderLine, OrderLineHold, OrderLineNote, OrderLinePromisingInfo, OrderLinePromotionRequest, OrderNote, OrderPromisingInfo, OrderPromotionRequest, OrderTrackingInfo, QuantityDetail, ReturnTrackingDetail entities. 1. Add an order or order line extended attribute in the consul and restart the order component. 2. Post a mod type JSON, Since the order mod type is systemAugmentable, this should be added with the systemAdmin token. Note: The order component has to be restarted when a new Mod Type is added. API - [Post] /api/order/modType/save 3. Sync order configuration API - [Post]/api/order/orderConfig/sync 4. Update the orderConfig to add the new mod type either through postman or UI. Example: Add an extended order attribute and have publishOrder enabled in the mod type API - [Post] /api/order/orderConfig/save 5. Post an order and send an order update by populating the extended attribute and validate if the extended attribute is published as part of the order outbound message Note: While saving the modType, populate the DisplaySequence so that the new mod type appears in the modification rules. Basically, if the display sequence is null, it should be listed at the end. Which user exit should be used to update the extended attribute when a quantity is backordered? One can leverage custom extension point tied to {{ QuantityDetail::QuantityStatus::Increase}} modtype for back-ordered status. Update discount or promotion value on quantity decrease when evaluate Price is not configured When the quantity is shorted from fulfillment or decreased in call center or backordered quantity is cancelled through cancellation scheduler, and if evaluate price is not configured, then the discounts are not re-evaulated. For example, An Ecom Order is imported from an Online Store (Front-End) The order has 1 order line with 2 qty. Let's say $50 each, so the line total is $100. The order has a discount on ItemPrice under OrderLineChargeDetail -$20. This is intended to be -$10 discount on each unit. Order is released, fulfillment short for 1 quantity Customer wants to cancel only -$10 discount and still apply -$10 discount for rest of the item. Currently, -$20 discount remains as is. To achieve the above requirement, implement QuantityDetail::QuantityStatus::Decrease mod type and apply custom logic to update discount value. How can an STS Order be canceled when the order is between "Shipped" from DC1 and "Released" at DC2 This can be achieved using IsModTypeAllowed user exit. However, it would require an enhancement from base to add Order Id / Order Line Id to the existing user exit request: IsModTypeAllowed. How to update customer ID beyond restricted status Requirement: In case of a customer data reconciliation process, if old orders need to be updated with new customer ID and there exists a restriction for changing customer ID through mod type defined in Order Configuration, how to update customer ID beyond restricted status, for example (update customer Id on a released order or a fulfilled order) Implementation: Use “IsImport” flag on order json, which will bypass the validation. Note that this is recommended only for a single update like CustomerId and not for multiple updates. It is recommended not to use this approach in case there are different updates on a single order. Note: If the order was already fulfilled and invoice was generated prior to the customer ID update, then the invoice will still reflect older customer id Mod Type for specific field in address object Address is a standalone entity defined in framework layer. The hash key is generated as Address Id and stored in order line. Since this table is defined in the framework, change events are not available and the modification type cannot be defined for any specific field. This can be achieved by configuring a custom service for OrderLine::AddressId ModType. In custom service, do a get order and compare the input order object with the get order response to compare the changes. Change event format which can be defined for modification type Field::<FieldName> -> Change event for a specific base field. When the field is modified, then the respective modification type is triggered. Group::<GroupName> -> Change event for a group of fields. When one of the multiple fields which are bound to the same change event is modified, then the respective modification type is triggered. Example, Group::LineShippingInfo change event will be triggered when one of the fields, ShippingMethodId, CarrierCode, ServiceLevelCode are modified. One can find the group name by using the metadata API. {{url}}/order/api/fwcore/metadata/<EntityName> Entity::<EntityName>::Add -> Change event to add new record. Example, Entity::Allocation::Add Entity::<EntityName>::Update -> Change event to update the record. Example, Entity::Allocation::Update Entity::<EntityName>::Remove -> Change event to remove the record. Example: Entity::Allocation::Remove Entity::<EntityName>::List::Clear -> When the entire list of objects is cleared. How to prevent multiple allocations for ship to store orders while updating Requested Delivery Date(RDD) Requirement: While using PostAllocateOrder user exit to update Requested Delivery Date(RDD) on the order line, two allocation records are created with merge and pickup leg each for a single order line, which results in two releases. The requirement is to prevent multiple allocations for STS orders while updating Requested Delivery Date(RDD). Implementation: In QuantityDetail::QuantityStatus::Increase ModType for Allocation CustomExtension flow, modify fields where respective ModTypes have ChangeStatus configured. In the custom extension service of QuantityDetail::QuantityStatus::Increase ModType, any update to fields which have ChangeStatus configured will move line status to open and will resubmit pipeline. Hence, before updating these fields in user exit, invoke the below API to deallocate the line which is already allocated in the current transaction. /inventory/api/inventory/reservationRequestDetails/deallocate In the Input Payload, one can pass a list of ReservationRequestDetailIds and need to pass postToOrder=true. Once a reservation is deallocated, and if postToOrder is true, then inventory will post a message so that the order will update corresponding allocation objects on the order side. How to add modification type for quantity field in OrderLineComponent Login as system admin and add a new modification type with the below-mentioned values, and then add this modification type to the desired order configuration. "ModTypeId": "OrderLine::OrderLineComponents::Quantity", "ChangeEventType": "Field::Quantity", "ChangeEventEntity": "OrderLineComponents", "ModLevel": "OrderLine" Make sure to restart the order component after the modification type is added. Sync the newly added modification type using the following mod type sync API POST {{url}}/order/api/order/modTypeConfig/sync { "data": [ { "OrderConfigId": "{{OrderConfigId}}", "ModTypes": [ { "ModTypeId": "OrderLine::OrderLineComponents::Quantity" } ] } ] } Which user exit should be used to perform actions when carrier delivery statuses are customized Requirement: How to trigger PublishOrder message when a package is delivered at a shop. Introduce ModType on ChangeEvent = Entity::OrderTrackingInfo::OrderTrackingDetail::Add Implement CustomExtensionService for this modType In custom, check if OrderTrackingDetail has value for StatusSubType = ParcelShopDelivered, then invoke API /order/api/order/order/publish which will publish the order. Refer here for more information on publishing order. Troubleshooting What if mod type based on a newly added extended attribute is not triggering the required service? Restart the order container post adding the mod type for registering the mod type. What if the mod type is updated, but changes are not being shown on UI The display sequence needs to be updated. Why is my mod type not getting triggered It is possible that multiple extensions are linked to the same modType. For example, if ModType “OnConfirmModType” is linked to two Extension Points : CustomExtensionService1 and CustomExtensionService2, then resetting one of these extension points would work. Make sure ExtensionPointToMSGType and the corresponding Outbound/Inbound are configured. How can I verify if a mod type is being triggered or not Enable TRACE log for below two in Order component: com.manh.cp.order.modtype Logs: >> validateAndPropagateOrderChangeEvent() {0} event raised for order >> validateAndPropagateLineChangeEvent() {0} event raised for line --processOrderConfigChangeEvents() Order id {}, order mods com.manh.cp.order.selling.price.handler.OrderCustomComponentHandler Logs: --callCustomComponents() Calling Custom Service: --callCustomComponents0() Request sent --callCustomComponents0() Request sent means mod type is getting triggered Custom mod type is not invoked when inserting new values to the extended Attribute An extended attribute/flag can be introduced at order level or line level which can be populated in addline mod type to decide whether to call an extension service or not. The listener to publish message can read this flag and execute custom extension service logic and set this flag back to false. If there is a mod type added for an extended field under an entity, then this mod type will not be triggered for new object creation. Example: Under OrderTrackingInfo, an extended field is defined and mod type is defined for this extended field. When a new OrderTrackingInfo record is created, this mod type will not be triggered. This is triggered only when the extended field is modified after the record is created. Note: When configuring modification types on extended fields, users cannot configure multiple ModTypeIds against one extended field. Instead, use different extended fields and have corresponding modification types defined. Related Articles Order CancellationOrder TaggingOrder ArchivingPublishing Order Cart and Preview ModeOrder Orchestration ProcessOrder Orchestration ConfigurationDelivery TrackingCreating and Updating OrderHoldsShipping RestrictionOrder Audit