# Payment Gateway Integration

**Permalink:** payment-gateway-integration
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Selling/Payment/Payment Gateway Integration
**Content Length:** 54,849 characters
**Scraped:** 2025-08-09T21:58:51.333213

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Selling››Payment ››Payment Gateway Integration Payment Gateway Integration Previous I Next This section explains how Active® Omni integrates with third-party payment gateways to process payments. OverviewGateways & Transactions Supported Out of the BoxPayment Gateway RequestsExtending the Gateway Request InterfacePayment Gateway ResponsesGateway Response MappingsPayment Gateway AccountsAccount Selection ProcessPayment Gateway Configuration Saving Sensitive Data as part of Gateway ConfigurationsAdyen Gateway ConfigurationCyberSource Gateway ConfigurationPayPal Gateway ConfigurationPAYware Connect Gateway ConfigurationUploading Certificate FilesVisa Mandate 2019Implementation FlavorsHow to add additional request fields to CyberSource RequestPayment Gateways Requiring Same Transaction Request Id Across TransactionsRelated Articles Overview The payment component integrates with a third-party payment gateway to process credit cards, debit cards, e-check, gift card, PayPal, and store credit payments. Supported gateways include Adyen, CyberSource, PayPal, and PAYware Connect. Integration with other gateways can be done with configuration and translation changes. Gateways & Transactions Supported Out of the Box The following payment types and transaction types are supported out of the box for each gateway: Gateway Supported Payment Type Supported Transaction Types Adyen Credit Card Authorization Settlement Refund Authorization Reversal Void Gift Card Authorization Settlement Authorization Reversal Balance Check Apple Pay Authorization Settlement Refund Authorization Reversal PayPal Authorization Settlement Refund CyberSource Credit Card Authorization Settlement Refund Void E-Check Authorization (Authentication) Settlement Refund PayPal PayPal Authorization Settlement Refund PAYware Connect Credit Card Authorization Settlement Refund Void Debit Settlement Refund Gift Card Authorization Settlement Refund Void Activate Deactivate Reload Payment Gateway Requests Since each gateway has a unique request and response format, the Payment Gateway component translates the generic payment gateway request into the gateway-specific format. The basic payment gateway request interface is sent from payment to the Payment Gateway component and contains data from the payment method, transaction, method attributes, billing address, and transaction attributes. Some third-party gateways may require additional order or customer information, in which case user exits can be used to retrieve data from the Order and Customer components before sending the request to the Payment Gateway component. For example, if an external payment system which processes e-gift card payments requires order type, customer name, and customer email, then the retailer can leverage user exits to retrieve order type from the Order component and customer name and email from the customer component before sending the payment request to the e-gift card system. Extending the Gateway Request Interface The gateway request interface contains data from the payment header, including payment methods and billing addresses, but it does not include data from the order or customer entities. If additional order and customer data is required, then the payment gateway request user exits can be used to retrieve additional data such as ship-to address from the Order and Customer components before sending the request to the gateway. For example, a retailer's external payment system which processes e-gift card payments requires order type, customer name, and customer email. The retailer leverages these two user exits to retrieve order type from the Order component and customer name and email from the Customer component before sending the payment request to the e-gift card system. A second example is a retailer who includes customer information on the payment request for fraud detection. No out of the box response templates exist for the order and customer responses. Response templates must be configured to include the data which the payment gateways require. Payment Gateway Responses The response from the third-party payment gateway must be translated into Active® Omni format. If using CyberSource, PayPal, or PAYware Connect out of the box, the integration is provided out of the box. Otherwise, integration must be built between the payment gateway and Active® Omni. See the mapping documents for more details. Gateway Response Mappings The response from the payment gateway contains an externalResponseId which indicates the outcome of the payment transaction. Each gateway has unique values, so each externalResponseId is mapped to one of four response statuses; Success, Failure, Fraud and Unavailable. If no payment gateway response mapping is found for an externalResponseId received from a gateway, then the response status defaults to Success. Seed data is provided to map the externalResponseIds for Adyen, CyberSource (credit card and e-check), and PayPal. If any new gateways are configured, then add entries to the gateway response mapping table for all possible externalResponseId values. Configure the Gateway Response Mapping values in the Gateway Response Mapping UI. How to add gateway response mapping: Identify the missing response code. For example: An Adyen response code "12345" for credit card payments indicates that a payment transaction has failed. Configure via Gateway Response Mapping UI Open the Gateway Response Mapping UI Add a response mapping configuration, for example: Gateway Id = AdyenPayments Payment Type Id = Credit Card External Response Code = 12345 Response Decision Id = Failure Configure via API Configure a single response code POST {{URL}}/paymentgateway/api/paymentgateway/gatewayResponseMapping/save { "PaymentTypeId": "Credit Card", "GatewayId": "AdyenPayments", "ResponseDecisionId": "Failure", "ExternalResponseCode": "12345" } Configure a list of response codes POST {{URL}}/paymentgateway/api/paymentgateway/gatewayResponseMapping/import { "Data": [ { "PaymentTypeId": "Credit Card", "GatewayId": "AdyenPayments", "ResponseDecisionId": "Failure", "ExternalResponseCode": "12345" }, { "PaymentTypeId": "Credit Card", "GatewayId": "AdyenPayments", "ResponseDecisionId": "Failure", "ExternalResponseCode": "67890" } ] } Copy from the base profile Copy the "pds::gatewayConfig" provisioning profile from 'base' to your desired profile in the Provisioning Profiles UI Note: This will copy all response mapping data from the 'base' profile to your profile. When adding additional payment response codes, it is important to map them to the correct value for the ResponseDecisionId, as these are assumed to contain the exact values supported for payment response status including case sensitivity. Be sure to configure the response decision as one of the following values to ensure proper payment processing takes place. Response Decision Id Description Success If the response status is Success, then the payment transaction has been successfully processed and the processed amount reflects the amount processed. Failure If the response status is Failure, then no amount has been processed on the transaction. UnAvailable If the response status is UnAvailable, then the payment gateway can not be contacted. When an unavailable response is received and the transaction remaining attempts are greater than zero, the transaction is copied to a new, open transaction which is executed to retry the payment and the remaining attempts are decremented. When an unavailable response is received and remaining attempts are zero, no further retries are executed. Fraud If the response status is fraud, then the payment transaction has been successfully processed but was flagged as fraud. The payment method and payment summary are updated based on the processed amount. Payment Gateway Accounts Retailers can manage multiple payment gateway accounts within a single payment gateway, providing flexibility to handle different regions, currencies, and locations. These accounts must be mapped to specific locations to facilitate payment processing. Below are key aspects of how payment gateway accounts work: A single payment gateway can be associated with multiple gateway accounts. Each gateway account can be mapped to a LocationId. This ensures that the correct payment gateway account is used for payments associated with a particular location. Gateway accounts can contain various attributes in the form of key-value pairs, which may be used to define specific configuration settings such as payment methods, currencies, and other parameters necessary for processing payments. Account Selection Process During payment processing, the system identifies the appropriate gateway based on the associated Payment Rule. The gateway account can be determined in two ways, depending on the payment processing use case: Capturing New Payment During hosted payment flows, when a payment method is yet to be added to the order, once a payment gateway has been identified, a gateway account is identified based on the order SellingLocationId. If the order has a SellingLocationId populated, this value is used to match to a corresponding gateway account LocationId. This is a specific gateway account used to load the appropriate hosted payment page, and submit captured payment details to the gateway to save a payment method to the order. If no selling location is populated on the order, a gateway account with no LocationId populated is selected. Only one gateway account should be configured with no LocationId populated. Note: To ensure the system considers order selling location to select the correct gateway account, enable the 'Use Selling Location for Gateway Account Selection' in payment gateway configuration. Processing Captured Payment During the processing of captured payment, such as authorization after tokenization and follow-on payment transactions, a location Id may be set directly at the payment method level. Transactions against this payment method will use this value to identify the correct gateway account. If the payment method includes a LocationId from the payment capture process, the system will automatically identify and use the corresponding gateway account mapped to that LocationId. If the payment method does not include a LocationId from the payment capture process, a gateway account with no LocationId populated is selected. Only one gateway account should be configured with no LocationId populated. Payment Gateway Configuration The payment gateway entity contains information required to connect with each third party gateway. This includes information such as the endpoint and key-value attributes which are used to define any attributes required in the gateway request. Sample JSONs to configure CyberSource and PayPal gateways are below. Use these sample JSONs to add client-specific account data and import to the endpoint. These can also be configured in the Payment Gateways UI. /payment/api/payment/gateway/save In addition to importing gateway jsons, any sensitive gateway configuration such as account information, usernames, or passwords needs to be configured in the configuration repository. Saving Sensitive Data as part of Gateway Configurations The sensitive information about Gateway configurations can be saved in the GatewayEncryptedAttribute entity which is a child key/value table to the Gateway entity. Adyen Gateway Configuration To use Adyen, key gateway attributes need to be added to the Adyen Payment Gateway. The following is provided out of the box, however, this must be modified with relevant details from your Adyen account to finalize the integration. { "GatewayId": "AdyenPayments", "IsBase": true, "PerformsStandaloneRefunds": true, "ProcessStuckTransaction": true, "Account": [ { "AccountId": "AdyenPaymentsAccount", "LocationId": null, "AccountAttribute": [ { "Name": "sendToProduction", "Value": "false" } ] } ] } Additional configuration can be done in the Payment Gateway UI. Gateway Configuration Attribute Name Attribute Value Relevant Function Description Account Attribute sendToProduction "true" or "false" EOM Payments Indicates whether to hit a live or test Adyen endpoint. This should be "true" only in production environments. Account Attribute liveEndPointUrlPrefix Adyen live endpoint URL prefix EOM Payments POS Payments Specifies the URL prefix when calling Adyen for live transactions. This value is configured within the Adyen merchant account and is only required in production environments. Account Attribute WebhookURL Generated webhook URL EOM Payments This is auto-generated and automatically applied to the gateway configuration when configuring the authentication credentials. Used as an endpoint for Adyen to send webhook events. Account Attribute DocumentId Generated document Id EOM Payments Pay By Link Customer Service This is auto-generated and automatically applied to the gateway configuration when configuring the authentication credentials. Used to store secure Adyen account credentials. Account Attribute autoCloseTransactionTypes "Refund,Void" POS Payments Allows specific transaction types to close automatically so the point of sale application can proceed between payment screens appropriately. Account Attribute createSettlementWhenVoidingRefund "true" or "false" POS Payments Internally converts a void transaction created against a refund to a settlement request when sent to Adyen. This is only required if your implementation has a flow in which refund transactions can be voided, which is only a point of sale flow from the Manhattan Active perspective. The default option is false. Account Attribute uiIntegrationType "dropin" Pay By Link Customer Service This attribute is required to load Adyen's drop-in for hosted payment capture flows. Account Attribute allowedPaymentMethodsForPBL List of comma separated Adyen payment types, for example: "scheme,applepay,giftcard,paypal" Pay By Link This can be optionally configured to control which payment methods are allowed to be entered on the pay by link hosted payment page. Account Attribute tokenizeAmountForPBL "true" or "false" Pay By Link This attribute can be optionally configured to authorize the full balance due at the time of tokenization, instead of handling tokenization and initial authorization as seprate processes. The default option is false. Account Attribute OrgAgnostic "true" or "false" EOM Payments This attribute can be optionally configured to generate a webhook URL capable of saving event notifications to multiple organizations. The default option is false. CyberSource Gateway Configuration To use Cybersource, key gateway attributes need to be added to the payment gateway attribute table. Use the following JSONs to import a new gateway entry for Cybersource. { "GatewayId": "Cybersource", "IsBase": true, "GatewayEncryptedAttribute": [], "GatewayAttribute": [ { "Name": "TOKEN_END_POINT", "Value": "https//testsecureacceptance.cybersource.com/embedded/pay" }, { "Name": "TOKEN_REQ_GEN_URL", "Value": "/doms/dom/selling/payment/secureacceptance/cybs/CybersourceRequestGenerator.jsp" }, { "Name": "TOKEN_RES_GEN_URL", "Value": "/doms/dom/selling/payment/secureacceptance/cybs/CybersourceResponseReader.jsp" }, { "Name": "TOKEN_WINDOW_HEIGHT", "Value": "700" }, { "Name": "TOKEN_WINDOW_WIDTH", "Value": "770" }, { "Name": "TOKEN_USE_HTTPS", "Value": "false" } ], "Account": [ { "AccountId": "CyberSource_Account", "LocationId": null, "AccountEncryptedAttribute": [ { "Name": "merchantID", "Value": "AddValueHere" }, { "Name": "TOKEN_SECRET_KEY", "Value": "AddValueHere" }, { "Name": "TOKEN_ACCESS_KEY", "Value": "AddValueHere" }, { "Name": "TOKEN_PROFILE_ID", "Value": "AddValueHere" }, { "Name": "keyPassword", "Value": "AddValueHere" } ], "AccountAttribute": [ { "Name": "targetAPIVersion", "Value": "1.121" }, { "Name": "sendToProduction", "Value": "false" }, { "Name": "masterCardAuthReqType", "Value": "1" } ] } ] } PayPal Gateway Configuration Two modes are supported for PayPal: Signature and Certificate. To use either mode, attributes need to be added to the payment gateway attribute table. To use Certificate mode, the following attributes are required: username, password, and a stored certificate file. Use the following  json to import a new gateway entry using PayPal Certificate mode. { "GatewayId": "PayPal", "IsBase": true, "GatewayEncryptedAttribute": [], "GatewayAttribute": [], "Account": [ { "AccountId": "PayPal_Certificate_Account", "LocationId": null, "AccountEncryptedAttribute": [ { "Name": "targetAPIVersion", "Value": "124.0" }, { "Name": "gatewayMode", "Value": "test" } ], "AccountAttribute": [ { "Name": "merchantName", "Value": "AddMerchantValueHere" }, { "Name": "merchantPassword", "Value": "AddPasswordValueHere" }, { "Name": "CertificatePassword", "Value": "AddPasswordValueHereUsedToGenerateP12File" } ] } ] } To use Signature mode, the following attributes are required: username, password, and signature. Use the below json to import a new gateway entry using PayPal Signature mode. { "GatewayId": "PayPal", "IsBase": true, "GatewayEncryptedAttribute": [], "GatewayAttribute": [], "Account": [ { "AccountId": "PayPal_Signature_Account", "LocationId": null, "AccountEncryptedAttribute": [ { "Name": "targetAPIVersion", "Value": "124.0" }, { "Name": "gatewayMode", "Value": "test" } ], "AccountAttribute": [ { "Name": "merchantName", "Value": "AddMerchantValueHere" }, { "Name": "merchantPassword", "Value": "AddPasswordValueHere" }, { "Name": "merchantSignature", "Value": "AddSignatureValueHere" } ] } ] } Paypal integration is different from other third party integrations, as it is not XML or JSON-based. Instead, Active Omni communicates directly with the PayPal server. For security reasons, we cannot intercept the call that is made to PayPal and therefore cannot provide a mapping like we do for other third parties. Here are some PayPal mapping recommendations: Every imported PayPal order should have a closed paypal authorization transaction. Once the order is settled, the payment component will take care of creating a settlement transaction against the imported authorization. On order import, PaymentMethod.PaymentTransaction.RequestId needs to be mapped with the Auth ID from PayPal. A valid billing address is mandatory for the future settlement processing. Below is a sample from a payment method/transaction for imported PayPal authorizations: ..."Payment": [{ "PaymentMethod": [{ "AccountDisplayNumber": "PayPal", //account displayed in the UI. Account number is not mandatory "Amount": 160.2, "CurrencyCode": "USD", "CurrentSettledAmount": 0, "CurrentRefundAmount": 0, "GatewayId": "PayPal", "PaymentType": { "PaymentTypeId": "PayPal" }, "IsCopied": false, "IsModifiable": false, "IsSuspended": false, "IsVoided": false, // we need the billing address "BillingAddress": { "Address": { "Address1": "205 test Dr", "City": "Pittsburgh", "Country": "US", "FirstName": "Raymond", "LastName": "C", "Email": "rc@yopmail.com", "Phone": "0000000000", "PostalCode": "15235", "State": "PA" } }, "PaymentTransaction": [{ "IsActivation": false, "IsActive": true, "IsCopied": false, "IsValidForRefund": true, "OrderId": "<order ID>", //insert here your order id "ReconciliationId": "", "RequestId": "5GV95324Y1884932X", //this is and example of auth id from Paypal "ProcessedAmount": 160.2, "TransactionDate": "2020-03-26T13:31:41.000Z", "PaymentResponseStatus": { "PaymentResponseStatusId": "Success" }, "Status": { "PaymentTransactionStatusId": "Closed" }, "TransmissionStatus": { "PaymentTransmissionStatusId": "Closed" }, "TransactionType": { "PaymentTransactionTypeId": "Authorization" }, "RequestedAmount": 160.2 } ], "CurrentAuthAmount": 160.2 } ] } ],... PAYware Connect Gateway Configuration To use PAYware Connect, key gateway attributes need to be added to the payment gateway attribute table. Use the below JSON to import a new gateway entry. { "GatewayId": "PAYwareConnect", "IsBase": true, "GatewayAttribute":[ { "Name" : "URL", "Value" :"https://cert1.ipcharge.net/ipchapi/rh.aspx" }] } Uploading Certificate Files Many payment gateways require a stored certificate files which is used to authenticate calls made to the gateway. To upload a certificate or other type of authentication file for a gateway account, post the text file as an attachment to the endpoint: /payment/api/payment/gateway/{gatewayId}/account/{accountId}/upload When a file is uploaded, the Payment component stores the file in the Document Management component and creates two entries in the account attribute table: one entry with name ‘Certificate:DocumentId’ and value set to the document id generated by doc management, and another entry with name ‘Certificate:Filename’ and value set to the filename. After a file is uploaded, the file is broadcast so that the third party gateway receives the updated file. An optional request parameter ‘fileType’ can be provided, to include file types other than Certificate. By default, the account attributes are created with prefix ‘Certificate’. Any file type can be included in the request, and the file type value will be used as the account attribute prefix. Visa Mandate 2019 The Visa Mandate 2019 capabilities comply with the Visa Merchant-Initiated Transactions and Stored Credentials Mandates with CyberSource's Tokenization. The mandates provide more information to issuers and cardholders about merchant-initiated transactions and payment credentials that are stored by merchants or on behalf of merchants. With this mandate, all merchant-initiated transactions must link to a previously successful authorization along with a reason. To comply with this, Active® Omni: Identifies CyberSource Visa Credit Card authorization transactions as Advance Authorization, New Authorization or Re-Authorization Populates the attributes subsequentAuthFirst, subsequentAuth, subsequentAuthReason and subsequentAuthTransactionID in Visa Credit Card payment transactions Populates appropriateSequence number for settlement transactions using Visa Credit Card through CyberSource to recognize the first settlement transaction, subsequent settlement transaction and the last settlement transaction against an existing authorization. Enable the Visa Mandate 2019 functionality in the Payment Parameters UI using the 'Enable Visa Mandate 2019' attribute. This configuration is applicable only for payment transactions through CyberSource using Visa Credit Cards. If the Credit card is Visa, following attributes are populated: New Authorization: subsequentAuthFirst = true subsequentAuth = false subsequentAuthReason = null subsequentAuthTransactionID = null Reauthorization: subsequentAuthFirst= false subsequentAuth = true subsequentAuthReason = 3 subsequentAuthTransactionID = followOnId Advance Authorization: subsequentAuthFirst= true subsequentAuth = false subsequentAuthReason = 3 subsequentAuthTransactionID = null Standalone settlement (without authorization) Sequence number will not be populated Settlement on an existing authorization Sequence number will be populated in the payment transaction attributes Implementation Flavors How to add additional request fields to CyberSource Request Use the user exit(Paymentgateway:CyberSource:UserExit:EditCyberSourceRequest) to add additional request fields. Payment Gateways Requiring Same Transaction Request Id Across Transactions Transaction Request Id must be unique across payment transactions. If a payment provider requires the same reference value on every transaction, this value should be persisted as an extended attribute so as not to interfere with payment calculation and execution logic. Related Articles RefundsPayment TypesFraudPayment OverviewPayment Schedulers & Batch ProcessingSettlementHow Payment Processing WorksInvoicing and Sales PostingCapturing PaymenteInvoice AuthorizationRest APIs and User ExitsPayment Health DashboardOther Transaction TypesTesting & Troubleshooting PaymentPayment Failures