# Transactional Texts

**Permalink:** transactional-texts
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Customer Service/Transactional Texts
**Content Length:** 160,284 characters
**Scraped:** 2025-08-09T21:54:51.700136

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Customer Service ››Transactional Texts Transactional Texts OverviewSupported Text Messages & Licensing RequirementsHow are Texts GeneratedHow to Enable TextsEnable the Text Message for Your Use CaseThird Party Text Message Service Provider Account ConfigurationsShort Code for Transactional TextConfigure the Third Party URL Shortening AccountConfigure Alternative Selling ChannelsText Profile PurposesMapping RequirementsCustomer Opt-In StatusActive® Omni Text TemplatesOrder ConfirmationReady for PickupPickup ReminderFinal Pickup ReminderShipment ConfirmationPickup ConfirmationDelivery ConfirmationDelivery DelayOut for Delivery ConfirmationDelivery AttemptsShip it Instead ConfirmationShip It instead Due to Store ShortsOrder CancellationReturn ReceivedReturn ConfirmationPay by Link Text and Reminder Sample Refund by Link Text Sample Prevent Shipments on Payment Failure SampleCustomizing Text MessagesText User ExitsHow to add a Custom Text MessageHow to Customize Text TemplatesHow to Modify Text Message TemplatesFeature ScopeMessage Types and QueuesImplementation FlavorHow to integrate Manhattan Active Omni with a Twilio account to send Digital Self-Service links without using a Bitly accountTroubleshootingText messages are not delivered One of the Order Process/Order Event is failingOrder confirmation text messages are not getting deliveredText Message outbounds are not getting published from order    Text Message outbounds are getting published from order but don't see any entries for the same in Text Component Logs I don't see short URLs in the text message Short URLs in the Text Message are not functional  Pickup Reminder Texts are not getting generatedInvalid data for the field BusinessChannelIdHow to test Delivery Tracking Notifications without real tracking numbersOptIn value is not copied from the customer order to return order there by preventing text communication for return order configured notificationsRelated Articles Overview Throughout the order life cycle, customers need the latest information about their orders. One way of providing these real-time updates is via transactional text messages which are triggered on key milestones such as order confirmation, shipment or when items are ready for pickup. As the central repository for orders, Manhattan Active® Omni provides capabilities to trigger transactional texts at such key milestones. When an event such as a shipment occurs, Active Omni publishes an outbound message which can be consumed and used to generate a text. There are a few options for generating texts: Active Omni publishes an outbound message including the formatted text body (JSON) and includes any relevant short URLs linking to Digital Self-Service (e.g. the shipment tracking URL). A third party SMS service provider delivers the text to the customer and owns the infrastructure side - delivery tracking, retries, read receipts, error handling, and analytics. Active Omni publishes an outbound order message (JSON) which does not include the text body, and a third party SMS service provider takes this input message, constructs and formats the text, and delivers to the customer. The SMS service provider owns the infrastructure side - delivery tracking, retries, read receipts, error handling, and analytics. Supported Text Messages & Licensing Requirements The following table lists the text messages provided out of the box and indicates which capabilities require an Enterprise Order Management (EOM) subscription. In general, the licensing requirements follow the pattern of the underlying entities that need to be in place to enable these capabilities. Text Messages and Licensing Requirements Use Case Requires EOM License Order Confirmation No Shipment Confirmation No Delivery Confirmation No Ready for Pickup (BOPIS) No Pickup Reminder (BOPIS) No Final Pickup Reminder (BOPIS) No Out for Delivery Confirmation No Ship To Instead No Delivery Delay No Delivery Attempt No How are Texts Generated When key order events occur, the order component publishes two types of messages: Publish Order and Text Messages. The outbound Text Message is specially catered to outbound texts, as opposed to the Publish Order message, which includes all details of an order and can be more challenging for text systems to parse. For instance, the Text Message contains only the information needed to include in the text (e.g. total shipped quantity), while the Publish Order message contains the entire order. When the Publish Order or Text Message is published from the order component, a queue in the text component takes the input JSON, selects a matching Text Template, and forms a Text Message. This Text Message is then interfaced to a third party SMS service provider which delivers the actual text to the customer. Or, a custom queue takes the input JSON from either the order or text component and processes it further, depending on which implementation option is used. The below diagrams illustrate how texts are generated: Order Confirmation Text Message Ready For Pickup Text Message Shipment Confirmation Text Message Delivery Confirmation Text Process Out for Delivery Text Process Pickup Reminder Process Flow How to Enable Texts 1: Login with system admin 2: Add an outbound message type in the order component POST /order/api/ServiceDefinition/outBoundMessageType/save { "MessageType": "TextMessageServiceMSGType", "Transactional": true, "PersistMessageToMsgStore": false, "OutBoundQueues": { "QueueName": "queue.sendText" } } 3. Create Inbound Message to receive the outbound message created in step 1. POST: {{url}}/text/api/ServiceDefinition/inBoundMessageType/save { "MessageType":"TextMessageServiceMSGType", "NoOfConsumer":10, "Idempotent":true, "MinNoOfConsumer":1, "MaxNoOfConsumer":6, "MaxDesiredInstances":6, "ScaleUpTimeWindow":10, "ScaleDownTimeWindow":20, "Description":"Listener associated with this messageType will send the text to end-user.", "ServiceId":"TextService", "InBoundQueues":{ "QueueName":"queue.SendTextEvent" } } Step 4: Add an extension point to message type mapping in the order component POST /order/api/ServiceDefinition/extPointToMessageType/save { "ExtensionPointId": "Order:Order:Event:PublishText", "MessageType": "TextMessageServiceMSGType" } Step 5: Clear the extension point cache DELETE /order/api/framework/cache/clearCache/ExtensionPoint::DomainEntity::system Step 6: Enable the 'Text Message' service, so that outbound messages are triggered on the relevant events. Refer Enable the Text Message for Your Use Case for more details. Helpful tools for Text configuration via API:POST {{url}}/order/api/order/orderConfig/save How to enable order confirmation text message in order config via API { "ModTypeConfig": [ { "ModType": { "ModTypeId": "Order::Confirmed" }, "Status": "1000", "ConfigTextMessage": [ { "TextMessageId": { "TextMessageId": "OrderConfirmation" } } ] } ], "OrderConfigId": "EcommConfig" } How to enable ready for pickup text message in order config via API { "ModTypeConfig": [ { "ModType": { "ModTypeId": "QuantityDetail::QuantityStatus::Increase" }, "Status": "3600", "ConfigTextMessage": [ { "TextMessageId": { "TextMessageId": "ReadyForPickup" } } ] } ], "OrderConfigId": "EcommConfig" } How to enable shipment confirmation text message in order config via API { "ModTypeConfig": [ { "ModType": { "ModTypeId": "QuantityDetail::QuantityStatus::Increase" }, "Status": "7000", "ConfigTextMessage": [ { "TextMessageId": { "TextMessageId": "ShipmentConfirmation" } } ] } ], "OrderConfigId": "EcommConfig" } Step 7: If you're using a third party SMS Service Provider to take the input Text Message or Publish Order message and form text messages, then configure the required text message formation in the third party system and skip to step 8. Step 8: If using the component message to form text message, then ensure the below profile purposes are synced to the appropriate organizations. For example, if text templates will vary by country, then each country-level organization (e.g. Sophias-US and Sophias-MX) should have the profiles synced at this level. txt::processDefinition txt::messaging txt::txtConfig We have text templates available out of the box already with sample Text Message Body including links to the Self-Service UIs in form of Short URLs. Note: Be sure to login as system admin, if your text profiles are owned by system. Otherwise, log in at the level where your text templates are managed. First, get the existing template to have as a starting point GET {{url}}/text/api/text/textMsgTemplate?query="Name='<TemplateMsg>'" Example: GET {{url}}/text/api/text/textMsgTemplate?query="Name='CurbsidePickup'" Get the contents of the "MessageBody" tag and copy to your clipboard Modify the contents of "MessageBody" tag as required Save the Template with modified "MessageBody" with the updated json in the body for the below mentioned API POST {{url}}/text/api/text/textMsgTemplate/save Step 9: Now you're ready to test! Confirm and then ship an order, and you should get two text messages, one for order confirmation and another for order shipment confirmation. To test the ready for pickup text, confirm and pick and order, and you should receive a text. If you're not seeing any texts, verify if you have performed above steps properly and try again. Enable the Text Message for Your Use Case Text Message How to Configure Order Confirmation Navigate to Order Configuration UI > Modification Rules > Select the Order radio button > Enable 'Publish Text' for the 'Confirm Order' row Shipment Confirmation Navigate to Order Configuration UI > Modification Rules > Select the Quantity radio button > In the Publish Text column for Fulfilled status, select Text Message 'ShipmentConfirmation' Pickup Confirmation Navigate to Order Configuration UI > Modification Rules > Select the Quantity radio button > In the Publish Text column for Fulfilled status, select Text Message 'PickupConfirmation' Out for Delivery Navigate to Order Configuration UI > Modification Rules > Select the Order radio button > Enable "Publish Text" for the "Out for Delivery" row > In the Publish Text column select "Out for Delivery Notification" option. Note: Order Config has to be synced to view the "Out for Delivery" row. Refer here for more details on how the carrier response is processed for Delivered. Delivery Delay Navigate to Order Configuration UI > Modification Rules > Select the Order radio button in Modification rules and enable Publish Text for "Delivery Delay" row. Note : Order Config has to be synced in order to view the "Delivery Delay" row in UI. Refer here for more details on how the carrier response is processed for Delivered. Delivery Attempts Navigate to Order Configuration UI > Modification Rules > Select the Order radio button in Modification rules and enable Publish Text for "Delivery Attempts" row. Note : Order Config has to be synced in order to view the "Delivery Attempts" row in UI. Refer here for more details on how the carrier response is processed for Delivered. Ready for Pickup Navigate to Order Configuration UI > Modification Rules > Select the Quantity radio button > Enable 'Text Message 'ReadyForPickup' for Picked status Pickup Reminder/Final Pickup Reminder Enable "Ready for Pickup" message, then add Order Line Milestone Monitoring Rules for Milestone Definition Id:"OrderLine::Milestone::ReadyForPickup", Description": "Order line is Ready For PickUp" for the Event. Order Cancellation Navigate to Order Configuration UI > Modification Rules Select the Order radio button > Enable "Publish Text" for the "Cancellation confirmation for Item(s) cancelled" row > In the Publish Text column select "Cancel Order" option. Select the Order line radio button > Enable "Publish Text" for the Customer Initiated Cancel Line", "System Initiated Cancel Line' and System Initiated Decrease Quantity row > In the Publish Text column select "Cancellation confirmation for Item(s) cancelled". Carrier Scanned Navigate to Order Configuration UI > Modification Rules Select the Quantity radio button and select Text Message 'Return Carrier Scanned' for Carrier Scanned Quantity changes. Charge Back Navigate to Order Configuration UI > Modification Rules Select the Order radio button and select Text Message 'Return Charge Back Invoice" for the Add Chargeback row. This configuration triggers the 'Text Message' JSONs to be published outbound from the order component when relevant events occur. If any of the above text messages are selected for any other mod type or status other than the respective mod type mentioned above, the text will not work (but no error will be thrown). If using a third party text provider to take the input Text Message or Publish Order message and form text messages, configure the required text message formation in the third party system. Third Party Text Message Service Provider Account Configurations Manhattan's Active Omni's transactional text messages requires integration with a third party text message service provider to send SMS text messages generated for various transactional  text message service configured in the application. Out of the box Manhattan's Active Omni supports integration with Twilio as certified text message service provider. Refer to store customer engagement configuration - text-message-configuration instructions for configuring third party text message service providers. In addition to the above configuration - the below mentioned property has to be configured with a common phone number for sending order confirmation text messages. Property Name Example Description Mandatory Component Path order.sms.from.phone 14092481501 Phone number provided by the third party text message provider for sending Order Confirmation text messages. If each organization has a different phone number, configure this parameter with organization Id. For example:  order.sms.from.phone.sophias-us. The general parameter (without organization) is not required if phone numbers are configured for each organization. Yes Order CONFIG/COM-MANH-CP-ORDER/ preferOrgOverLocation True / False For text messages other than order confirmation, the From Phone Number has to be configured at every Location -> Detail -> Phone. If you want to use the phone number configured in the above property for all the transactional text messages, rather than configuring them on each of the Locations - set this property -  preferOrgOverLocation to true in KV Store. By default, it will be considered as false. No Order CONFIG/COM-MANH-CP-ORDER/ Short Code for Transactional Text Most of the SMS providers have started providing Short Code's (also called short numbers, Common Short Code, or CSC) messaging commonly used to send business text messages and marketing campaigns to a user's mobile device. A short code is a specialized five to six-digit phone number used in one-way SMS and MMS messaging. Currently, order text messages do not support using Short Code’s for sending transactional text messages. This change will support using Short Code’s for From Phone Number instead of using the standard 10 digit long phone numbers for sending order transactional text messages. Only one Short Code can be configured for all the transactional text messages generated from order and retailer will not be able to configure and use separate / different short codes for each location. By nature, short codes can be used only for one-way text messaging and cannot be used for interactive text messaging. Configure the below-mentioned KV store property for configuring Short Code for all the transactional text messages Property Name Example Description Mandatory Component Path order.sms.from.shortCode 140921 The short Code as provided by the third party text message provider for sending text messages. If each organization has a different short code, configure this parameter with organization Id. For example:  order.sms.from.phone.sophias-us. The general parameter (without organization) is not required if sort codes are configured for each organization. Yes Order CONFIG/COM-MANH-CP-ORDER/ If order.sms.from.shortCode  is populated, the system will consider that this configuration will override all other configurations and use the SHort Code populated in this property as From Phone Number for all the transactional text messages generated irrespective of any other configurations like preferOrgOverLocation or phone number configured for the locations/stored at Location -> Detail -> Phone While publishing the text message outbound from order populate - isFromPhoneShortCode = true Given below are some examples of how order.sms.from.phone is derived by the system depending on various configurations. Type Location Phone order.sms.from.phone order.sms.from.phone.<profileId> order.from.phone.preferOrgOverLocation order.sms.from.shortCode order.sms.from.shortCode.<profileId> FromPhone derived Order Confirmation 8888888888 9999999999 false 9999999999 All except Order Confirm 8888888888 9999999999 false 8888888888 Any 8888888888 9999999999 false 12345 12345 Any 8888888888 9999999999 true 12345 12345 Any 8888888888 9999999999 9999999999 true 12345 67891 67891 Any 8888888888 9999999999 9999999999 true 12345 12345 Any 8888888888 9999999999 9111111111 true 9111111111 Configure the Third Party URL Shortening Account Manhattan Active® Omni's transactional text messages include links to Digital Self-Service pages. These URLs are shortened for text messages via integration with a third party URL shortening service. Out of the box, Manhattan's Active® Omni supports integration with Bitly as certified Custom URL Shortener. . Enable the Shorten Self-Service URL check box on the Order Configuration UI > General tab. This can be enabled only if Publish Order, Publish Order Line, or Publish Text is enabled in the modification rules. Configure the URLs that are required to be shortened for each text message type by navigating to the Text Message Shortening Configuration UI. If a text message ID and URL combination does not exist in the menu, it can be added through the configuration. Text message IDs can be found using the API GET {url}/order/api/order/textMessage and text message URLs can be found using the API GET {url}/order/api/order/textMessageUrl. Once an account is procured with Bitly or any other third party URL shortener, the following configurations have to be enabled in the application. Create the below mentioned Key Value Properties in KV Store and enter the account details obtained from Bitly or other third party shortening service provider. Key Value Property Name Example Description Mandatory Component Path order.shortening.service bitly Name of the third party provider No Order CONFIG/COM-MANH-CP-ORDER/ order.shortening.url https://api-ssl.bitly.com/v4/shorten URL of the third party provider Yes Order CONFIG/COM-MANH-CP-ORDER/ order.shortening.access.token 691e17348ae1b49386ade32411583a9cd2633382 Access token for the third party provider Yes Order CONFIG/COM-MANH-CP-ORDER/ order.shortening.domain http://sophias Domain name used in short URLs as registered with the third party provider No Order CONFIG/COM-MANH-CP-ORDER/ order.selfServiceHostName https://omni-sophias.omni.manh.com Host name Yes Order CONFIG/COM-MANH-CP-ORDER/ All the above mentioned properties are profile based and if required they can be configured differently for each profile in the application as illustrated below. Profile based properties will take precedence over the application level properties. Profile based properties can be defined for all the above mentioned properties or a subset of them. In case profile based properties are not defined, application will look for application level properties. For example, if you have different domain names for each country, the domain property can be configured as mentioned below and rest of the other properties are configured as mentioned above at the application level. Key Value Property Name Example order.shortening.domain.ecomorg-us http://sophias.us order.shortening.domain.ecomorg-uk http://sophias.uk order.shortening.domain.ecomorg-fr http://sophias.fr If this configuration is not enabled any outbound messages configured for publishing Self-Service URL will not include short URLs. If this configuration is enabled, any errors encountered while calling the third party URL shortening service will result in the failure of respective Order Event or process. To call the third party URL shortening service requisite environment properties domainName, accesstoken & service-url must be configured. Note: The Shorten Self-Service URL parameter is validated first in the URL shortening process. If the parameter is not enabled, the Text Message Shortening Configuration is not evaluated, and URLs are not shorted, even if the configuration exists in the Text Message Shortening Configuration UI. Note: If we are using a base template, then the Order Configuration Shorten Selfservice URL should be enabled. Otherwise, modify the template with {Order.DSSLongUrl} instead of {Order.DSSUrl}. Configure Alternative Selling Channels It is possible to configure different selling channels for text messages. However, different selling channels beyond the provided seed data that implement texts also need to configure Business Channels in the text component. Business Channel Configuration POST {{url}}/text/api/text/businessChannel/save { "BusinessChannelId": "WEB-OUTLET", "Description": "Outlet Microsite orders" } Text Profile Purposes If using Active Omni to form the text message, then ensure the below profile purposes are synced to the appropriate organizations. For example, if text templates vary by country, then each country-level organization (e.g. Sophias-US and Sophias-MX) should have the profiles synced at this level. Be sure to login as system admin, if your text profiles are owned by system. Otherwise, log in at the level where your text templates are managed. txt::processDefinition txt::messaging txt::txtConfig Mapping Requirements Customer Opt-In Status Text Messages can be sent to customers only if they have opted in to receive Text Messages for various transactions. Usually, the SMS Service Provider verifies if the To Phone number to which the Text Message is being delivered is registered with them for receiving text messages or not. If the customer has opted out from receiving Text messages for a particular Phone Number, SMS Text messages are not delivered to that phone number. Manhattans Active Omni tracks the OptIn Status for a particular Interaction Type (TextMessage in this case) for a particular Phone Number (Customer Phone Number in the Order in this case). OptIn status and customer phone number should be populated on the order for text messages to generate. The Text Message outbound application verifies "OptIn" status for the customer phone number -- in country code -- before publishing the message. If "OptIn" status is not populated or is "OptOut", the message outbound will not be generated. Opt In Status must be populated on the order. If the customer OptIn Status is not populated on Customer or Return order create, the order component retrieves it from the customer component in the customer's comm preference where customer component for Interaction Type Id is "TextMessage" for the CustomerId on the order. If the CustomerId on the order is not found in customer master then it is recommended to update the OptIn value through other process for both Customer and Return Order in order to recieve notifications. Refer here on how to customize to achieve this. If the customer's opt-in status is updated on the customer record after it's already been populated on an order, there is no update automatically made to the order. Existing orders must be updated to reflect changes in the customer's preferences. New orders, however, will use the updated customer opt-in status. Any phone number formatting is removed before publishing outbound Text Message. Sample API's to save OptIn Status for a order:POST {{url}}/order/api/order/order/save { "CustomerCommPref": [ { "InteractionType": { "InteractionTypeId": "TextMessage" }, "OptInStatus": { "OptInStatusId": "OptIn" }, "PreferenceType": { "PreferenceTypeId": "All" }, "CountryCode": "+1" } ], "OrderId": "ECOM120059", } POST {{url}}/order/api/order/order/save { "CustomerCommPref": [ { "InteractionType": { "InteractionTypeId": "TextMessage" }, "OptInStatus": { "OptInStatusId": "OptOut" }, "PreferenceType": { "PreferenceTypeId": "All" }, "CountryCode": "+1" } ], "OrderId": "ECOM120059", } Active® Omni Text Templates If using Active® Omni to generate the Text body, then a Text template is used to define key attributes such as from phone number, to phone number, and the Text body. If using Active Omni to generate the Text message body, a Text template is used to define key attributes such as from phone number, to phone number, and the Text body. Sample starter text templates are provided for the below use cases. Order Confirmation This text template is used when an order is confirmed. Message Used Rule Condition - When this Text gets generated Self-Service Links Included Text Outbound Message Order isConfirmed is updated to true ChangeLog.ModTypes.Order contains Order::Confirmed None Order Confirmation Text Template { "TemplateMsgId": "OrderConfirmation", "Name": "OrderConfirmation", "Description": "Text message to inform the customer that order is confirmed", "MessagePrefix": null, "MessageSuffix": null, "MessageBody": "Hi ${Order.CustomerFirstName}! Congratulations, Your order for ${Order.NumberOfItems} item(s) for ${Order.Quantity} quantity(s) has been confirmed. Order No.: ${Order.OrderId}", "ConditionalExpression": "Order.IsConfirmed == true", "MessagePrefixInterval": 0, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" } } Ready for Pickup This text is generated when a buy online, pick up in store item is ready for pickup. When the store picks items (and they move to 'Picked' status on the order), the items are considered ready for pickup. Message Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information Quantity detail in picked status has increased ChangeLog.ModTypes.QuantityDetail contains QuantityDetail::QuantityStatus::Increase::3600 & delivery method is pick up in store or ship to store I'm on my way Pickup Later (extend Pickup Window) Add Pickup Person Curbside Pickup Text Template { "TemplateMsgId": "CurbsidePickup", "Name": "CurbsidePickup", "Description": "Text message to inform customer that items are ready for pickup at curbside", "MessagePrefix": null, "MessageSuffix": null, "MessageBody": "Hi ${Order.CustomerFirstName}! Your items are ready for pickup.<#if Order.DeliveryMethodSubType==\"Curbside\"> <#if Order.DSSOnMyWayUrl??> Please let us know when you are on your way and then follow the instructions: ${Order.DSSOnMyWayUrl}<#else> When you arrive at the store, stay in your vehicle and follow these instructions:<#if Order.DSSUrl??>${Order.DSSUrl}</#if></#if><#else>\"Come down to the store and pickup your order\"</#if>", "ConditionalExpression": "Order.DeliveryMethod contains \"PickUpAtStore\"", "MessagePrefixInterval": 0, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" } } Pickup Reminder This text message is generated when a customer has already received a 'ready for pickup' text, but their items are not yet picked up. Text Message Type Message Used Sections in Text Message Rule Condition - When this text gets generated Self-Service Links Included Pickup Reminder Text Outbound Message "IsFinalPickupReminder": false Order information Customer information Pick Up Notification Text is configured. Order Line Delivery Method is PickUp At Store  OR Ship To Store. Min Fulfillment Status Id >= 3600 AND < 7000. Appropriate Order Line Milestone Monitoring Rules are configured for Milestone Definition Id: "OrderLine::Milestone::ReadyForPickup"      Description": "Order line is Ready For PickUp" for the Event. I'm on my way (for Curbside Pickup) Pickup Later (extend Pickup Window) Ship It Instead (convert BOPIS order to Ship To Address order - included if the fulfillment is eligible for conversion) Add Pickup Person Only lines using the following delivery methods can use this text template: Pickup At Store Ship To Store The reminder text is generated based on the Order Line Milestone Time Rules and Monitoring Rules configured. The Text Message Outbound cannot be customized to include any other Order or order line attributes. Requires Pick Up Notification Text enabled to reference. Does not support a consolidated order event for status update (pickup) simultaneously for more than one store. Pickup Reminder Messages are not generated: For units that were reallocated after a short. If order line status moves to Picked-Up (7000) at any given point of time If Pickup Reminder messages are configured to be generated with reference to the Pickup Expiry Date, they will be reevaluated and retriggered if required if the Pickup Expiry Date is updated. To configure Pickup Reminder Texts: Configuring Pickup Reminders Order Line Milestone Rules have to be configured for generating Pickup Reminder Email Messages. Order Line Milestone Rules can be configured by UI or backed API's. For details on backed API's please refer Swagger documentation. Order Line Milestone Rules UI can be accessd from the Omnifacade Menu: {{url}}/omnifacade/#/OrderLineMilestoneRule Time Rules and Monitoring Rules have to be configured depending on the requirement for generating Pickup Reminder Email Messages for each pair of Delivery Method and Order Type. If the Order Line is a Gift (IsGift = ture) - different Order Line Milestone Rules can be configured for Gift order lines. Two separate Events are available for configuring Pickup Reminder and Final Pickup Reminder email messages as listed below. OrderLine:OrderLine:Event:ReadyForPickupReminder OrderLine:OrderLine:Event:FinalPickupReminder Custom events can be created and added to the entity orderLineEventDefinition using the below mentioned API so that they are available to be configured in the Order Line Milestone Monitoring Rules. However existing Events cannot be deleted or modified. POST {{url}}/order/api/order/orderLineEventDefinition Request Body: { "Description": "Custom Publish pickup reminder", "EventName": "OrderLine:OrderLine:Event:CustomReadyForPickupReminder" } Some sample Order Line Milestone Rules are given below for configuring Pickup Reminders for different use cases. Use Case #1: After the store associate picks the Items, from the date/time the lines moved to Picked status the customer is given a maximum of 7 days to come and pick-up the items from the store. On the 8th day if there is a no show the customer the retailer will move the items back to shelf. The retailer wants to send 2 Pickup Reminders and one final pickup reminder email as mentioned below. Pickup Reminder – 1: 1 day after the store associate picks the items Pickup Reminder – 2: 2 days after the store associate picks the items Final Pickup Reminder: 1 day before the back to shelf date (that is 6th day from the date/time items were picked by store associate) Order Line Milestone - Monitoring Rules RuleId MilestoneDefinitionId Type Duration EventName RaiseAlways Pickup Reminder - 1 OrderLine::Milestone::ReadyForPickup ACTUAL_TIME 86400 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Pickup Reminder - 2 OrderLine::Milestone::ReadyForPickup ACTUAL_TIME 172800 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Final Pickup Reminder OrderLine::Milestone::PickedUp EXPECTED_TIME -86400 OrderLine:OrderLine:Event:FinalPickupReminder FALSE Order Line Milestone - Time Rules RuleId MilestoneDefinitionId Type Duration DependentMilestoneId DependentStatusId TimeProperty Picked-up Expected Time OrderLine::Milestone::PickedUp AFTER_MILESTONE 604800 OrderLine::Milestone::ReadyForPickup Sample json for configuring the Order Line Milestone - Monitoring Rules for this use case is given below API: POST {{url}}/order/api/order/orderLineMilestoneRule/save { "RuleId": "ShipToStore-PickupReminders", "IsGift": false, "DeliveryMethodId": "ShipToStore", "OrderTypeId": "CallCenter Order", "OrderLineMonitoringRule": [ { "RuleId": "Pickup Reminder - 1", "MilestoneDefinitionId": "OrderLine::Milestone::ReadyForPickup", "Duration": 86400, "EventName": "OrderLine:OrderLine:Event:ReadyForPickupReminder", "RaiseAlways": false, "Type": "ACTUAL_TIME" }, { "RuleId": "Pickup Reminder - 2", "MilestoneDefinitionId": "OrderLine::Milestone::ReadyForPickup", "Duration": 172800, "EventName": "OrderLine:OrderLine:Event:ReadyForPickupReminder", "RaiseAlways": false, "Type": "ACTUAL_TIME" }, { "RuleId": "Final Pickup Reminder", "MilestoneDefinitionId": "OrderLine::Milestone::PickedUp", "Duration": -86400, "EventName": "OrderLine:OrderLine:Event:FinalPickupReminder", "RaiseAlways": false, "Type": "EXPECTED_TIME" } ], "OrderLineExpectedTimeRule": [ { "DependentMilestoneId": "OrderLine::Milestone::ReadyForPickup", "TimeProperty": null, "RuleId": "Picked-up Expected Time", "MilestoneDefinitionId": "OrderLine::Milestone::PickedUp", "Duration": 604800, "Type": "AFTER_MILESTONE", "DependentStatusId": null } ], "OrderLineMilestoneRuleShippingMethod": [] } Use Case #2: After the store associate picks the Items, from the date/time the lines moved to Picked status the customer is given a maximum of 4 days to come and pick-up the items from the store. On the 5th day if there is a no show the customer the retailer will move the items back to shelf. The retailer wants to send 2 Pickup Reminders and one final pickup reminder email as mentioned below. Pickup Reminder – 1: 1 day after the store associate picks the items Pickup Reminder – 2: 2 days after the store associate picks the items Final Pickup Reminder: 3 days after the store associate picks the items Order Line Milestone - Monitoring Rules RuleId MilestoneDefinitionId Type Duration EventName RaiseAlways Pickup Reminder - 1 OrderLine::Milestone::ReadyForPickup ACTUAL_TIME 86400 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Pickup Reminder - 2 OrderLine::Milestone::ReadyForPickup ACTUAL_TIME 172800 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Final Pickup Reminder OrderLine::Milestone::ReadyForPickup ACTUAL_TIME 259200 OrderLine:OrderLine:Event:FinalPickupReminder FALSE Use Case #3: After the store associate picks the Items, from the date/time the lines moved to Picked status the customer is given a maximum of 7 days to come and pick-up the items from the store. On the 8th day if there is a no show the customer the retailer will move the items back to shelf. The retailer wants to send 2 Pickup Reminders and one final pickup reminder email as mentioned below. Pickup Reminder – 1: 3 days before the back to shelf date (that is 4th day from the date/time items were picked by store associate) Pickup Reminder – 2: 2 days before the back to shelf date (that is 5th day from the date/time items were picked by store associate) Final Pickup Reminder: 1 day before the back to shelf date (that is 6th day from the date/time items were picked by store associate) Order Line Milestone - Monitoring Rules RuleId MilestoneDefinitionId Type Duration EventName RaiseAlways Pickup Reminder - 1 OrderLine::Milestone::PickedUp EXPECTED_TIME -86400 OrderLine:OrderLine:Event:FinalPickupReminder FALSE Pickup Reminder - 2 OrderLine::Milestone::PickedUp EXPECTED_TIME -172800 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Final Pickup Reminder OrderLine::Milestone::PickedUp EXPECTED_TIME -259200 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Order Line Milestone - Time Rules RuleId MilestoneDefinitionId Type Duration DependentMilestoneId DependentStatusId TimeProperty Picked-up Expected Time OrderLine::Milestone::PickedUp AFTER_MILESTONE 604800 OrderLine::Milestone::ReadyForPickup Use Case #4: While creating the order customer informs the retailer about the date on which he expects to pickup the order and this date is captured in Order Line Requested Delivery Date. After the store associate picks the Items, from the date/time the lines moved to Picked status the customer is expected to pickup the order by the date mentioned in the order line requested delivery date. One day after the requested delivery date if there is a no show by the customer to pickup the order the retailer will move the items back to shelf. The retailer wants to send 2 Pickup Reminders and one final pickup reminder email as mentioned below. Pickup Reminder – 1: 1 day after the store associate picks the items Pickup Reminder – 2: 2 days after the store associate picks the items Final Pickup Reminder: 1 day before the back to shelf date (that is requested delivery date + 1 day) Order Line Milestone - Monitoring Rules RuleId MilestoneDefinitionId Type Duration EventName RaiseAlways Pickup Reminder - 1 OrderLine::Milestone::ReadyForPickup ACTUAL_TIME 86400 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Pickup Reminder - 2 OrderLine::Milestone::ReadyForPickup ACTUAL_TIME 172800 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Final Pickup Reminder OrderLine::Milestone::PickedUp EXPECTED_TIME -86400 OrderLine:OrderLine:Event:FinalPickupReminder FALSE Order Line Milestone - Time Rules RuleId MilestoneDefinitionId Type Duration DependentMilestoneId DependentStatusId TimeProperty Picked-up Expected Time OrderLine::Milestone::PickedUp TIME_PROPERTY OrderLine::Milestone::ReadyForPickup RequestedDeliveryDate Use Case #5: Driving Pickup Reminders with reference to Fulfillment Pickup Expiry Date or Return To Shelf Date : When the pickup at store or ship to store order is released to the store and store associates picks the items to keep them ready for the customer to come and pickup a Pickup Expiry Date is assigned to the Fulfillment by which date the retailer expects the customer to come and pickup the items from the Store. This is the last date by which the customer can pickup the items, else the retailer is free to return the items back to shelf and cancel the pickup. The customer can  request the retailer to extend the pickup window by calling up the store or using a self service portal, in which case the Pickup Expiry Date is updated to a future date requested. Retailer can use this Pickup Expiry Date to drive the Pickup Reminder communications to the customer. Note: Pickup Expiry Date can be interfaced to Order Line Additional through Status Update order event for Picked Status (3600) from Fulfillment and any updates to Pickup Expiry Date in Fulfillment can be relayed back to order using Fulfillment Update order event. Please refer to Types of Order Events for details (Status Update Events and Fulfillment Update Event) The retailer wants to send 2 Pickup Reminders and one final pickup reminder email as mentioned below. Pickup Reminder – 1: 3 day's before the Pickup Expiry Date Pickup Reminder – 2: 2 day's before the Pickup Expiry Date Final Pickup Reminder: 1 day before the Pickup Expiry Date Order Line Milestone - Monitoring Rules RuleId MilestoneDefinitionId Type Duration EventName RaiseAlways Pickup Reminder - 1 OrderLine::Milestone::PickedUp EXPECTED_TIME -259200 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Pickup Reminder - 2 OrderLine::Milestone::PickedUp EXPECTED_TIME -172800 OrderLine:OrderLine:Event:ReadyForPickupReminder FALSE Final Pickup Reminder OrderLine::Milestone::PickedUp EXPECTED_TIME -86400 OrderLine:OrderLine:Event:FinalPickupReminder FALSE Order Line Milestone - Time Rules RuleId MilestoneDefinitionId Type Duration DependentMilestoneId DependentStatusId TimeProperty Picked-up Expected Time OrderLine::Milestone::PickedUp TIME_PROPERTY OrderLine::Milestone::ReadyForPickup PickupExpiryDate Sample Order Line Milestone configuration API: { "OrderLineMonitoringRule": [ { "RuleId": "Pickup Reminder - 1", "MilestoneDefinitionId": "OrderLine::Milestone::PickedUp", "Duration": -259200, "EventName": "OrderLine:OrderLine:Event:ReadyForPickupReminder", "RaiseAlways": false, "Type": "EXPECTED_TIME" }, { "RuleId": "Pickup Reminder - 2", "MilestoneDefinitionId": "OrderLine::Milestone::PickedUp", "Duration": -172800, "EventName": "OrderLine:OrderLine:Event:ReadyForPickupReminder", "RaiseAlways": false, "Type": "EXPECTED_TIME" }, { "RuleId": "Final Pickup Reminder", "MilestoneDefinitionId": "OrderLine::Milestone::PickedUp", "Duration": -86400, "EventName": "OrderLine:OrderLine:Event:FinalPickupReminder", "RaiseAlways": false, "Type": "EXPECTED_TIME" } ], "DeliveryMethodId": "PickUpAtStore", "RuleId": "PickUpAtStore-PickupReminders", "OrderLineExpectedTimeRule": [ { "DependentMilestoneId": "OrderLine::Milestone::ReadyForPickup", "TimeProperty": "PickupExpiryDate", "RuleId": "Picked-Up Expected Time", "MilestoneDefinitionId": "OrderLine::Milestone::PickedUp", "Duration": null, "Type": "TIME_PROPERTY", "DependentStatusId": null } ], "IsGift": false, "OrderTypeId": "CallCenter Order", "OrderLineMilestoneRuleShippingMethod": [] } Note: Create different set of Order Line Milestone Rules for PickUp AT Store and Ship To Store Delivery Methods for each order type For Ship To Store Delivery Method - Pickup Reminder will be generated only for the Pickup Leg and not for the Merge Leg These configurations do not verify if a Pickup Notification email messages was already published for the order line; they are entirely dependent on the Order Line Milestone Rules configurations Pickup Reminder messages will be generated only if the Events specified  for Pickup Reminder and Final Pickup Reminder are configured in the Order Line Milestone Rules Pickup Reminder messages will be consolidated for all the order lines for which the units were moved to Picked status for an order for Pick Up At Store delivery method, assuming all the order lines / releases are moved together to Picked status For Ship To Store Delivery Method – One set of Pickup Reminder messages will be generated for every transaction that moves the units to Picked Status and are not consolidated in to one set of Pickup Reminder messages per order like Pickup At Store lines Pickup Reminder messages will generated only if the Events specified  for Pickup Reminder and Final Pickup Reminder are configured in the Order Line Milestone Rules Scheduler is not required for processing order line milestones as it is taken care through delayed messages process. Configure the Text Message Template below Pick Up Reminder Text Template { "MessageSuffix": null, "Description": "Text message to remind the customer to pickup the order", "CreatedBy": "admin@ecomorg.com", "TemplateMsgId": "PickupReminder", "ConditionalExpression": "Order.IsFinalPickupReminder == false", "MessagePrefixInterval": 0, "Name": "PickupReminder", "MessagePrefix": null, "MessageSuffixInterval": 0, "SequenceNumber": null, "TextMessageType": { "TextMessageTypeId": "Transactional" }, "Unique_Identifier": "", "MessageBody": "Hi ${Order.CustomerFirstName}! Another gentle reminder that your items are ready for pickup<#if Order.LocationName??> at the '${Order.LocationName}'</#if>.<#if Order.DSSOnMyWayUrl??> If you are doing curbside pickup, please let us know when you are on your way and then follow the instructions: ${Order.DSSOnMyWayUrl}<#else> If you are doing a curbside pickup please follow these instructions ${(Order.DSSUrl)!\"'Come down to the store and pickup your order'\"}.</#if><#if Order.DSSExtendPickupWindowURL??> If you want to extend your pickup window please click on ${(Order.DSSExtendPickupWindowURL)!}</#if>" } Final Pickup Reminder This text message is generated when the final pickup reminder occurs in scenarios when customers have received a 'ready for pickup' text, but their items are not yet picked up. Text Message Type Message Used Sections in Text Message Rule Condition - When this text gets generated Self-Service Links Included Final Pickup Reminder Text Outbound Message "IsFinalPickupReminder":true Order information Customer information Ready for Pickup text is configured. Order Line Delivery Method is PickUp At Store OR Ship To Store. Min Fulfillment Status Id >= 3600 AND < 7000. Appropriate Order Line Milestone Time Rule are configured for Milestone Definition Id: "OrderLine::Milestone::PickedUp"  Description": "Order line is PickedUp". Appropriate Order Line Milestone Monitoring Rules are configured for Milestone Definition Id: "OrderLine::Milestone::PickedUp"  Description": "Order line is PickedUp". I'm on my way (for Curbside Pickup) Pickup Later (extend Pickup Window) Ship It Instead (convert BOPIS order to Ship To Address order - included if the fulfillment is eligible for conversion) Add Pickup Person Only lines using the following delivery methods can use this text template: Pickup At Store Ship To Store The reminder text is generated based on the Order Line Milestone Time Rules and Monitoring Rules configured. The Text Message Outbound cannot be customized to include any other Order or order line attributes. Requires Pick Up Notification Text enabled to reference. Does not support a consolidated order event for status update (pickup) simultaneously for more than one store. Final Pickup Reminder Messages are not generated: For units that were reallocated after a short. If order line status moves to Picked-Up (7000) at any given point of time If messages are configured to be generated with reference to the Pickup Expiry Date, they will be reevaluated and retriggered if required if the Pickup Expiry Date is updated. Final Pick Up Reminder { "MessageSuffix": null, "Description": "Text message to inform customer that this is the final Pickup Reminder", "CreatedBy": "admin@ecomorg.com", "TemplateMsgId": "FinalPickupReminder", "ConditionalExpression": "Order.IsFinalPickupReminder == true", "MessagePrefixInterval": 0, "Name": "FinalPickupReminder", "MessagePrefix": null, "MessageSuffixInterval": 0, "SequenceNumber": null, "TextMessageType": { "TextMessageTypeId": "Transactional" }, "Unique_Identifier": "", "MessageBody": "Hi ${Order.CustomerFirstName}! Today's the last day to pick up your order<#if Order.LocationName??> at the '${Order.LocationName}'</#if>.<#if Order.DSSOnMyWayUrl??> If you are doing curbside pickup, please let us know when you are on your way and then follow the instructions: ${Order.DSSOnMyWayUrl}<#else> If you are doing a curbside pickup please follow these instructions ${(Order.DSSUrl)!\"'Come down to the store and pickup your order'\"}.</#if><#if Order.DSSExtendPickupWindowURL??> If you want to extend your pickup window please click on ${(Order.DSSExtendPickupWindowURL)!}</#if>.<#if Order.DSSPickupConversionURL??> If you want us to ship it instead please click on ${(Order.DSSPickupConversionURL)!}</#if>" } Shipment Confirmation This Text template is used when lines with ship to address delivery method are shipped. One Text is generated each time a unit ships, so if an order ships in three shipments, then three Texts are generated. Message Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information Tracking detail section On the Way Items section (details of items being shipped in current shipment, grouped by unique PackageId) Quantity detail in fulfilled status has increased ChangeLog.ModTypes.QuantityDetail contains QuantityDetail::QuantityStatus::Increase::7000 Track Package Return Items Shipment Confirmation Text Template { "TemplateMsgId": "ShipmentConfirmation", "Name": "ShipmentConfirmation", "Description": "Text message to inform customer that items are shipped", "MessagePrefix": null, "MessageSuffix": null, "MessageBody": "Shipped: Hi ${Order.CustomerFirstName}, <#if (Order.Items?size > 0) && (Order.Items?size == 1) >${Order.Items[0]} item<#else>${Order.Items[0]} +${Order.Items?size-1} more item(s)</#if> has been shipped. Track at <#if Order.DSSUrl??>${Order.DSSUrl}<#else></#if>. If you want to return your item(s) then click here: <#if Order.DSSReturnUrl??>${Order.DSSReturnUrl}<#else></#if>", "ConditionalExpression": "Order.Status contains \"7000\"", "MessagePrefixInterval": 0, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" } } Pickup Confirmation This text is generated when a buy online, pick up in store item is picked up. When the customer picks up the items from the pickup store, the system will send a pickup confirmation text. Message Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information Items Picked Quantity detail in fulfilled status has increased ChangeLog.ModTypes.QuantityDetail contains QuantityDetail::QuantityStatus::Increase::7000 Track Package Return Items Pickup Confirmation Text Template { "TemplateMsgId": "PickupConfirmation", "Name": "PickupConfirmation", "Description": "Text message to inform customer that items are picked up", "MessagePrefix": null, "MessageSuffix": null, "MessageBody": "PickedUp: Hi ${Order.CustomerFirstName}, <#if (Order.Items?size > 0) && (Order.Items?size == 1) >${Order.Items[0]} item<#else>${Order.Items[0]} +${Order.Items?size-1} more item(s)</#if> has been picked up.", "ConditionalExpression": "Order.TextMessageType contains \"PickupConfirmationProcessing\"", "MessagePrefixInterval": 0, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" } } Delivery Confirmation This text template is used when lines with ship to address delivery method are delivered to the customer. One Text is generated each time a package is delivered. For example, if an order is shipped in three shipments and delivered one after another, then three Texts are generated Message Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information Tracking detail section Delivered Items section (details of items included in package delivered most recently) Quantity detail in delivered status has increased ChangeLog.ModTypes.QuantityDetail contains QuantityDetail::QuantityStatus::Increase::7500 Track Package Return Items Delivery Confirmation Text Template { "TemplateMsgId": "DeliveryConfirmation", "Name": "DeliveryConfirmation", "Description": "Text message to inform customer that items are delivered", "MessagePrefix": null, "MessageSuffix": null, "MessageBody": "Delivered: Hi ${Order.CustomerFirstName}, <#if (Order.Items?size > 0) && (Order.Items?size == 1) >${Order.Items[0]} item<#else>${Order.Items[0]} +${Order.Items?size-1} more item(s)</#if> has been delivered. Track at <#if Order.DSSUrl??>${Order.DSSUrl}<#else></#if>. If you want to return your item(s) then click here: <#if Order.DSSReturnUrl??>${Order.DSSReturnUrl}<#else></#if>", "ConditionalExpression": "Order.Status contains \"7500\"", "MessagePrefixInterval": 0, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" } } Delivery Delay This text template is used when lines with ship to address delivery method are delayed. One Text is generated each time a package is delayed. For example, if an order is shipped in three shipments and delayed one after another, then three Texts are generated. Mesage Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information Tracking detail section Delivery Delayed Items section (details of items included in package delivered most recently) Order.TrackingInfo.Tracking detail statusSubType in DeliveryDelay Order.TrackingInfo.EstimatedDeliveryDate is updated to future date Track Package Delivery Delay Text Message { "TemplateMsgId": "DeliveryDelayedTemplate", "Name": "DeliveryDelay", "Description": "Text message to inform customer that delivery is delayed.", "MessagePrefix": null, "MessageSuffix": null, "MessageBody": "Delivery Delayed: Hi ${Order.CustomerFirstName}, your shipment of <#if (Order.Items?size > 0) && (Order.Items?size == 1) >${Order.Items[0]} item<#else>${Order.Items[0]} +${Order.Items?size-1} more item(s)</#if> is delayed. Estimated delivery is ${Order.EstimatedDeliveryDate}. Track at <#if Order.DSSUrl??>${Order.DSSUrl}<#else></#if>", "ConditionalExpression": "Order.Status contains \"DeliveryDelay\"", "MessagePrefixInterval": 0, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" } Out for Delivery Confirmation This text template is used when lines with ship to address delivery method are out for delivery to the customer. One Text is generated each time a package is out for delivery. For example, if an order is shipped in three shipments and out for delivery one after another, then three Texts are generated. Message Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information Tracking detail section Out for Delivery Items section (details of items included in package delivered most recently) Order.TrackingInfo.Tracking detail statusSubType in OutForDelivery Order Mod Type Config: Out for Delivery : Publish Text "Out for Delivery Notification" Track Package Return Items Out For Delivery Text Template { "TemplateMsgId": "OutForDeliveryTemplate", "Name": "OutForDelivery", "Description": "Text message to inform customer that items are out for Delivery.", "MessagePrefix": null, "MessageSuffix": null, "MessageBody": "Out for Delivery: Hi ${Order.CustomerFirstName}, <#if (Order.Items?size > 0) && (Order.Items?size == 1) >${Order.Items[0]} item<#else>${Order.Items[0]} +${Order.Items?size-1} more item(s)</#if> is out for delivery. Track at <#if Order.DSSUrl??>${Order.DSSUrl}<#else></#if>. If you want to return your item(s) then click here: <#if Order.DSSReturnUrl??>${Order.DSSReturnUrl}<#else></#if>", "ConditionalExpression": "Order.Status contains \"OutForDelivery\"", "MessagePrefixInterval": 0, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" } } Delivery Attempts This text template is used when lines with ship to address delivery method are delayed. One Text is generated each time a package is delayed. For example, if an order is shipped in three shipments and delayed one after another, then three Texts are generated. Mesage Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information Tracking detail section Delivery Attempt Items section (details of items included in package delivered most recently) Order.TrackingInfo.Tracking detail statusSubType in DeliveryAttempt Track Package Delivery Attempt Text Message { "TemplateMsgId": "DeliveryAttemptedTemplate", "Name": "DeliveryAttempt", "Description": "Text message to inform customer that delivery is attempted.", "MessagePrefix": null, "MessageSuffix": null, "MessageBody": "Delivery Attempted: Hi ${Order.CustomerFirstName}, we attempted to deliver your package of <#if (Order.Items?size > 0) && (Order.Items?size == 1) >${Order.Items[0]} item<#else>${Order.Items[0]} +${Order.Items?size-1} more item(s)</#if> but unfortunately, we couldn’t. Track at <#if Order.DSSUrl??>${Order.DSSUrl}<#else></#if>", "ConditionalExpression": "Order.Status contains \"DeliveryAttempt\"", "MessagePrefixInterval": 0, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" } } Ship it Instead Confirmation This text message is generated when BOPIS items are successfully converted to a ship to address delivery method. Text Message Type Message Used Sections in Text Message Rule Condition - When this text gets generated Ship It Instead Confirmation Text Outbound Message Order information Customer information Order line delivery method is Ship To Address and the prior delivery method was Pickup At Store Min Fulfillment Status Id = 3600 Max Fulfillment Status Id = 3600 Ship It Instead Confirmation Text Template { "MessageSuffix": null, "Description": "Text message to inform customer that delivery method conversion is successful", "TemplateMsgId": "DMConversionConfirmation", "ConditionalExpression": "Order.PriorDeliveryMethod contains \"PickUpAtStore\"", "MessagePrefixInterval": 0, "Name": "DMConversionConfirmation", "MessagePrefix": null, "MessageSuffixInterval": 0, "SequenceNumber": null, "TextMessageType": { "TextMessageTypeId": "Transactional" }, "MessageBody": "Hi ${Order.CustomerFirstName}, this is a confirmation that we would be shipping your items to your address you have chosen." } ] } Ship It instead Due to Store Shorts This text message is generated when the shorted BOPIS order line is eligible for conversion to ship to address and needs customer consent for the conversion of delivery method. Text Message Type Message Used Sections in Text Message Rule Condition - When this text gets generated Customer Consent for Ship It Instead due to store shorts Text Outbound Message Order information Customer information OrderLine.RequestStatus = Open ; and OrderLine.CustomerRequestType = StoreShortConversion Ship It Instead due to store shorts Text Template { "TemplateMsgId": "StoreShortShipItInstead", "Name": "StoreShortShipItInstead", "Description": "Text message to customer providing them a link to convert their shorted BOPIS order to STA", "MessagePrefix": null, "MessageSuffix": null, "ConditionalExpression": "Order.RequestStatus contains \"Open\" && Order.CustomerRequestType contains \"StoreShortConversion\"", "MessagePrefixInterval": 0, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" }, "MessageBody": "Hi ${Order.CustomerFirstName}! We’re sorry - Your <#if (Order.Items?size > 0) && (Order.Items?size == 1) > ${Order.Items[0]} item<#else>${Order.Items[0]} +${Order.Items?size-1} more item(s)</#if> are not available for in-store pickup at the ${Order.LocationName} store.<#if Order.DSSPickupConversionURL??>If you want us to ship them to you instead, click here: ${(Order.DSSPickupConversionURL)!} Otherwise, we’ll cancel these items and you will not be charged.</#if>" } ] } Order Cancellation This text template is used when lines are cancelled on a customer order, either customer initiated or system initiated. One text is generated each time units are cancelled.  For example, if an order with three lines, each line is cancelled separately, then three texts are generated. In case of customer cancellation, the system determines a cancellation is customer-initiated if Cancellation Initiated By is 'Customer' for the cancel reason used on the order line. This text message is generated only if the cancel reason is configured as customer-initiated. In case of system cancellation, this text is generated when an order line is cancelled by the system due to unavailability of item(s) during allocation or due to short message received from fulfillment or cancellation scheduled for milestone  "AllocationDue" or "ReleaseDue". This text message is generated only if the cancel reason is configured as system-initiated. The system determines a cancellation is system-initiated if the Cancellation Initiated By is 'System' for the cancel reason used on the order line. MAO stamps below default cancel reasons in different scenarios. For a successful email generation in such case, the reasons should be defined and the Cancellation Initiated By should be 'System'. CancelUnallocatedUnits("CancelUnallocatedUnits") AllocationDue ("AllocationDue") ReleaseDue("ReleaseDue") Note: Customer Initiated partial qty cancellation notification is currently not supported. Message Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information Order isCancelled is updated to true ChangeLog.ModTypes.Order contains OrderLine::Cancelled::Customer ChangeLog.ModTypes.Order contains OrderLine::Cancelled::System ChangeLog.ModTypes.Order contains OrderLine::Quantity::Decrease::System N/A Order Cancellation Text Template{ "Messages": null, "ProfileId": "ecomorg", "MessageSuffix": null, "MessagePrefixInterval": 0, "MessagePrefix": null, "MessageSuffixInterval": 0, "Description": "Text message to inform the customer that order is cancelled", "TemplateMsgId": "OrderCancellation", "ConditionalExpression": "Order.IsCancelled == true", "Name": "OrderCancellation", "TextMessageType": { "TextMessageTypeId": "Transactional" }, "MessageBody": "Hi ${Order.CustomerFirstName}! Your order for ${Order.NumberOfItems} item(s) for ${Order.Quantity} quantity(s) has been cancelled. Order No.: ${Order.OrderId}" } Return Received This text template is used when return order lines have been received. One text is generated each time a receipt message is consumed. Mesage Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information All the lines in the return that are received are Return Lines with Receipt Expected = true ChangeLog.ModTypes.QuantityDetail contains QuantityDetail::QuantityStatus::Increase::18000 Delivery Method = Ship to Return Center Text message will NOT be triggered for store return delivery method. Return order lines are not on hold N/A Return Receipt Text Template{ "Messages": null, "ProfileId": "ecomorg", "MessageSuffix": null, "MessagePrefixInterval": 0, "MessagePrefix": null, "MessageSuffixInterval": 0, "Description": "Text message to inform the customer that return items have been received", "TemplateMsgId": "ReturnReceived", "ConditionalExpression": "Order.Status contains \"18000\"", "Name": "ReturnReceived", "TextMessageType": { "TextMessageTypeId": "Transactional" }, "MessageBody": "Hi ${Order.CustomerFirstName}! Your return for ${Order.NumberOfItems} item(s) for ${Order.Quantity} quantity(s) has been received. Return No.: ${Order.OrderId}" } Return Confirmation This text template is used when a return order has been confirmed. One text is generated each time a return is confirmed. This text message is limited to return orders and is not sent for exchange orders. Mesage Used Sections in Text Message Rule Condition - When this Text gets generated Self-Service Links Included (short URL) Text Outbound Message Order information Customer information Order isConfirmed is updated to true ChangeLog.ModTypes.Order contains Order::Confirmed Order is type Return MaxReturnStatus of the return order Awaiting Return (11000.000) N/A Return Confirmation Text Template{ "Name": "ReturnConfirmation", "MessageSuffix": null, "Description": "Text message to inform the customer that return order is confirmed", "TemplateMsgId": "ReturnConfirmation", "ConditionalExpression": "Order.IsReturnConfirmed == true", "MessagePrefixInterval": 0, "Process": null, "MessagePrefix": null, "MessageSuffixInterval": 0, "SequenceNumber": null, "TextMessageType": { "TextMessageTypeId": "Transactional" }, "MessageBody": "Hi ${Order.CustomerFirstName}! Your <#if (Order.NumberOfReturnItems > 0) && (Order.NumberOfExchangeItems == 0)>return ${Order.OrderId} for ${Order.NumberOfReturnItems} item(s) for ${Order.ReturnQuantity} qty <#elseif (Order.NumberOfReturnItems == 0) && (Order.NumberOfExchangeItems > 0)> exchange ${Order.OrderId} for ${Order.NumberOfExchangeItems} item(s) for ${Order.ExchangeQuantity} qty<#else>return ${Order.OrderId} for ${Order.NumberOfReturnItems} item(s) for ${Order.ReturnQuantity} qty and exchange for ${Order.NumberOfExchangeItems} item(s) for ${Order.ExchangeQuantity} qty</#if> has been confirmed.<#if Order.DSSReturnTrackUrl??> Track it here. ${Order.DSSReturnTrackUrl}</#if>" } Pay by Link Text and Reminder Sample Pay by Link text is generated when the contact center agent clicks the 'Send Text' button in the Pay by Link section, and a reminder text will be sent if the system has not received payment from the customer within the configured number of hours. Email Message Type Message Used Sections in Email Message Rule Condition - When this email gets generated Self-Service Links Included PayByLink Text Outbound Message IsPayByLinkReminder: false Order information When the CSR clicks 'Send Text', the customer receives a text with the link to add payment in Digital Self-Service. Digital Self-Service Pay By Link URL PayByLink    Reminder Text Outbound Message Order information If payment is not received within X hours (PayByLink reminder threshold), the customer will receive a reminder text to make payment for orders. Digital Self-Service Pay By Link URL Pay by Link Text Template { "Messages": null, "ProfileId": "ecomorg", "MessageSuffix": null, "UpdatedTimestamp": "2023-05-24T05:05:04.977", "Description": "Text message to send the Pay By Link to the customer.", "CreatedBy": "admin@ecomorg.com", "CreatedTimestamp": "2023-05-24T05:05:04.977", "TemplateMsgId": "PayByLink", "ConditionalExpression": "Order.TextMessageType contains \"PayByLink\"", "MessagePrefixInterval": 0, "Process": "/fwcore/seeddata/import", "Name": "PayByLink", "UpdatedBy": "admin@ecomorg.com", "MessagePrefix": null, "MessageSuffixInterval": 0, "SequenceNumber": null, "ContextId": "220a08cb-d801-4bbf-b566-d1b08733a252", "PK": "6849047049779742581", "TextMessageType": { "TextMessageTypeId": "Transactional" }, "Unique_Identifier": "6849047049779742581__PayByLink", "MessageBody": "Hi ${Order.CustomerFirstName}! Your order is almost complete. Please click the link to add payment: ${Order.DSSUrl}" } Pay by Link Reminder Text Template { "Messages": null, "ProfileId": "base", "MessageSuffix": null, "UpdatedTimestamp": "2023-06-08T05:49:15.985", "Description": "Text message to send the Pay By Link reminder to the customer.", "CreatedBy": "seeddata-importer", "CreatedTimestamp": "2023-06-08T05:49:15.985", "TemplateMsgId": "PayByLinkReminder", "ConditionalExpression": "Order.TextMessageType contains \"ReminderForPBL\"", "MessagePrefixInterval": 0, "Process": null, "Name": "PayByLinkReminder", "UpdatedBy": "seeddata-importer", "MessagePrefix": null, "MessageSuffixInterval": 0, "SequenceNumber": null, "ContextId": "f2626752-a8f4-44e4-968b-ecb2ab88c60a", "PK": "6862033559765805169", "TextMessageType": { "TextMessageTypeId": "Transactional" }, "Unique_Identifier": "6862033559765805169__PayByLinkReminder", "MessageBody": "Hi ${Order.CustomerFirstName}! We have not received payment for your order yet. Please click the link to add payment: ${Order.DSSUrl}" } Refund by Link Text Sample Refund by Link text is generated when the contact center agent clicks the 'Send Text' button in the Refund by Link section. Email Message Type Message Used Sections in Email Message Rule Condition - When this email gets generated Self-Service Links Included RefundByLinkForRefundProcessing Text Outbound Message Order information When the CSR clicks 'Send Text', the customer receives a text with the link to add new payment method for refund processing in Digital Self-Service. Digital Self-Service Refund By Link URL Refund by Link Text Template { "Description": "Text message to send the Refund By Link to the customer.", "TemplateMsgId": "RefundByLinkForRefundProcessing", "ConditionalExpression": "Order.TextMessageType contains \"RefundByLinkForRefundProcessing\"", "MessagePrefixInterval": 0, "Name": "RefundByLink", "MessagePrefix": null, "MessageSuffixInterval": 0, "SequenceNumber": null, "TextMessageType": { "TextMessageTypeId": "Transactional" }, "MessageBody": "Hi ${Order.CustomerFirstName}! Please input a new payment method to receive your refund for Order No.: ${Order.OrderId} by clicking on the link: ${Order.DSSUrl}" } Prevent Shipments on Payment Failure Sample A text is generated when a release is cancelled due to payment failure. Message Used Sections in Email Message Rule Condition - When this email gets generated Self-Service Links Included PaymentFailedOrder Text Outbound Message Order information Customer information Items Order Summary cancellationTrackerLineStatus / orderLineId / orderId status: Success cancelReasonId > Cancel Release on Payment Failure SelfServiceOrderHistoryUrl ##toggle-PaymentFailedOrderTextSample##38## Customizing Text Messages The diagram below illustrates how the text message flow can be customized at various stages. Customizing Text messages Text User Exits User exits can be implemented to customize the text process. For example, to add/remove attributes required by the URL shortening provider to the Text Message published outbound from the order component, implement the Order:Order:UserExit:PrePublishTextMessage extension point. Unlike transactional emails, the outbound text payload from the order component cannot be customized via response template and requires a user exit implementation if additional attributes are required. How to add a Custom Text Message If a new Text Message outbound is required in addition to the out of the box texts, then custom code must be implemented. Text Messages cannot be added via configuration, because these messages require logic to form a curated outbound message. To add a custom text message: Create a Text Message Outbound object Create a service with the required mod type and conditions to publish the Text Message (Note: Once one custom service/API is implemented, it can be used for multiple custom Text Message Types. In this service, use TextMessageId from the input to select a different method by Text message type.) Create a matching Text Template to generate the text. How to Customize Text Templates Sample text templates are available out of the box. These templates receive incoming order data and generate the final outbound text message. To view and modify these templates: Navigate to the Text Message Template Configuration UI Modify the text configuration The following can be configured in text templates: Conditional Expression: These filter conditions are evaluated against the incoming payload to select a template and generate the SMS text. For example, if a condition includes DeliveryMethod = ShipToAddress, then the outbound Text Message payload from the order component must include an order line with DeliveryMethod = ShipToAddress to select this template. Message Body: SMS body text Text Body HTML: defines the text body; can be customized per business requirements or for new themes. This uses a Freemarker template. Message Suffix, Message Suffix Interval, Message Prefix and Message Prefix Interval Description: description of the template configuration. Used for configuration management. To customize a Text template or add a new one, use a sample template and modify the desired attributes. Sample Text Message Template{ "MessageSuffix": null, "Description": "Text message to inform customer that items are ready for pickup at curbside", "TemplateMsgId": "CurbsidePickup", "ConditionalExpression": "Order.DeliveryMethod contains \"PickUpAtStore\"", "MessagePrefixInterval": 0, "Name": "CurbsidePickup", "MessagePrefix": null, "MessageSuffixInterval": 0, "TextMessageType": { "TextMessageTypeId": "Transactional" }, "MessageBody": "Hi ${Order.CustomerFirstName}! Your items are ready for pickup. When you arrive at the store, stay in your vehicle and follow these instructions: <#if Order.DSSUrl??>${Order.DSSUrl}<#else></#if>" } How to Modify Text Message Templates In the illustration below Ready For Pickup Text Message Template is modified to conditionally change the message body depending on the Delivery Method Sub type for the order line. Step#1: From Postman - GET {{url}}/text/api/text/textMsgTemplate?query="Name='CurbsidePickup'" Step#2: Copy Message Body from the Response json to Notepad "MessageBody": "Hi ${Order.CustomerFirstName}! Your items are ready for pickup. When you arrive at the store, stay in your vehicle and follow these instructions: <#if Order.DSSUrl??>${Order.DSSUrl}<#else></#if>" Step#3: Change it to include conditions to display the Message Body depending on whether it is Curbside Pickup or InStore Pickup: "MessageBody": "Hi ${Order.CustomerFirstName}! Your items are ready for pickup. <#if Order.DeliveryMethodSubType=\"Curbside\"> When you arrive at the store, stay in your vehicle and follow these instructions:<#if Order.DSSUrl??>${Order.DSSUrl}<#else></#if><#else>\"Come down to the store and pickup your order\"</#if>" Step#4: Replace it with the message body in the textMsgTemplate that you got in Step#1 above Step#5: From Postman - POST {{url}}/text/api/text/textMsgTemplate/save - paste json modified in Step#4 in the Body Feature Scope Restricting the hours text messages are sent to customers is not supported in Active Omni; this should be controlled via the third party text provider. For example, if a retailer wants to deliver text messages between 9 AM and 9 PM, this must be done by the text provider. Ship Confirmation Message Only lines using ship to address delivery method can use this text template Ship To Store, Pickup At Store, Store Sales, and Text delivery methods are not supported Backordered and canceled quantities are not published in ship confirmation text message Ready for Pickup Message Only lines using Pickup At Store or Ship To Store delivery method can use this text template The Text outbound message does not support consolidated order event for status update (pickup) simultaneously for more than one store Ship It Instead Confirmation Message Only when an "PickupAtStore" order (BOPIS) is successfully converted to "ShipToAddress" (Ship To Home) order and mod type OrderLine::UpdateBOPISToShipToAddress is triggered this text template can be used. Message Types and Queues Producer Component Message Type Type Queue Business Significance Consuming Component Order TextMessageServiceMSGType Outbound queue.sendTextEvent Text will not be generated if messages are not published or consumed from this queue component.message Text SendTextEventMSGType Inbound queue.sendTextEvent Text will not be generated if messages are not published to this queue Third party SMS Service provider Implementation Flavor How to integrate Manhattan Active Omni with a Twilio account to send Digital Self-Service links without using a Bitly account To send Digital Self-Service links without relying on a Bitly account, configure your Twilio account to act as the short URL service provider. You can use any supported URL shortening service by working with the services team to populate the following KV store key-value properties: order.shortening.service order.shortening.url order.shortening.access.token order.shortening.domain Order.selfServiceHostName Troubleshooting Text messages are not delivered Verify the status of the text messages sent to Twilio / third party text message providers in the logs in text component and see if any error code is populated. If so, try to rectify it. {{url}}/text/api/text/textMessage Text Component Log Check if the environment URL is configured in KV for below property text.server.base.url Ensure the below Message Type and Extension Point To Message Type exist. If they do not, create them: GET /order/api/ServiceDefinition/outBoundMessageType - look for MessageType": "TextMessageServiceMSGType" GET /order/api/ServiceDefinition/extPointToMessageType - look for "ExtensionPointId": "Order:Order:Event:PublishText" If they do not exist, create them: Login with system admin POST /order/api/ServiceDefinition/outBoundMessageType/save { "MessageType": "TextMessageServiceMSGType", "Transactional": true, "PersistMessageToMsgStore": false, "OutBoundQueues": { "QueueName": "queue.sendText" } } Add an extension point to message type mapping in the order component POST /order/api/ServiceDefinition/extPointToMessageType/save { "ExtensionPointId": "Order:Order:Event:PublishText", "MessageType": "TextMessageServiceMSGType" } If there are no errors found, ask services to help troubleshoot One of the Order Process/Order Event is failing Check if the Publish Text Message Service associated with a ModType has errors OR if Shorten URL is enabled, check if there are errors in the third party URL Shortener calls. If errors exist, you either need to rectify the errors or uncheck the URL Shortener from the respective Order Configuration temporarily until the exceptions with third party URL Shortener service provider calls are resolved. Order confirmation text messages are not getting delivered Check if you have configured appropriate From Phone Number in order.sms.from.phone KV property Text Message outbounds are not getting published from order Check if all outbound message types and extension points are configured properly as described above. Text Message outbounds are getting published from order but don't see any entries for the same in Text Component Logs Check if queue.publishText has consumers to consume the messages in Text Component Check if queue.sendText exists and if messages are getting queued up there. If yes, contact a third party text message provider and resolve the issue. I don't see short URLs in the text message Check if you have configured for shortening URLs in Order Config Check if you have properly configured requisite KV Store Properties for third party URL shortening provider/Bitly Short URLs in the Text Message are not functional Check if Long URL attribute populated in the text outbound message works Verify if you have configured KV Store property - order.selfServiceHostName - with the Host Name Pickup Reminder Texts are not getting generated Verify if Order Line Monitoring Rules are configured for the Delivery Method and Order Type Verify if appropriate Order Line Monitoring Rules are configured for the appropriate Miles Stone Id and Event Verify if the Order Line Milestones and Order Line Milestone Events are populated as per the configurations and Next Event Time is also populated accordingly. Invalid data for the field BusinessChannelId If your client uses any different selling channels beyond the provided seed data and is implementing texting, be sure to also configure these as Business Channels in the text component. Text messages for our custom selling channel will fail due to "Invalid data for the field BusinessChannelId" despite having configured the Selling Channel Id. POST {{url}}/text/api/text/businessChannel/save { "BusinessChannelId": "WEB-OUTLET", "Description": "Outlet Microsite orders" } How to test Delivery Tracking Notifications without real tracking numbers After the necessary configurations are done and if you wish to see if notifications are generated, you can simulate the carrier response and confirm if the notifications are generated. There is no need for real tracking numbers to test end to end feature. Refer here for more details on how to test text notification for delivery tracking w/o sample tracking numbers. OptIn value is not copied from the customer order to return order there by preventing text communication for return order configured notifications If the Customer Master record is not found for a given CustomerId or for any anonymous customer, the OptIn value should be populated by intercepting order save call if the order creation is from the call center or DSS. Related Articles UI ResourcesOrder Status InquiryItem SearchCall Center ConfigurationReturns and ExchangesCustomer Service Insights DashboardTroubleshooting Transactional EmailsCross-Organization VisibilityOverview and NavigationKits in Call CenterOrder Modifications