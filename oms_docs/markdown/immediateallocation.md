# Immediate Allocation

**Permalink:** immediateallocation
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Processing/Order Fulfillment/Order Allocation/Immediate 
**Content Length:** 44,075 characters
**Scraped:** 2025-08-09T21:57:09.205117

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Processing››Order Fulfillment››Order Allocation ››Immediate Allocation Immediate Allocation Previous I Next OverviewHow Does Allocation WorkEvaluate Promising StrategiesForm Promising RequestPromising ResponseAuto Cancel Back Order UnitsConfigurationConfiguring Immediate AllocationImplementation FlavorsIdentifying allocation changesUse custom allocation to override ShipFromLocationIdHow to populate extended attributes on allocation objectRelated Articles Overview Immediate Allocation is the process of allocating the Order immediately post create and update. This is the default behavior and can be controlled by the rule conditions and pipeline configuration. Refer to Order Pipeline for more details. Every time the allocation service is invoked in the Order component, the highest ranking Promising Strategy is determined based on the filter criteria in the Fulfillment Optimization UI. Order component then creates a Promising Request with the Promising Strategy Name (StrategyName and StrategyId) and Demand Type (from Order Configuration) and sends the Promising Request to Promising component. Inventory is then reserved (thereby updating the allocated quantity in Inventory Supply), and the promising response is sent back to the Order component. The response indicates the amount of inventory reserved along with other reservation details. Allocation records are then created on the order and the quantities are moved to "Allocated" status.  Allocation records are unique by order line and ship from location. If a quantity was submitted on the promising request, but the reservation information for that quantity was not returned on the promising response, it indicates that Promising was not able to reserve inventory for that quantity. These quantities are moved to "Back Ordered" status and no allocation is created for the quantity. Back Ordered quantities can be resubmitted for allocation when inventory becomes available. Refer How to set up Immediate Allocation - Sample for more details. How Does Allocation Work Below steps are common to all types of allocation (Immediate, Batch and Re-allocation). Evaluate Promising Strategies Before a Promising Request is sent to the promising component for an order, the order component determines the promising strategy. Promising strategies are configured in the Fulfillment Optimization Configuration UI, and each one contains a set of rules configured in the "Source" tab which indicate which orders should be allocated with that strategy. A retailer may configure multiple promising strategies in case different types of orders require different optimization factors, inventory sources, location priorities, or capacity rules. For example, if a rank is assigned to each promising strategy, the order component selects the highest ranking promising strategy with source rules that match the order's attributes. The order component then stamps the StrategyName and StrategyId in the promising request with PromisingConfigName and PromisingConfigId attributes, respectively. Additionally, the DemandType (based on the "Priority" rules), and SourceId (based on ATC view or location list) is stamped on the promising request. This source could be either a header source or a line level override source configured in the promising strategy. This informs the promising component to only consider inventory at the locations configured in that promising strategy source. If the order capture system is sending a promising request, the order capture system should evaluate the promising strategies and select the highest ranking strategy that matches the cart content. If a matching strategy is found, then the corresponding StrategyName or StrategyId should be stamped in the promising request using the PromisingConfigName and PromisingConfigId, respectively. If no StrategyName or StrategyId is given, then the reservation will be made against supply without optimization logic. Note: Only order header-level fields are evaluated in order to find a matching configuration. Line-level fields are not considered since the promising process attempts to find an optimized solution for the entire order. Line-level fields are considered later for line-level source overrides. The following diagram illustrates how the order component finds a matching promising configuration for the promising request (rule conditions define the types of orders that the configuration is intended for.) How is Fulfillment Optimization Config Evaluated? Form Promising Request A promising request is generated each time the allocation service is invoked in the Order component. The allocation service is invoked using the pipeline. When allocation is invoked, a fulfillment optimization configuration is selected for the order line based on the filter criteria. Once a configuration is selected, the Order component sends a promising request message to the Promising component. A promising request is formed based on the Order information and sent to the Promising component for further processing. Refer to How promising works for more details. Note: Extended attributes configured at OrderPromisingInfo/OrderLinePromisingInfo (Order) is passed over to PromisingRequest/PromisingRequestDetail The promising request contains key information for Promising. Refer to the below section for a sample Promising request and key attributes Promising request - Sample{ "Address": {}, "CarrierCode": "string", "ConsolidationLocationId": "string", "DeliveryMethodId": "string", "DemandType": "string", "ExistingReservations": [], "Extended": {}, "ExternalRouteId": "string", "IsConfirmed": false, "IsPartialRequest": false, "LastPossibleDeliveryDate": "2020-10-20T04:18:52.894Z", "OrganizationId": "string", "PromisingRequestDetail": [ { "ASNDetailId": "string", "ASNId": "string", "Address": {}, "CarrierCode": "string", "ConsolidationLocationId": "string", "DeliveryMethodId": "string", "DemandType": "string", "EffectiveRank": "string", "Extended": {}, "ExternalRouteId": "string", "FulfillmentGroupId": "string", "InventoryTypeId": "string", "IsForceAllocate": false, "ItemId": "string", "LastPossibleDeliveryDate": "2020-10-20T04:18:52.894Z", "PODetailId": "string", "POId": "string", "ParentItemId": "string", "ProductStatusId": "string", "PromisingRequestDetailId": "string", "Quantity": 0, "ReqCapacityPerUnit": 0, "RequestedDeliveryDate": "2020-10-20T04:18:52.894Z", "ServiceLevelCode": "string", "ShipFromLocationId": "string", "ShipToLocationId": "string", "ShippingMethodId": "string", "ShippingMethodIds": [ "string" ], "SourceId": "string", "StrategyType": "string", "Weight": 0 } ], "PromisingRequestId": "string", "RequestType": "string", "RequestedDeliveryDate": "2020-10-20T04:18:52.894Z", "ReservationExpiryDate": "2020-10-20T04:18:52.894Z", (Indicates the date on which the Reservation expires if the Order is not confirmed) "ServiceLevelCode": "string", "ShipFrom": { "Radius": 0, "RadiusUOM": "string", "Segments": [ "string" ], "ShipFromLocationIds": [ "string" ] }, "ShipToLocationId": "string", "ShippingMethodId": "string", "ShippingMethodIds": [ "string" ], "StrategyName": "string", (takes PromisingConfigName) "StrategyType": "string", "confirmed": true, "expiryDate": "2020-10-20T04:18:52.894Z" (Indicates the date on which the promising config expires) } Note : Demand Type is mandatory in the promising request. Attributes Description StrategyName When a matching promising strategy is found, the PromisingConfigName is sent on the Promising request in the StrategyName field StrategyId When a matching promising strategy is found, the PromisingConfigId is sent on the Promising request in the StrategyId field DemandType Demand type is used to represent a group of supply types which are eligible for allocation. In the Inventory component, each demand type is mapped to a list of supply types; this is the master configuration for demand types. For example, demand type "Allocation and Future" could be assigned supply types "On Hand", "In Transit", and "Future", while demand type "Allocation" could be assigned only "On Hand" supply type. A demand type is selected in the Order Configuration, and this demand type is included on the promising request. Promising receives the demand type and checks only inventory records which have supply types within that demand type. FulfillmentGroupId Fulfillment grouping enables the grouping of order lines that should be sourced, optimized, and reserved together. This is useful if certain order lines cannot be scheduled or optimized together. These groups are formed using the grouping IDs sent on each request detail. If a request contains multiple fulfillment groups, when the promising process is complete for all fulfillment groups, a reservation request is made for all lines. DeliveryMethodId Ship to Home Orders - A ship to home order includes an item which is delivered to a customer address. Ship to Store Orders - A ship to store order exists when an item is shipped to a store for customer pickup. This saves the customer the cost of shipping the order, and gives the retailer an opportunity to upsell other inventory. Pickup in Store Orders -  A pickup in store order is created when the item is present in a store and the customer reserves the item for pickup in store. For pickup orders, promising expects the Delivery method as 'PickUpInStore' in the promising request. OrderLinePromisingDetails Ship from Location Consolidation Location Strategy (Complete single source) Ship via details ExistingReservation section Once an order or group of line(s) in an order are allocated from a single source, there could be various modifications on order/order line - Increase or Decrease Line Quantity, Add Line, Update RDD for line/order, Update shipping address, Update Strategy type, and so on. Refer to Order Orchestration configuration for more details. If certain critical fields of an order that has already been reserved are updated, the order is sent to the Promising for re-promising(re-reservation). If a change occurs to an order or line that triggers reallocation, the order capture system sends a Promising request again to promising for reallocation. The following scenarios are potential candidates for critical change: Change to order line quantity Add a new order line Delete an order line Change shipping address, shipping method or RDD of order or line Change delivery method of order or line Change fulfillment group ID of an order Confirm an unconfirmed order During order update, order modification rules can be configured to try Reallocation for all units (even if it is allocated previously) or try allocation only for the open/back order units. In this case the existing reservations can be sent with the Existing Reservations Detail attribute, which enables Order to re-reserve part of an order without affecting other existing reservations. Common reasons that an existing reservation should not be affected include: The existing reservation is already released to the fulfillment system for processing. The existing reservation (or part of it) is already shipped. During peak season, a re-optimization of allocations is not needed, and whatever has been reserved should be kept undisturbed due to peak volume. Only the changes are sent for re-reservation. In all such cases, the reservations that should not be updated are sent in the existing reservation section, and only those that should be reserved are sent in the promising request detail. Refer to How promising works for details on how a promising request is processed within Promising. Promising Response Once Promising has reserved inventory, a message is sent back to the Order capture which includes all the required reservation/allocation information. Allocation records are then created from this response message and the quantities are moved to "Allocated" status.  Allocation records are unique by order line and ship from location. If a quantity was submitted on the promising request, but the reservation information for that quantity was not returned on the promising response, it indicates that Promising was not able to reserve inventory for that quantity. These quantities are moved to "Back ordered" status and no allocation is created for the quantity. Back ordered quantities can be resubmitted for allocation when inventory becomes available. Promising Response - Sample{ "ExistingReservationsDetailList": [], "OrganizationId": "string", "PromisingRequestDetailList": [ { "Allocation": [ { "ASNDetailId": "string", "ASNId": "string", "AllocatedOn": "2020-10-20T04:18:52.877Z", "EarliestDeliveryDate": "2020-10-20T04:18:52.877Z", "EarliestShipDate": "2020-10-20T04:18:52.877Z", "IsVirtualAllocation": false, "ItemId": "string", "LatestReleaseDate": "2020-10-20T04:18:52.877Z", "LatestShipDate": "2020-10-20T04:18:52.877Z", "PODetailId": "string", "POId": "string", "Quantity": 0, "ReservationRequestDetailId": "string", "ReservationRequestId": "string", "SchedulingInfo": [ { "DeliveryMethodId": "string", "DestinationLocationId": "string", "EarliestDeliveryDate": "2020-10-20T04:18:52.877Z", "EarliestShipDate": "2020-10-20T04:18:52.877Z", "LatestReleaseDate": "2020-10-20T04:18:52.877Z", "LatestShipbydate": "2020-10-20T04:18:52.877Z", "OriginLocationId": "string", "Sequence": 0, "SupplyDetailsInfo": [ { "EarliestDeliveryDate": "2020-10-20T04:18:52.877Z", "EarliestShipDate": "2020-10-20T04:18:52.877Z", "Eta": "2020-10-20T04:18:52.877Z", "IsForceAllocate": false, "IsOnHandSupply": false, "Quantity": 0, "SupplyTypeId": "string" } ] } ], "ServiceLevelCode": "string", "ShipFromLocationId": "string", "ShipToLocationId": "string", "ShipViaId": "string", "SubstitutionTypeId": "string", "SupplyDetailsInfo": [ { "EarliestDeliveryDate": "2020-10-20T04:18:52.877Z", "EarliestShipDate": "2020-10-20T04:18:52.877Z", "Eta": "2020-10-20T04:18:52.877Z", "IsForceAllocate": false, "IsOnHandSupply": false, "Quantity": 0, "SupplyTypeId": "string" } ], "UOM": "string" } ], "ItemId": "string", "ParentRequestDetailId": "string", "PromisingRequestDetailId": "string" } ], "PromisingRequestId": "string", "RequestType": "string" } Examples Scenario Inventory Available Units in Open Units Allocated Units Backordered Order placed with 2 quantities 2 0 2 0 Order placed with 5 quantities 3 0 3 2 Order placed with 1 quantity 0 0 0 1 Order placed with 4 quantities; matching allocation config not available. 4 4 0 0 Note: Future Supply (PO, ASN), Segment and Inventory Attributes on Allocation Allocated PO/ASN, Segments, Inventory attributes are not persisted under Allocation as this information is not sent from Inventory to Order as part of Promising response. This information is populated only when an Order is requested (Order Line promising section) to be allocated against PO/ASN/Segment/Inventory attributes. Auto Cancel Back Order Units When an order is processed for Allocation/Batch allocation/Reallocation, and some units don't get allocated successfully, such units are automatically canceled by the application instead of moving the units to backorder. Automatically canceling the backordered units results in the ordered quantities being updated to reduce them by the units that were not allocated successfully. If all the ordered units fail to get allocated, the ordered quantity will be updated to zero (0) and the order line will be canceled. If the canceled line is the only line in the order, the order will also be canceled. If Order Line or Order was canceled due to the Cancel Unallocated Quantity configuration - cancellation history will be created for the same with the reason id 'CancelUnallocatedUnits' and will be available in Order and Order Line Outbound Message as well as displayed on order audit information. This feature is applicable only for Retail Order (Document Type - Retail Order) and can be configured in Order Configuration - "Cancel Backorder Units". For other Order types (which cannot be auto canceled), quantities that do not get allocated are moved to Back Order, and then they can either be submitted for reallocation or canceled by configuring a job scheduler at regular intervals. Configuration Configuring Immediate Allocation By default, immediate allocation is enabled. Refer to the sample configurations required to process Immediate Allocation and Release Rule Condition: Rule condition needs to be modified to include only Customer Orders. Sample - { "RuleConditionId": "CUSTOMERORDER", "ConditionValue": "{\"expression\":{\"lhs\":{\"operandType\":\"attribute\",\"attribute\":\"order.docType.docTypeId\"},\"rhs\":{\"operandType\":\"constant\",\"value\":\"CustomerOrder\"},\"operator\":\"=\"}}" } Pipeline: Default pipeline (provided as part of seed) can be used if Immediate allocation and release needs to be triggered for customer order. { "ProcessTypeId":"ORDER_EXECUTION", "PipelineId":"ShipToHome", "Description":"Ship to home", "PickupService":[ { "FromStatus":"1000", "ComponentId":"Order", "ServiceId":"allocateOrder" }, { "FromStatus":"1500", "ComponentId":"Order", "ServiceId":"allocateOrder" }, { "FromStatus":"2000", "ComponentId":"Order", "ServiceId":"releaseOrder" }, ], "DropStatusDetermination":[ { "FromStatus":"1000", "ComponentId":"Order", "ServiceId":"allocateOrder", "IntendedDropStatus":"1500", "Sequence":1, "ConditionText":null, "DropStatus":"1500" }, { "FromStatus":"1000", "ComponentId":"Order", "ServiceId":"allocateOrder", "IntendedDropStatus":"2000", "Sequence":1, "ConditionText":null, "DropStatus":"2000" }, { "FromStatus":"1500", "ComponentId":"Order", "ServiceId":"allocateOrder", "IntendedDropStatus":"2000", "Sequence":1, "ConditionText":null, "DropStatus":"2000" }, { "FromStatus":"2000", "ComponentId":"Order", "ServiceId":"releaseOrder", "IntendedDropStatus":"3000", "Sequence":1, "ConditionText":null, "DropStatus":"3000" }, ] } Rule Action: Rule action is mapped to the Pipeline { "RuleActionId": "ORDER_PIPELINE_ACTION", "ActionDescription": "Order Pipeline Action", "ActionValue": "ShipToHome" } Rules: Rule condition and Rule Action is provided in the Rule. { "RuleId": "DELIVERYORDER_PIPELINE_RULE", "RuleGroupId": "DELIVERYORDER_PIPELINE_RULE_GROUP", "RuleDescription": "Delivery Order Pipeline Rule", "Component": "Order", "RuleStatus": "active", "RuleVersion": "1", "Salience": "0", "DisplaySequence": "1", "ActivationDate": null, "ExpirationDate": null, "RuleConditionId": "DELIVERYORDER_PIPELINE_CONDITION", "RuleActionId": "ORDER_PIPELINE_ACTION" } Implementation Flavors Identifying allocation changes Requirement: Update the external system whenever there is a change in allocation due to order line cancel or quantity update. Solution : 1. Save arrays of allocation details in a custom entity when units are allocated 2. Create a custom service which compares the quantity in each of the above mentioned custom entity array to the corresponding orderLine.Allocation array quantity 3. Call the service on order line cancellation and when order line quantity is decreased using mod types 4. Quantity decrease will move the quantity details to OPEN and trigger the allocation process. Allocation process will update the location after necessary changes are done on the underlying reservation. 5. Track allocation changes via Post allocation UE Use custom allocation to override ShipFromLocationId Requirement : If base allocation logic is not used, how to use custom allocation to override ShipFromLocationId Solution : If the requirement is not to use base allocation logic, then use the user exit Order:Order:UserExit:Promise and have the custom logic to derive new ShipFromLocationId. New ShipFromLocationId can be populated in PromisingRequest -> PromisingRequestDetail -> ShipFromLocationId How to populate extended attributes on allocation object Requirement : Populate extended attributes on allocation object Solution: Implement CustomServiceConfig in ModTypeConfig for QuantityDetail::QuantityStatus::Increase for 2000 status. Whenever a line is allocated, Quantity Detail will increase for 2000 status, and the CustomServiceConfig will be invoked. Here, populate the extended fields on Allocation object. Related Articles Mass AllocateREST APIs and User ExitsOverviewPrioritizationContinuous