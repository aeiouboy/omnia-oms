# Substitution During Fulfillment

**Permalink:** substitution-during-fulfillment
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Processing/Order Fulfillment/Order Events/Substitution During Fulfillment
**Content Length:** 108,872 characters
**Scraped:** 2025-08-09T21:57:39.903539

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Processing››Order Fulfillment››Order Events ››Substitution During Fulfillment Substitution During Fulfillment OverviewProcess FlowFeature ScopeFulfillment System ConstraintsGeneral Use Cases Where Substitution Is Not PossibleOrder Capture and ReleaseAvailable SubstitutionsOrder CaptureOrder ReleaseOrder Fulfillment Impact of Substitution on the Order and InventoryImpact of substitution on post release updatesOrder SellingImpact of Substitution on Order Total Computation and PricingImpact of Substitution on TaxesImpact of Substitution on Charges, Promotions, Appeasements and DiscountsImpact of Substitution on InvoiceOrder returns and exchangesImpact of substitution on return linesImpact of substitution on exchangesOrder visibilityImpact of substitution on outbound emailsImpact of substitution on customer service screensImpact of substitution on DSS screensHow TosHow to communicate customer substitution preferences to the fulfillment systemHow to declare that a substitution happened in the fulfillment systemSubstitution in StoresPrepare PickupsPickup SlipStage PickupsConfirm PickupsCurbside PickupsContact CustomerReprint Pickup SlipReturn to ShelfSame-Day DeliverySubstitution with SupersessionsConfigurationAllow substitution in storesConfigure reason to short substituted itemsAllow free form/wild card substitutionPerform inventory availability check during substitutionValidate substitute item's price for Specific Item and Best Available SubstitutionsValidate substitute item's price for Free Form Substitution (Substitute with any item)Troubleshoot Substitution Overview This type of substitution should not be confused with substitution during allocation. A fulfillment system may substitute an ordered item for a variety of reasons. One common reason is that the originally ordered item may be out of stock or unavailable at the time of fulfillment. In this case, the system may automatically substitute a similar item that is in stock to ensure customer satisfaction. Another reason for substitution could be due to quality control issues. If the fulfillment system detects that the ordered item may not meet quality standards or is damaged, it may replace it with a higher quality or undamaged item to ensure that the customer receives a satisfactory product. In all cases, the goal of a fulfillment system is to ensure most of the order is fulfilled in a way that is going to satisfy the customer, even if that means fulfilling a different item than the ordered item. Note: The item ordered by the customer is referred to as “the ordered item.” If a substitution occurs in the fulfillment process, the item provided in place of the ordered item is referred to as “the replacement item.” The item actually delivered to the customer is referred to as “the fulfilled item.” The fulfilled item can either be the ordered item (if there is no substitution) or the replacement item (if a substitution was made). Process Flow Process flow - substitution during fulfillment Feature Scope 1 to 1 Substitution If the customer orders 2 units of item A, the fulfillment system can fulfill: 2 units of item A (no substitution involved) 1 unit of item A, short the rest (no substitution involved) 2 units of item B 1 unit of item B, cancel the rest. Returns of replacement items or original items if there is a substitution is supported. Fulfillment System Constraints A few constraints are placed on the fulfillment system: If the release line flag "isSubsitutionRestricted" is set to true, no fulfillment system substitution will be accepted. The fulfillment system needs to communicate all the quantities substituted in 1 line in 1 order event. Once a line is partially substituted, the only outcome for the unsubstituted quantities is to be canceled via a short event. The short reason codes involved in substitution both of the ordered item and the replacement item should be configured to not reallocate the units. If they are configured to reallocate the units, the reallocation will be ignored and the shorted units will be canceled. General Use Cases Where Substitution Is Not Possible Substitution is forbidden in the following use cases. In all these use cases, the release line has the flag "isSubstitutionRestricted" set to true. It is expected that the fulfillment system is able to read that flag and prevent substitution on these lines. If the item is a kit If the order line is not released in one shot or if there is a split allocation, aka, if the release line quantity is different from the order line quantity If it is a merge leg If the order line is already invoiced If the order line has been substituted during allocation Order Capture and Release Available Substitutions Order Capture As far as order creation is concerned, the only additional information passed on the order is the customer preferences regarding substitution. The customer can choose to: Refuse substitution - In this case, the order line 'FulfillmentSubstitutionTypeId' should have the value 'DoNotSubstitute'. Allow substitution with the best available item - In this case, the order line 'FulfillmentSubstitutionTypeId' should have the value 'BestAvailable'. It is then up to the fulfillment sytem to determine what the replacement item will be. Choose what replacement items are acceptable - In this case, the order line 'FulfillmentSubstitutionTypeId' should have the value 'SpecificItem'. Also, the order capture system should pass the list of possible replacement items in the 'SubstitutionItemPreference' array. Each record should have: A 'SubstitutionItemPreferenceId' - Unique ID of the record. A 'SubstitutionSpecificItemId' - The possible replacement item. A 'SubstitutionUnitPrice' - Optional field to be used during re-pricing and invoicing if that item is indeed picked as the replacement item. If that value is null, the system will reprice using the configured ecom price for the replacement item. A 'Priority' - Optional field to be used in the fulfillment system to display a ranked list of possible replacement items See the Create Order page in the Developer portal for examples. Order Release To communicate the captured customer preferences to the fulfillment system, the release template has to explicitly call out these new fields. They are not stored on the release line and are fetched from the order line during release outbound publishing. Additionally, a system boolean flag "isSubstitutionRestricted" is present on the release line. If that flag is set to true at the moment of the release, it is expected that the fulfillment system prevents substitution. Any substitution attempted on a line where substitution is restricted will be rejected, and the order event will go to failed messages. Any custom release templates need to be updated to reflect the new attributes. Example of release outbound template with substitution preferences{ "BaseEntity": "Release", "TemplateId": "ReleaseOutboundFullTemplate", "TemplateJson": { "OrganizationId": null, "ExternalOrganizationId": null, "ReleaseId": null, "CreateReleaseTimeStamp": null, "EffectiveRank": null, "OverageAllowed": null, "ShipFromLocationId": null, "DigitalGoodsEmail": null, "ExternalShipFromLocationId": null, "ShipToLocationId": null, "ShipViaId": null, "ServiceLevelCode": null, "ModeId": null, "CreatedBy": null, "AddressType": null, "CustomerCommPref": { "OptInStatus": null, "PreferenceType": null, "CountryCode": null, "InteractionType": null }, "CarrierCode": null, "ReleaseType": null, "DeliveryMethod": null, "DeliveryMethodSubType": null, "DestinationAction": null, "OrderId": null, "AlternateOrderId": null, "MinFulfillmentStatusId": null, "MaxFulfillmentStatusId": null, "OrderTypeId": null, "DocTypeId": null, "IsReadyForTender": null, "SellingChannelId": null, "SellingLocationId": null, "Priority": null, "IsROPIS": null, "IsOnHold": null, "IsConfirmed": null, "IsCancelled": null, "CancelReasonId": null, "IsPostVoided": null, "PostVoIdReasonId": null, "CapturedDate": null, "CreateOrderTimeStamp": null, "ConfirmedDate": null, "IsTaxExempt": null, "TaxExemptId": null, "TaxExemptReasonId": null, "IsPublished": null, "CurrencyCode": null, "OrderTotalTaxes": null, "OrderTotalCharges": null, "OrderTotalDiscounts": null, "TotalTaxes": null, "TotalCharges": null, "TotalDiscounts": null, "OrderSubtotal": null, "OrderTotal": null, "PaymentStatusId": null, "CustomerId": null, "CustomerFirstName": null, "CustomerLastName": null, "CustomerPhone": null, "CustomerEmail": null, "CustomerType": null, "HasNotes": null, "OrderLocale": null, "HasAlerts": null, "InvoiceId": null, "NoOfStoreSaleLines": null, "NoOfDeliveryLines": null, "AddressId": null, "IsAddressVerified": null, "AVSReasonId": null, "AddressName": null, "FirstName": null, "LastName": null, "Address1": null, "Address2": null, "Address3": null, "City": null, "State": null, "PostalCode": null, "County": null, "Country": null, "Phone": null, "Email": null, "ReleaseTotal": null, "ExtendedFields": null, "ReleaseExtendedFields": null, "PickupExpiryDate": null, "TaxDetail": { "TaxDetailId": null, "TaxTypeId": null, "TaxCode": null, "TaxRequestTypeId": null, "TaxableAmount": null, "TaxAmount": null, "TaxRate": null, "Jurisdiction": null, "JurisdictionTypeId": null, "TaxDate": null, "TaxEngineId": null, "IsProrated": null, "IsInformational": null }, "ChargeDetail": { "ChargeDetailId": null, "TaxCode": null, "ChargeTypeId": null, "ChargeSubTypeId": null, "ChargeDisplayName": null, "ChargeTotal": null, "IsProrated": null, "IsInformational": null, "RelatedChargeDetailId": null, "RelatedChargeType": null }, "PaymentMethod": { "PaymentMethodId": null, "PaymentTypeId": null, "CurrencyCode": null, "AlternateCurrencyCode": null, "ConversionRate": null, "AlternateCurrencyAmount": null, "CardTypeId": null, "AccountDisplayNumber": null, "StatusId": null, "ChangeAmount": null, "OriginalAmount": null, "Amount": null, "CheckQuantity": null, "CurrentAuthAmount": null, "CurrentPreSettleAmount": null, "CurrentSettleAmount": null, "CurrentRefundAmount": null, "ChargeSequence": null, "IsSuspended": null, "IsVoided": null, "EntryTypeId": null, "GatewayId": null, "AccountTypeId": null, "RoutingDisplayNumber": null, "CheckNumber": null, "BusinessName": null, "IsFranked": null, "FrankedCheckQuantity": null, "BillingAddress": { "BillingAddressId": null, "FirstName": null, "LastName": null, "Address1": null, "Address2": null, "Address3": null, "City": null, "State": null, "PostalCode": null, "County": null, "CountryCode": null, "Phone": null, "Email": null } }, "Note": { "NoteId": null, "NoteCategory": null, "NoteType": null, "DisplaySequence": null, "NoteCode": null, "NoteText": null, "IsVisible": null, "Description": null }, "ProcessInfo": { "PK": null, "OrganizationId": null, "ParentOrder": null, "ShipLocationControl": null, "AdvertisingDate": null, "IsBackOrdered": null, "LPNCubingIndicator": null, "FedexDutyTaxPaymentType": null, "FedexDutyTaxAccountID": null, "RoutingAttributes": null, "RouteTo": null, "RouteType1": null, "RouteType2": null, "RouteWaveNumber": null, "BillOfLadingBreakAttribute": null, "CashOnDeliveryFund": null, "CustomerBrokerAccountNumber": null, "FTSRNumber": null, "GlobalLocationNumber": null, "ImporterDefinition": null, "InternalGoodsDescription": null, "PalletCubingIndicator": null, "IsCartonMinWeight": null, "PrimaryMaxicodeAddressNumber": null, "ScheduleDeliveryDate": null, "SecondryMaxicodeAddressNumber": null, "Language": null, "Priority": null, "AccountReceivableCode": null, "AdvertisingCode": null, "DestinationShipThroughLocation": null, "IsShipmentDocumentsOnly": null, "CustomerDepartment": null, "IsWarehouseTransfer": null, "DesignatedEquipmentId": null, "IsAutoConsolidationBlocked": null, "IsAutoCreateBlocked": null, "WaveId": null, "DesignatedShipVia": null, "ShipmmentPlanningScheduleDay": null, "ShipmentPlanningScheduleDay": null, "FreightForwardAccountNumber": null, "AccountReceivableAccountNumber": null, "InternationalGoodsDescription": null, "PlanningOriginFacilityId": null, "PlanningDestinationFacilityId": null, "MoveType": null, "MovementOption": null, "TransportationWaveOptionId": null, "DsgStaticRouteId": null, "DeclaredValue": null, "DeclaredValueCurrencyCode": null, "ExtendedFields": null }, "ReleaseLine": { "ReleaseLineId": null, "ItemId": null, "ParentItemId": null, "IsDiscountable": null, "Quantity": null, "UOM": null, "FulfilledQuantity": null, "CancelledQuantity": null, "ReleaseDependencyId": null, "OrderLineId": null, "AlternateOrderLineId": null, "MinFulfillmentStatusId": null, "MaxFulfillmentStatusId": null, "IsReturn": null, "LineTypeId": null, "SellingLocationId": null, "Priority": null, "IsGiftWithPurchase": null, "IsItemNotOnFile": null, "IsReturnable": null, "IsExchangeable": null, "IsGift": null, "IsGiftCard": null, "IsOnHold": null, "IsPreOrder": null, "IsPreSale": null, "StreetDate": null, "IsHazmat": null, "HazmatCode": null, "SmallImageURI": null, "IsPerishable": null, "IsCancelled": null, "CancelReasonId": null, "ParentOrderLineTypeId": null, "ParentOrderId": null, "ParentOrderLineId": null, "FulfillmentGroupId": null, "PaymentGroupId": null, "OrderLineTotalTaxes": null, "OrderLineTotalCharges": null, "OrderLineTotalDiscounts": null, "TotalTaxes": null, "TotalCharges": null, "TotalDiscounts": null, "OrderLineSubtotal": null, "OrderLineTotal": null, "ItemStyle": null, "ItemBrand": null, "ItemSize": null, "ItemColorDescription": null, "ItemSeason": null, "ItemDescription": null, "CanShipToAddress": null, "GiftCardValue": null, "UnitPrice": null, "RefundPrice": null, "OriginalUnitPrice": null, "IsTaxIncluded": null, "IsTaxOverridden": null, "TaxOverrideTypeId": null, "TaxOverrideValue": null, "IsTaxExempt": null, "TaxExemptId": null, "IsPriceOverrIdden": null, "DoNotShipBeforeDate": null, "IsPackAndHold": null, "RequestedDeliveryDate": null, "PromisedDeliveryDate": null, "LatestDeliveryDate": null, "DeliveryMethodId": null, "ShippingMethodId": null, "ShipViaId": null, "CarrierCode": null, "Mode": null, "ServiceLevelCode": null, "ShipToLocationId": null, "EffectiveRank": null, "AsnId": null, "ReleaseLineTotal": null, "ItemBarCode": null, "ItemWebURL": null, "ProductClass": null, "LastPossibleDeliveryDate": null, "IsReturnableAtStore": null, "ExtendedLineFields": null, "ReleaseLineExtendedFields": null, "LineShortCount": null, "TaxDetail": { "TaxDetailId": null, "TaxTypeId": null, "TaxCode": null, "TaxRequestTypeId": null, "TaxableAmount": null, "TaxAmount": null, "TaxRate": null, "Jurisdiction": null, "JurisdictionTypeId": null, "TaxDate": null, "TaxEngineId": null, "HeaderTaxDetailId": null, "IsInformational": null, "IsProrated": null }, "ChargeDetail": { "ChargeDetailId": null, "TaxCode": null, "ChargeTypeId": null, "ChargeSubTypeId": null, "ChargeDisplayName": null, "ChargeTotal": null, "HeaderChargeDetailId": null, "IsInformational": null, "RelatedChargeDetailId": null, "RelatedChargeType": null, "IsProrated": null }, "AllocationInfo": { "AllocationId": null, "SupplyTypeId": null, "POId": null, "PODetailId": null, "ASNId": null, "ASNDetailId": null, "CommittedShipDate": null, "CommittedDeliveryDate": null, "EarliestDeliveryDate": null, "EarliestShipDate": null, "HeuristicShipDate": null, "HeuristicDeliveryDate": null, "PredictedShipDate": null, "PredictedDeliveryDate": null, "LatestReleaseDate": null, "LatestShipDate": null, "SubstitutionRatio": null, "SubstitutionTypeId": null, "InventorySegmentId": null, "GroupId": null, "CountryOfOrigin": null, "BatchNumber": null, "ProductStatusId": null, "InventoryTypeId": null, "InventoryAttribute1": null, "InventoryAttribute2": null, "InventoryAttribute3": null, "InventoryAttribute4": null, "InventoryAttribute5": null, "ExtendedFields": null }, "PickupDetail": { "OrderLinePickupDetailId": null, "FirstName": null, "LastName": null, "Phone": null, "Email": null, "IsPrimary": null, "PreferredContactMethod": null, "PickupStartDate": null, "PickupEndDate": null }, "Note": { "NoteId": null, "NoteCategory": null, "NoteType": null, "DisplaySequence": null, "NoteCode": null, "NoteText": null, "IsVisible": null, "Description": null }, "ProcessInfo": { "PK": null, "OrganizationId": null, "ParentOrderLine": null, "CubeMultipleQty": null, "UnitWeight": null, "UnitVolume": null, "LPNBreakAttribute": null, "CriticalDimension1": null, "CriticalDimension2": null, "CriticalDimension3": null, "VASProcessType": null, "ItemPrice": null, "IsSerialNumberRequired": null, "BatchRequirementType": null, "PriceTicketType": null, "ExportInfoCode": null, "WaveProcessType": null, "ItemBreakAttribute": null, "PickTicketControlNumber": null, "PickUpReferenceNumber": null, "DeliveryReferenceNumber": null, "PickLocAssignmentType": null, "Price": null, "SingleUnit": null, "ExtendedFields": null }, "OrderLineVASInstructions": { "PK": null, "ParentOrderLine": { "PK": null }, "VasInstructions": null, "VasOptionId": null, "VasTypeId": null }, "OrderLine": { "OrderLineId": null, "OriginalItemId": null, "FulfillmentSubstitutionType": { "FulfillmentSubstitutionTypeId": null }, "SubstitutionItemPreference": { "SubstitutionItemPreferenceId": null, "SubstitutionSpecificItemId": null, "SubstitutionUnitPrice": null, "Priority": null } }, "IsSubstitutionRestricted": null } } } Order Fulfillment The changes highlighted in this section are only triggered if the Order event IsFulFillmentSubstituted boolean flag is set to true. This is done by default for MAStore app fulfilled orders. Impact of Substitution on the Order and Inventory When there is a substitution on an order line, the information is persisted on the order using an object called "Substitution Detail". This child of the order line is used for all order pricing related actions. It is also used to update the quantity detail of the order line. If the customer ordered 2 units of item A, before the substitution happens, the quantity detail of the order line includes 2 units of item A. Now, let's say that a substitution happened on pick and 2 units of item B were picked instead. The impact on the order and inventory is as follows: The order line quantity detail now includes 2 units of item B in status 3600 (Picked). The released quantity detail for item A is updated to 0 units. The order line substitution detail now includes a record of 2 units of item B with the unit price of Item B and all the other fields normally on the order line that refer to the item (is hazmat, color, brand, and so on...) Pricing, taxes and invoices are now computed using item B. See the Order selling section for more details. The availability quantity of Item A is increased by 2 units and will be error out. The availability quantity of Item B will be decreased by 2 units or will be zeroed out if sufficient inventory is not present for Item B. If instead of picking 2 units of Item B, only 1 unit was picked and 1 unit of A was shorted: 1 unit of A will be canceled independently of the configuration of the short reason code. This is due to the fact that reallocation of partially substituted line is currently out of scope. The order line quantity detail now includes 1 unit of B in picked status. The order line substitution detail includes a record for 1 item B. Pricing, taxes and invoices are now computed for 1 qty of B. The availability quantity of Item A is increased by 1 unit and will be error out. The availability quantity of Item B will be decreased by 1 unit or will be zeroed out if sufficient inventory is not present for Item B. Impact of substitution on post release updates Once an item has been substituted, it is no longer available for "ship it instead" functionality. Order Selling The changes highlighted in this section are only triggered if the Order event IsFulFillmentSubstituted boolean flag is set to true. This is done by default for MAStore app fulfilled orders. Concepts used in this section are explained in more detail in the Order Selling guide. Prerequisite: The mod type OrderLine:OrderLineItemSubstitution needs to be synced into the order configuration mod types. See the Mod Types page for more information. Impact of Substitution on Order Total Computation and Pricing When there is a substitution on an order line, the information is persisted on the order using an object called "Substitution Detail". The substitution details contain the item's unit price and quantity. The replacement item unit price is computed using the logic below: Use the unit price of the Substitution Item Preferences if the replacement item was passed on the order line at the moment of order capture. If the unit price of the substituted item preference is null, use the ecom price for that item in the price promo configuration (location ID is null). If the ecom price for the item in price promo is null, use the unit price of the ordered item. Once the replacement item unit price is saved on the order, the following fields are recomputed: Order line Sub total: The sub-total is now computed using the unit price and the quantity of the replacement item. Order line taxable amount: Based on the replacement item unit price Order line max appeasement amount: Based on the replacement item unit price Order line total: The order line total is now computed using the unit price and the quantity of the replacement item Order sub-total and order total: All the totals on the orders are now based on the replacement item unit price Note: If the price of the replacement item is higher than that of the original item and there is not enough money on the payment header, the order total will go to awaiting payment information. The expectation is then for a pay by link email to be generated to capture more payment or the difference to be written off. Impact of Substitution on Taxes Quotation tax is recomputed using the replacement item unit price and tax code. Once the quotation tax is recomputed, it is persisted on the order line tax details with a reference to the corresponding substitution detail. If the order is invoiced on the status where the substitution happens, a quotation tax call for the replacement item is done before the invoice process starts. Therefore, if using the minimum tax mode, the invoice tax and quotation tax compared both apply to the same replacement item. Impact of Substitution on Charges, Promotions, Appeasements and Discounts Charges and promotions are not re-evaluated in the case of substitution. If necessary, they are prorated using the new order line sub-total, but any promotion imported into the order due to the ordered item will still apply to the replacement item. Appeasements applied before substitution keeps the same amount after substitution. If the total of the appeasement is more than the replacement item order line sub-total, the appeasement amount will be adjusted to be the same as the order line sub-total. Impact of Substitution on Invoice If an item is substituted before it is invoiced, the customer will only pay for the replacement item. In that case, the invoice will contain only the items actually fulfilled (the replacement item if there is substitution). An item already invoiced cannot be substituted. If the invoice happens before the release, then the release line has the boolean flag "isRestrictedSubstitution" set to true. If the invoice happens after the release but before the substitution, the order event with the substitution details will be rejected.  For example, the customer orders Item A. Item A is released, picked and invoiced (assuming invoicing happens on pick status). If the ship event has a substitution for item B, it will be rejected and sent to failed messages. Order returns and exchanges Impact of substitution on return lines Once an order has been substituted, it is expected that the replacement item is returned. Impact of substitution on exchanges In the case of same style exchanges, because the system expects the price to be the same, by default the exchange is going to be done on the replacement item. If the customer wants to exchange with the originally ordered item, it will require an uneven exchange and possibly payment capture. Order visibility Impact of substitution on outbound emails After an item has been substituted, the outbound emails will contain the replacement item information or, at minima, an indication that the ordered item has been substituted. The following out of the box emails contain replacement item information. All other emails listing the items contain an indication that the ordered item has been ReadyForPickUpSample PickupReminder FinalPickupReminder Impact of substitution on customer service screens After an item has been substituted, the customer service screens display an indication that the ordered item has been substituted and , on hover, the replacement item information. Impact of substitution on DSS screens After an item has been substituted, the DSS screens display an indication that the ordered item has been substituted and , on hover, the replacement item information. How Tos How to communicate customer substitution preferences to the fulfillment system See Order capture and release How to declare that a substitution happened in the fulfillment system See the Integration guide about substitution in the fulfillment system in the developer portal for more details. In case the fulfillment system allows substitution of ordered items, status changes should reflect the substituted item as soon as the substitution occurs. If using the Manhattan Active Omni store application, substitution happens at picked status. Sample order event - picked with substitution{ "OrderEvent": [ { "EventTypeId": "StatusUpdate", "ReleaseId": "Release1", "ReleaseLineId": "1", "Item": "Item1", "StatusId": "3600", "Quantity": 1, "UOM": "EA", "IsFulFillmentSubstituted": true, "ShortReasonId": "4000.00",  //this is the short reason code applied to Item1 supply record "SubstitutionDetails": [ { "SubstitutionQuantity": 1, "SubstitutionItem": "Item2", "UOM": "EA" } ] } ] } Substitution in Stores In the event that a store associate is unable to fulfill an ordered item, they can substitute it with a like or closely resembling alternative if substitution is enabled in their respective store. A substitution can be performed if the store associate fails to find the ordered item in their store due to an incorrect enterprise inventory picture or if the ordered item is found but is not in a sellable condition, thereby reducing order cancellations, protecting store and retailer revenue, and improving customer service. Manhattan Active® Store Order Fulfillment supports substitution for the following orders: Buy online and pickup in store, Same-day delivery, and Reserve online and pickup in store orders, which are enabled in conjunction with a non-integrated Point of Sale application. Substitution is supported during picking. The following types of substitutions are supported. "Specific Item": The customer allows substitution and defines the items that they would like to be used as substitutes, in the event that their originally ordered item cannot be fulfilled, while placing their order. "Best Available": The customer allows substitution and permits the retailer to substitute their unfulfillable ordered item with its “best available” alternative. The list of eligible substitutes are retrieved at the time of fulfillment creation. Free form or wild card ("Substitute with any item"): It allows a store associate to use their discretion and substitute the unfulfillable ordered item with any item configured in the item master. It is available in two flavors: The customer allows “best available” substitution and the respective retailer wants to supplement it with free form substitution in the case that the configured substitution suggestions are also unfulfillable. The retailer’s selling channels do not capture the substitution type from their customers and the retailer wants to enable the stand-alone free form substitution in their stores nonetheless. Alternatively, the customers can deny substitution (“Do No Substitute") Note: Free form/wild card substitution is not allowed with “Specific Item” substitution. All types of substitution (see above) are required to adhere to these general principles: Only 1:1 substitution is allowed, i.e., one unit of the originally ordered item can be substituted by only one unit of a substitute item. One to many or many to one substitutions are not supported. A mix of the originally ordered item and a substitute item is not allowed for a fulfillment line. In other words, a line can only be: Fully picked using the originally ordered item Fully substituted using a substitute item Fully rejected Partially picked using the originally ordered item and the remaining units are rejected Partially substituted using a substitute item and the remaining units are rejected A mix of substitute items is not allowed for a fulfillment line, i.e., a line, if substituted, can be substituted by one and only one substitute item. Substitution has the following limitations: No offline support for the Substitute UI. No pause and resume on another device. Substitute UI scans are saved on the same device and can be resumed later while the current session is in progress. Late order cancellation is not supported with substitution. Consequently, from a store perspective, line level cancellation is not permitted in the Contact Customer UI for an order which involves one or more substituted lines. Ship It Instead is not permitted with substitution. As a result, from a store standpoint, store-initiated ship it instead is not allowed in the Contact Customer UI for an order whose one or more lines have been substituted. Reserve Online & Pickup in Store orders working in conjunction with the Manhattan Active® Point of Sale or an integrated external point of sale application do not support substitution. Team and RFID-based picking do not support substitution. Prepare Pickups Single order, multi-order, and pick to slot picking support substitution. To substitute during picking, store associates tap on the “SUBSTITUTE” button available in the picklist item details UI. On small form factor devices, they can also tap on the “SUBSTITUTE” button in the picklist line item swipe menu. In the case of single order picking, the “SUBSTITUTE” buttons are not displayed for the fulfillment lines for which the customer has refused substitution. For other substitution types, a “SUBSTITUTE” UI is displayed which displays the list of applicable substitution suggestions. Specific Item – A maximum of top ten highest priority valid substitute items defined by the customer while placing the order are displayed by default Best Available – A maximum of top ten highest sequenced valid substitute items configured in the highest ranked substitution rule for the ordered item are displayed by default. This list of substitutes / rules can either be defined in the MA Omni Substitution Rules or an external system. MA Store Order Fulfillment does not validate the substitute item prices by default. However, retailers can enable price validation if they want to allow substitution using only those items which are priced less than or equal to the ordered item. When price validation is enabled, in the case of specific item and best available substitutions, the configured substitutes' prices are validated and those items which are priced greater than the ordered item are not displayed in the substitution suggestions list in the "SUBSTITUTE" UI. Note: When price validation is enabled for specific item and best available substitutions, item prices should be configured for both the ordered item and the substitute items for price validation to happen. If an ordered item's price is unavailable, it becomes ineligible for substitution. On the other hand, if a substitute item's price is unavailable for validation, it is omitted from the substitution suggestions list. If none of the substitute items' prices are available, the respective fulfillment line becomes ineligible for substitution. Note: In the case of specific item and best available substitutions, if price validation is enabled, it is done at the time of creation of the fulfillment from the order release. A store associate can leverage the camera scan / barcode scan / manual input common UI component (available next to each substitution suggestion) capabilities built into the Substitute UI to substitute the ordered item. In the event that the item tag is damaged, the store associates can utilize the “Enter Barcode” option provided in the context menu to manually type in the substitute item’s item ID / one of the item codes / one of the manufacturing attributes. Additionally, if the free form substitution configuration is enabled and if the logged-in store associate has the required Store Fulfillment UI Resources assigned to their role, they can use the “Substitute With Any Item” option provided as part of the context menu to substitute the ordered item with any item configured in the item master based on their discretion and experience.  When price validation is enabled for free form substitution, MA Store Order Fulfillment validates the price of the item input by the store associate and if its price is greater than that of the ordered item, a validation error to this effect is displayed to the store associate and the input is rejected. Similar to the specific item and the best available substitutions, price validation is disabled by default for free form substitution. Note: For all forms of substitute price validation, MA Store Order Fulfillment leverages the highest ranked effective e-commerce (Location ID = null) item selling price. In the case of multi order or batch picking, the same item ordered by two or more customers is clubbed into a single picklist line item. If all the constituent fulfillment lines of a picklist line item do not permit substitution, then the “SUBSTITUTE” button is not displayed for this line item. However, if one or more fulfillment lines allow substitution, then when a store associate taps on the “SUBSTITUTE” button, the SUBSTITUTE UI shows up, once for each fulfillment which allows substitution, in the order of their fulfillment priority. In the case of specific item substitution, each instance of the SUBSTITUTE UI is loaded with the substitutes selected by the respective customer. MA Store Order Fulfillment is designed to minimize order cancellations by assuming that the ordered item, if available in limited quantity, is attributed to those fulfillments which do not allow substitution first and then the rest of the "completely unpicked" orders are fully substituted in the order of their fulfillment priority. However, if the substitute items are also available in limited quantities, then on submission of the picklist, the substituted fulfillments are honored as they are. The rest of the fulfillments belonging to this picklist line item are re-evaluated in terms of their priority; the originally ordered item units are assigned to the highest priority fulfillments and the remaining ones are shorted. Note: In line with the above behavior, if a fulfillment is assumed to be even partially picked using the originally ordered item, then it doesn’t show up in the Substitute UI. Based on configuration, MA Store Order Fulfillment can perform an inventory availability check on the substitution suggestions and items with zero availability are also displayed as suggestions. Retailers can enable the "On Hand Inventory Visibility" configuration to view the On Hand and the Available to Pick quantities for each substitution suggestion displayed in the Substitute UI. When this configuration is enabled, the availability is also displayed in the picking UIs along with the substitute UI. When pick to slot picking is enabled, the pre-assigned slot for the originally ordered item is displayed on the Substitute UI. Once the associate performs the substitution, the substituted item details and slot are displayed in a toast notification to the user. Irrespective of whether its single order, multi-order, or pick to slot picking, until the submission of the picklist, store associates can edit the substitute as many times as needed using the Substitute / Edit Substitute buttons available in the remaining and the completed filter results respectively. On the other hand, the increment / decrement common UI component, provided in the item details UI, can be used to edit the originally ordered item. In the case of multi-order picking, the picked quantity in the picklist as well as the item details always include both the originally ordered and the substituted units. However, the substituted units cannot be edited using the increment / decrement common UI component available in the item details UI. Substitution is re-enabled for a fulfilment if the originally ordered item is fully unpicked. As a corollary, the originally ordered item is allowed to be picked for a fulfilment only if its previously picked substituted units are fully unpicked. Once substitution is done, the store associate can tap on the “SUB & PICK NEXT” button to return to the remaining items on the picklist. They can tap on the “SKIP & PICK NEXT” button, as long as no items are scanned on the SUBSTITUTE UI, if they change their mind and choose to reject the item instead. A substitute item shows up with a red substituted indicator in the PICKLIST UI. Moreover, substituted items show up in red font instead of the usual font color. Pickup Slip When an item is substituted, it shows up as “Substitute item (substituted for ordered item)” in the Item column of the out of the box Pickup Slip. For example, if A is the originally ordered item, and it’s substituted by B, it's displayed as “B (substituted for A)”. All other details displayed in the Pickup Slip are those of the substitute item. Note: Manhattan Associates recommends that feature enablement teams ensure that the pickup slips which have been customized using the Fulfillment:Reports:UserExit:setReportInputParams user exit are working as expected after enabling substitution. They are requested to log a support ticket in the case they see any challenges with the slip. Stage Pickups The substitute item is displayed, in place of the ordered item, for the substituted fulfillment lines in the Stage Pickups UI. Such lines are also denoted by a red substituted indicator. Moreover, if the store associate taps on such a line, the item details UI also displays the substitute item details along with a substituted indicator. Similar to the normal picking scenarios, when the pick to slot picking is enabled, the slot information for the respective fulfillment is displayed in the Stage Pickups list, order details, and item details UIs. Confirm Pickups The substitute item is displayed, in place of the ordered item, for the substituted fulfillment lines in the Confirm Pickups Order Details UI. Such lines are also denoted by a red substituted indicator. Moreover, if the store associate taps on such a line, the item details UI also displays the substitute item details along with a substituted indicator. Cancelled and Picked Up orders also display the substitute item details along with a red substituted indicator in the Confirm Pickups Order Details UI. Curbside Pickups The substitute item is displayed, in place of the ordered item, for the substituted fulfillment lines in the Curbside Pickups Order Details UI. Such lines are also denoted by a red substituted indicator. Moreover, if the store associate taps on such a line, the item details UI also displays the substitute item details along with a substituted indicator. Contact Customer The substitute item is displayed, in place of the ordered item, for the substituted fulfillment lines in the Contact Customer Order Details UI. Such lines are also denoted by a red substituted indicator. Moreover, if the store associate taps on such a line, the item details UI also displays the substitute item details along with a substituted indicator. Additionally, the following capabilities are disabled in the Contact Customer for any fulfillment whose one or more lines have been substituted. Line cancellation using the swipe option. Ship Order button (Store-initiated Ship It Instead) Reprint Pickup Slip In the Reprint Pickup Slip UI, if a fulfillment involves substitution, store associates can search for the required fulfillment using the substitute item in addition to the originally ordered item. Moreover, the substitute item(s) is displayed in place of the ordered item(s) for the substituted line(s). A red substituted indicator is also shown for such lines. Additionally, if a store associate taps on a substituted fulfillment, the Reprint Pickup Slip Order Details UI also displays the substitute item details for the substituted line(s) along with a red substituted indicator. The reprinted pickup slip also displays the substitute item details for the substituted lines. Return to Shelf In the Return to Shelf “Confirm Items” and Order Details UIs, the substitute item details are displayed for the substituted lines in place of the originally ordered items. Same-Day Delivery When an item is substituted, it shows up as “Substitute item (substituted for ordered item)” in the Item value of the out-of-the-box Delivery Slip. For example, if A is the originally ordered item, and it’s substituted by B, it's displayed as “B (substituted for A)”. No unit price and subtotal are displayed for substitute items. Also, the order totals at the bottom of the slip are displayed as blank when an order involved substitution. Note: The Item value in the Delivery Slip needs to be limited to 45 characters, including the “substituted for” item details. Non adherence to this limit runs the risk of the item details spilling to the next column. Substitution with Supersessions Substitution with supersession is not supported. If the ordered item has supersession instances, the substitution action will be blocked. For example, if a customer orders item A and allows substitution with item B, and supersession items A1 and B1 also exist for Item A. If A has an A1 supersession item, the substitution option will be disabled in the user interface. If A is not a supersession item and the user scans B1, then B1 will not be allowed to scan with the error displayed as item not on picklist. Configuration Ensure that the profile purpose listed below has been copied from the base profile to your custom profile. Profile purposes to copy from base to custom profile ful::fulfillmentConfig Allow substitution in stores If this flag is set to true, it implies that the store supports substitution. Without enabling this flag, substitution cannot be supported. This configuration is available in the Location Fulfillment Attribute tab of the Locations configuration and is disabled by default. Configuration Name: Allows Substitution (applies to stores only) Additionally, the logged on store associate needs to have the required permissions assigned to one of their roles. Refer to this page for more details. Configure reason to short substituted items An implicit short is applied on the ordered item if it's substituted. It is done with the assumption that a store associate will not substitute an ordered item if it were available in a sellable condition. Configure the reason code to implicitly short a substituted item in this configuration. This configuration is available in the Detail tab of the Store Fulfillment Parameters. Configuration Name: Reason to short the items which are substituted Optionally, if custom reason codes are to be configured, follow these steps: Use the Manage Store Fulfillment Configuration → Store Fulfillment Reasons to add a new substitute short reason Enter the Fulfillment Reason ID, Fulfillment Reason Name, and Fulfillment Reason Description as needed Select the Fulfillment Reason Type ID as “SUBSTITUTE” Leave the Fulfillment Type ID as blank Save the reason Use the Manage Store Fulfillment Configuration → Store Fulfillment Parameters to configure the newly added short reason code as the reason code to short the substituted items In the Detail tab, go to the “Reason to short the items which are substituted” Select the newly configured reason Click on Save Use this documentation to configure the Fulfillment Reason ID configured in step 1 in the Inventory Reason Codes and Order Reasons configurations Allow free form/wild card substitution Free form or wild card substitution allows a store associate to substitute an ordered item with any item configured in the item master based on their discretion. Additionally, a store associate needs to have the required Store Fulfillment UI Resources assigned to their role to carry out free form substitution. This configuration is available in the Detail tab of the Store Fulfillment Parameters and is disabled by default. Configuration Name: Allow store associate to substitute with any configured item? Perform inventory availability check during substitution Refer to and enable the "On Hand Inventory Visibility" configuration if the available inventory of the substitution suggestions is to be shown to the store associates in the substitute UI. This configuration is disabled default. When enabled, it shows inventory availability in both the picking and the substitution UIs. Validate substitute item's price for Specific Item and Best Available Substitutions This flag controls whether store associates should only be allowed to substitute items whose price is less than or equal to the original item for specific item and best available substitutions. When enabled, any substitute items whose price is greater than the original item's price are suppressed from the list of possible substitutes shown to the associate. By default, this is disabled. This configuration is available in the Details tab of the Store Fulfillment Parameters UI and applies to Specific Item and Best Available Substitutions only. Configuration Name: Validate substitute item's price for Specific Item and Best Available Substitutions Validate substitute item's price for Free Form Substitution (Substitute with any item) This flag controls whether a store associate should only be allowed to substitute items whose price is less than or equal to the original item's price during free form substitution. When this flag is enabled, an error is displayed if the store associate attempts to substitute an item with a greater price. This configuration is available in the Details tab of the Store Fulfillment Parameters UI and applies to Free Form Substitution only. Configuration Name: Validate substitute item's price for Free Form Substitution (Substitute with any item) Additionally, there are substitution type specific requirements which are as follows: Specific Item: The “FulfillmentSubstitutionType” should be defined as “SpecificItem” for the respective Fulfillment Line. The list of customer preferred substitute items should be defined in the “SubstituteItemPreference” list for each Fulfillment Line, which allows specific item substitution. This list should comprise valid items configured in the Item master. For more details on how to define this list, refer to the Create Fulfillment interface mapping document. Note: If none of the top ten highest priority substitution item preferences are valid, substitution is not allowed for the respective fulfillment line. Best Available: The “FulfillmentSubstitutionType” should be defined as “BestAvailable” for the respective Fulfillment Line. In the event that the list of substitutes is maintained in the Manhattan Active® Omni, define a valid “DuringFulfillment” substitution type rule in the Substitution Rules for each item for which substitution is to be allowed. If the substitutes are maintained in an external system, implement the Item:Substitution:UserExit:GetSubstituteItems user exit. Either way, the substitute list should comprise valid items configured in the Item master. For more details on these use cases, refer to the Item component’s featured APIs documentation in the Manhattan Developer Portal. Note: If none of the top ten highest sequenced substitute items defined in the highest ranked substitution rule are valid, substitution is not allowed for the respective item. Note: Substitution suggestions in the MA Store app cannot be determined based on the rules which have rule conditions defined. Do Not Substitute: The “FulfillmentSubstitutionType” should be defined as “DoNotSubstitute” for an item for which the respective customer has refused permission to allow substitution. Free form or wild card (Substitute with any item): The “FulfillmentSubstitutionType” should be defined as “BestAvailable” or null for enabling free form substitution for the respective fulfillment line. Note: All of the above fulfillment substitution types can only be defined at the fulfillment line level and apply to all the units ordered as part of the line. They cannot be applied partially to only a few units within the line. Troubleshoot Substitution Trouble Troubleshooting Steps Unable to see the configuration related to Substitution Ensure that your organization’s active provisioning profile is synced. Unable to see the Substitute button for a given fulfillment line Order disallows substitution in certain cases. Check if the IsSubstitutionRestricted flag for the corresponding Release Line is true. If yes, substitution is not supported for this. Fulfillment creates such lines with the FulfillmentSubstitutionType as “DoNotSubstitute”. For more details on the order limitations, refer to this link. Fulfillment doesn’t allow substitution in certain cases. Make the following troubleshooting API call. GET /api/fulfillment/troubleshoot/substitution/fulfillmentId/{fulfillmentId} Response: { "success": true, "header": null, "data": { "Messages": null, "Feature Flags(should be enabled)": { "SIF-86970#2024-12": true, "SIF-82283#2024-09": true }, "FulfillmentDetails": { "Is Fulfillment BOPIS?": true, "Is Fulfillment SDD?": false, "FulfillmentLineDetails": [ { "Is Substitution Preferences List Empty?": true, "FulfillmentLineId": "1", "SubstitutionType (OM/External System)": null, "Allowed Substitution On UI": "FreeForm" }, { "Is Substitution Preferences List Empty?": true, "FulfillmentLineId": "2", "SubstitutionType (OM/External System)": null, "Allowed Substitution On UI": "FreeForm" } ], "FulfillmentId": "F72845259087" }, "Configurations": { "Is FreeForm Substitution enabled?": false, "Is Price validation enabled for Free form?": false, "Is Price validation enabled for non Free form?": false, "Does Location allow Substitution?": true, "Is Demand Type selected for inventory visibility?": true, "Is Internal POS enabled? (should be disabled)": false, "Is RFID enabled for picking? (should be disabled) ": false, "Is Split enabled? (should be disabled)": false, "Is Default Substitution Reason configured?": true } }, "messageKey": null, "message": null, "errors": [], "exceptions": [], "messages": { "Message": [], "Size": 0 }, "rootCause": null, "cloudComponent": "com-manh-cp-fulfillment-1", "cloudComponentHostName": "com-manh-cp-fulfillment-758468cbd-mjltk", "requestUri": null, "statusCode": "OK" } Interpretation of this API’s response: Location should allow substitution. If “Does Location allow Substitution?” value is false, then substitution is not supported. If substitution is to be enabled, go to the Locations → Location Fulfillment Attribute → Allows Substitution and set it as true. Team picking is not supported. If the “Is split enabled?” value is true, substitution is not allowed. RFID-based picking is not supported. If the “Is RFID enabled for picking?” value is true, substitution is not allowed. Substitution is not permitted for a ROPIS order with MA Point of Sale or an integrated external point of sale. If the "Is Internal POS enabled? (should be disabled)" value is true, substitution cannot happen for ROPIS orders. Substitution is only supported for pickup at store and same-day delivery orders. If both the “Is Fulfillment BOPIS?” and “Is Fulfillment SDD?” are false, then substitution is not permitted. If substitution is to be supported for a fulfillment line, the “SubstitutionType (OM/External System)” value should be either “SpecificItem” or “BestAvailable”. Substitution is not allowed for a fulfillment line whose “SubstitutionType (OM/External System)” value is “DoNotSubstitute”. Additionally, for a “SpecificItem” substitution, the list of the customer's preferred substitutes comes on the “SubstitutionItemPreference” list from the selling channel. This list should not be empty and should contain items configured in the item master. If the “Is Substitution Preferences List Empty?” value is true, then substitution cannot be supported. On the other hand, for a “BestAvailable” substitution, the list of the retailer's preferred substitutes comes on the “SubstitutionItemPreference” list from either the MA Omni Substitution Rules or an external system. If the ordered item is not configured in the MA Omni Substitution Rules / the external system or if the configured list of substitutes are invalid items, i.e., not configured in the item master, the “Is Substitution Preferences List Empty?” value is true, and substitution cannot be allowed for this fulfillment line. The free form / wild card “Substitute With Any Item?” option is displayed in the context menu of the Substitute UI only if the required configuration is enabled. If the “Is FreeForm Substitution enabled?” value is false, then the “Substitute With Any Item” is not shown. Enable the “Store Fulfillment Parameters → Allow store associate to substitute with any item?” configuration to enable this capability. Price validation is performed in the Substitute UI only if the required configurations are enabled; price validation is disabled by default. When these configurations are enabled, substitution is allowed only using an item which is less than or equal to the price of the ordered item. Is Price validation enabled for Free form?: false value indicates that price validation is disabled for the free form substitution. To enable it, set the "Store Fulfillment Parameters --> Validate substitute item's price for Free Form Substitution (Substitute with any item)" configuration to true. Is Price validation enabled for non Free form?: false value indicates that price validation is disabled for the specific item and best available substitutions. To enable it, set the "Store Fulfillment Parameters --> Validate substitute item's price for Specific Item and Best Available Substitutions" configuration to true. Based on all these details, the substitution enablement is evaluated for each line of the given fulfillment. This is denoted by the "Allowed Substitution on UI" field calculated at the line level. If the "Allowed Substitution on UI" value is: "None" – No kind of substitution is allowed. "Basic" – Only substitution from the provided substitution suggestions is allowed. "FreeForm" – Only free form / wild card (Substitute with any item) substitution is allowed. "All" – Both the substitution from the substitution suggestions list and the free form substitution are allowed. If the "Is Default Substitution Reason configured?” is false, then the Order and Inventory updates may not go through appropriately. Configure the appropriate reason using the “Store Fulfillment Parameters → Reason to short the items which are substituted” configuration. Inventory availability for the substitution suggestions is not shown by default. If it has to be displayed, the required configuration needs to be enabled. If the "Is Demand Type selected for inventory visibility?" value is false, inventory availability is not shown. Go to the Store Fulfillment Parameters and change the "Select demand type to see the on-hand inventory and available inventory on picklist" drop down list's value to an appropriate value to view the inventory availability on the substitution suggestions list. If all the above criteria are found to be in order, then check if the logged-in user has the permissions required to substitute. Check the Store Fulfillment UI Resources for the list of permissions needed to be assigned to the user’s role. Reach out to Manhattan Associates if the issue persists even after evaluating and taking corrective action on the above criteria. You’ve scanned an item ineligible for substitution In the Substitute UI, you can only scan the items which are listed in the substitution suggestions list. Scan the right item if an incorrect one has been scanned inadvertently. Only one substitute is allowed. A mix of substitute items is not permitted. Scan the previously scanned item if another one has been scanned inadvertently. Substitute cannot be picked with the ordered item. A mix of the originally ordered and a substitute item is not allowed. Unpick the originally ordered item completely if substitution is to be made. Unpick the substitute item completely, if the originally ordered item is required to be scanned. Ordered quantity has already been substituted. Only a 1:1 substitution is allowed. You can scan a maximum of the ordered quantity using the Substitute UI. Order and Inventory updates are not as expected. Order and Inventory updates may not go through appropriately if the substitution short reason code is not configured. Configure the appropriate reason using the “Store Fulfillment Parameters → Reason to short the items which are substituted” configuration. Substitute item price cannot be greater than ordered item price This is the validation error thrown in the case of free form substitutions when the free form price validation configuration is enabled and the input substitute item's price is greater than that of the ordered item. If the price validation configuration is inadvertently enabled, disable it. If the configuration is intentionally enabled, substitute with an item which is lesser priced than the ordered item. Item Price Not Found This is the validation error thrown in the case of free form substitutions when the free form price validation configuration is enabled and the input substitute item's price is not configured in MA Omni. Configure the e-commerce (Location ID = null) selling item price of the intended item and then try again. Reach out to Manhattan Associates if the issue persists even after configuring the substitute item's price in MA Omni. Missing item unit price in fulfillment line This is the validation error thrown in the case of free form substitutions when the free form price validation configuration is enabled and the ordered item's unit price is missing from the fulfillment. Rectify the reason behind the ordered item's unit price being null in the fulfillment and then try again. Contact Manhattan Associate if any assistance is required.