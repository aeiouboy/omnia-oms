# Shop Pay Integration

**Permalink:** shopify-shop-pay-only-stores
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Processing/Shopify Integration/Shop Pay Integration
**Content Length:** 25,130 characters
**Scraped:** 2025-08-09T21:58:18.798331

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Processing››Shopify Integration ››Shop Pay Integration Shop Pay Integration Previous I OverviewProcess OverviewPayment Creation in Manhattan Active® OmniFollow-on SettlementFollow-on RefundPayment ebhooksTransaction Create WebhookRefund Create WebhookShopify API TouchpointsMapping GuidelinesConfigurationShopify Configuration - Manual Payment CapturePayment Gateway Configuration Shopify Connectivity ConfigurationError Handling and TroubleshootingRelated Articles Overview Shop Pay can be used as a one-click payment method on non-Shopify websites through a "Shop Pay only" store. This special Shopify store type has no storefront and does not require items, prices, or customers to be configured. For integration with Manhattan Active® Omni, it serves as a payment gateway. Orders and authorizations originate on the non-Shopify e-commerce site. Orders are expected to be sent from the non-Shopify e-commerce site with the appropriate Authorization and tokenized payment method. Settlements and refunds are triggered by Manhattan Active® Omni and sent to Shopify, which may in turn route them to the merchant’s payment gateway. When orders are captured or modified in channels outside of e-commerce, the associated new payment methods are not sent to Shopify. These payments are processed using another payment gateway. See Payment Gateway integration page for more information. Process Overview Payment Creation in Manhattan Active® Omni Follow-on Settlement Once an order is created in the e-commerce website, the corresponding authorization transaction needs to be sent to Manhattan Active® Omni as it is done for any other orders paid without Shop Pay. Once the payment method is authorized, when the order is shipped, an invoice is created that leads to a follow-on settlement transaction being added to the payment method. This process is described in more detail in the settlement page. Regarding the Shopify integration, once the settlement transaction is created for a payment method that has "ShopifyPayments" as a payment gateway, it is sent to Shopify using the orderCapture mutation in Shopify GraphQL Admin API. Once the transaction is processed, a transaction create webhook is returned with the result of the settlement (success or failure). Follow-on Refund Once an order is settled, it can be refunded. See the refund page for more information on refund transactions. An order paid using Shop Pay and settled in Shopify can also be refunded using ShopifyPayments as a payment gateway. In the case of a refund on the parent order or a return order, when a refund payment transaction is created, the refundCreate mutation in Shopify GrapQL Admin API is called to trigger the refund process. Once the refund process is complete, a refund create webhook is returned with the result of the refund (success or failure). Payment ebhooks Transaction Create Webhook The transaction create webhook is received for settlement transaction creation. The content of this webhook is translated by the out of the box integration into a payment response to the payment component. In the case of a Shop Pay only store, any transaction not already created and in "in progress" status in Manhattan Active® Omni will be ignored. This means that when an order is created and the authorization transaction is sent to the Shopify webhook, it will be ignored. Original authorization needs to be sent on the order as it is done for any other payment method. Refund Create Webhook The refund create webhook is received when a refund transaction is processed in Shopify. The content of the webhook is translated by the out of the box integration into a payment response for the payment component. Shopify API Touchpoints See Shopify API called for additional information. Mapping Guidelines When creating the order, it is expected that the e-commerce website sends the original payment method and transaction to Manhattan Active® Omni. This means that orders paid by Shop Pay will also need to contain the original payment information in the order and payment payload. This section highlights how the Shop Pay payment method and payment transactions should be mapped in the order create payload from the e-commerce website relative to the Shopify payment information. Mapping guidelines for an order payed using Shop Pay component{ "OrderId": "orderId", // it is expected that this is the Shopify order name and the order ID from ecom //... all the order mapping "Payment": [ { "PaymentMethod": [ { "PaymentMethodId": "payload.receipt.payment_method", // if exists "CurrencyCode": "payload.currency", // if exists "AccountDisplayNumber": "payload.payment_details.credit_card_company + ' ' + payload.payment_details.credit_card_number", // if exists "NameOnCard": "payload.payment_details.credit_card_name", // if exists "CardExpiryMonth": "payload.payment_details.credit_card_expiration_month", // if exists "CardExpiryYear": "payload.payment_details.credit_card_expiration_year", // if exists "Amount": "payload.amount", // if exists "PaymentType": { "PaymentTypeId": "Credit Card" }, "GatewayId": "ShopifyPayments", // this needs to always be "ShopifyPayments" for all Shop Pay payments "BillingAddress": { "Address": { "Address1": "payload.billingAddress.address1", // if exists "Address2": "payload.billingAddress.address2", // if exists "State": "payload.billingAddress.provinceCode", // if exists "Phone": "payload.phone", // if exists "Email": "payload.email", // if exists "FirstName": "payload.billingAddress.firstName", // if exists "LastName": "payload.billingAddress.lastName", // if exists "PostalCode": "payload.billingAddress.zip", // if exists "Country": "payload.billingAddress.countryCodeV2" // if exists } }, "PaymentTransaction": [ { "PaymentResponseStatus": { "PaymentResponseStatusId": "Success | Failure based on payload.status" }, "PaymentTransactionId": "payload.paymentTransactionId", // fallback to payload.payment_id if payload.paymentTransactionId is null "RequestedAmount": "payload.amount", "RequestId": "payload.id", "RequestToken": "payload.id", "ProcessedAmount": "payload.amount or 0.00 if failure", "TransactionDate": "payload.created_at", // formatted using "yyyy-MM-dd'T'HH:mm:ss" "IsActive": true, "TransactionType": { "PaymentTransactionTypeId": "Authorization | Settlement based on payload.kind" }, "Status": { "PaymentTransactionStatusId": "Closed" // hardcoded }, "ProcessingMode": { "ProcessingModeId": "NormalProcessing" // hardcoded }, "OrderId": "payload.name", "AlternateOrderId": "payload.order_id", "TransmissionStatus": { "PaymentTransmissionStatusId": "Closed" // hardcoded } } ], "CardType": { "CardTypeId": "value based on credit_card_company" // make sure the card company matches the cardType existing in MAO } } ] } ] } Configuration Shopify Configuration - Manual Payment Capture Shopify has the ability to decide what amount needs to be captured based on the order status. However, in the out of the box integration, Manhattan Active® Omni is the payment orchestration system that decides how much to settle and refund for each payment method. To support this, Shopify payment capture must be configured to "Manual Capture". In Settings > Payments> Payment capture method: Payment Gateway Configuration If you installed the Manhattan Active® Omni App on the Shopify store, the payment gateway 'ShopifyPayments" should already be configured. The attributes below are the mandatory attributes. They are listed here for information purposes. Account Attributes APIVersion - "2024-07" ShopifyDomain - The shopify store domain. Example: "my-store.myshopify.com" Account encrypted attributes: Access Token given by the app ShopifyPayment payment gatewayPOST {{url}}/payment/api/payment/gateway/save { "PerformsStandaloneRefunds": true, "Account": [ { "AccountAttribute": [ { "Value": "2024-07", "Name": "ApiVersion" }, { "Value": "https://<yourstore>.myshopify.com/", "Name": "ShopifyDomain" } ], "UpdatedTimestamp": "2024-05-16T16:31:04.831", "AccountId": "Shopify", "AccountEncryptedAttribute": [ { "Name": "AccessToken", "Value": "your app access token" } ] } ], "GatewayId": "ShopifyPayments", "IsBase": true, "ProcessStuckTransaction": true } Shopify Connectivity Configuration See the configuration page for more information on connecting a Shopify store to a Manhattan Active® Omni organization. All steps apply in a Shop Pay only integration. The only difference is that Inventory and Order flows will be automatically disabled when the user selects the option for a Shop Pay only store in Step 2. In the context of the integration with Manhattan Active Omni, a Shop Pay only store needs to be flagged appropriately in the Shopify Configuration screen. Error Handling and Troubleshooting See here. Related Articles Shopify Technical IntegrationInventory Integration with ShopifyPayment Integration with ShopifyOrder Integration with Shopify