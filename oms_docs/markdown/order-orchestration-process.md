# Order Orchestration Process

**Permalink:** order-orchestration-process
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Orchestration/Order Orchestration Process
**Content Length:** 61,433 characters
**Scraped:** 2025-08-09T21:56:20.414396

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Orchestration ››Order Orchestration Process Order Orchestration Process Next The Order component provides a framework for processing, monitoring and execution of orders received from various selling channels. It also provides the ability to interact with external systems through user exits and outbound order publishing. This guide discusses order orchestration capabilities provided from the time of order creation through order archival. Order orchestration includes the selling services such as pricing, promotions, shipping and handling, and taxes, the state transition to guide each order through each step of the fulfillment lifecycle, and a set of order configuration and monitoring rules to define business processes for each order type. Details about each fulfillment service such as prioritization, allocation, and release are included in the Order Fulfillment guide. Order OrchestrationException HandlingServices Order Orchestration Large enterprises have complex requirements for processing a wide range of order types, from e-commerce to replenishment to business-to-business transactions. These orders may span a large geographic footprint, with each country or region having unique legal or business requirements. Enterprises require flexible configurations to support the unique requirements of their different channels and regions, and to respond quickly to the ever-changing market. The Order component provides configuration to support these requirements by assigning a unique set of configurations to each order type. For example, ABC Inc. is a retailer who does business in North America and Europe. ABC Inc. wants to use a single enterprise order management system for all selling channels, but each channel has unique requirements such as: Using Vertex as a third-party tax provider for North America orders, but using basic, local value-added tax rules for European orders Using the pricing, promotion, charge, and tax calculation services for all call center orders, but disabling these pricing services for replenishment orders Disabling pricing services for marketplace orders Preventing cancelation of order lines, after inventory has been allocated Automatically canceling unconfirmed orders wherein, a customer added items to an e-commerce shopping cart but never provided payment Each order is assigned an order type, which is used to identify the selling channel, brand, and any other factor which requires unique processing configuration. The rules for processing and monitoring orders, referred to as the Order Configuration, are configured by order type. The following pricing services ensure that the order prices, charges, taxes, and discounts are maintained, as order updates occur: Service Description Example Calculate Price If any mod type occurs for which the Calculate Price service is enabled, then the Order component sends a request to the Price and Promotion component to get the latest item price. If this mod type occurs for an order line, then only the price of that order line is updated. If the mod type occurs for an order-level mod type, then all order lines are re-priced. If this service is enabled for a mod type, then it is recommended that Re-evaluate Promotion, Calculate Charge, and Calculate Tax should also be enabled, as this data may be impacted by a new price. Adding a new line requires the calculate price service Reevaluate Promotions When Reevaluate Promotions is enabled, then the Order component sends a request to the Price and Promotion component to reevaluate existing promotions. Regardless of whether the mod type occurred for the order or order line, promotions are reevaluated for the entire order. If this service is enabled for a mod type, then it is recommended that the Calculate Tax service should also be enabled, as taxes need to be updated. Updating a line quantity requires reevaluation of promotions Calculate S&H Charges When Calculate Charges is enabled, then the Order component sends a request to the S&H component to calculate S&H charges. Regardless of whether the mod type occurred for the order or order line, S&H is reevaluated for the entire order. If this service is enabled for a mod type, then it is recommended that the Calculate Tax service should also be enabled, as taxes need to be updated. Changing a line shipping method requires re-calculation of S&H charges Calculate Return Fees When Calculate Return Fees is enabled, then the Order component calls local configuration to calculate return fees for the entire order (considering only return lines) or each return order line. This service is available for both order level or return order line mod types. Updating the item condition from Damaged to New requires re-calculation of return fees Calculate Taxes When Calculate Tax is enabled, then the Order component calls the Vertex component to calculate taxes for the order and lines. The Vertex component calls the third party Vertex system, which calculates tax for the order. Regardless of whether the mod type occurred for the order or order line, taxes are reevaluated for the entire order. It is recommended that this service is enabled for any mod type which impacts price, charges, promotions, or fees. Applying an appeasement on an order requires tax to be recalculated The following order fulfillment and inventory services ensure that each order line reserves inventory correctly, and that the Inventory component is kept in sync with the Order component when order updates occur: Service Description Example Change Status When the Change Status service is enabled, then the quantity being modified is dropped into a pre-allocation status in the state transition pipeline. This causes the quantity to re-attempt allocation. Any status which is less than 2000.000 (Allocated) can be configured as the change status. If this service occurs for a line-level mod type, then only the quantity on that order line is re-allocated. If this service is invoked for an order-level mod type, then eligible quantity for all lines is re-allocated. This service is not eligible for return line mod types. If Change Status is enabled, then Reevaluate Pipeline cannot be enabled. When a line shipping address is updated, the line must be re-allocated based on the new destination Evaluate Pipeline When the Reevaluate Pipeline service is enabled, then the pipeline determination logic is called to select a pipeline and drop the quantity at the beginning of that pipeline. If the pipeline determination logic selects the current pipeline, then the quantity is dropped at the beginning of the current pipeline. The purpose of this service is to allow an order line to transition between one pipeline and another, if an attribute which is used in the pipeline determination logic is changed. If this service occurs for a line-level mod type, then the pipeline of only that order line is reevaluated. If this service is invoked for an order-level mod type, then the pipeline is reevaluated for all order lines. This service is not eligible for return line mod types. If Reevaluate Pipeline is enabled, then Change Status cannot be enabled. When an order line changes from Store Sale delivery method to Pick up in Store delivery method, a new pipeline is required Resubmit Pipeline When this service is enabled, then the next service in the pipeline is invoked when the mod type update occurs. This is a way to proceed with the order fulfillment flow based on certain order updates. If an allocated order is on hold due to Fraud, then when the hold is resolved, the order is automatically released. Cancel Reservation When Cancel Reservation is enabled, then the Order component calls the Inventory component to cancel the reservation. If this service occurs for a line-level mod type, then only the reservation(s) of that order line are canceled. If this service is invoked for an order-level mod type, then reservations for all eligible lines in the order are canceled. This service is not eligible for return line mod types. When an order line is canceled, then the reservation should be canceled The following order publishing services provide the ability to generate outbound order messages upon each mod type, so that external systems can subscribe to the latest order updates: Service Description Example Publish Order When Publish Order is enabled, then a copy of the order including all order lines is published at the end of the transaction. If this option is enabled for multiple mod types, and such mod types occur in a single transaction, then only one outbound order is published. When an order is confirmed, an outbound order is published so that an email marketing system can send the customer an order confirmation email Publish Order Line When Publish Order Line is enabled, then a copy of the order and the lines which were modified is published. If this option is enabled for multiple mod types, and such mod types occur in a single transaction, then only one outbound order is published. When quantity on an order line ships, an outbound order is published so that an email marketing system can send the customer a ship confirmation email Publish Email When an Email Message option is configured, respective Email Message is published. Multiple email messages can be selected for the same Mod Type, and when such mod types occur in a single transaction, all the configured Email Messages are published. When order is shipped, Shipment Confirmation email message is published so that an email marketing system can send the customer a ship confirmation email. Publish Text When a Text Message option is configured, respective Text Message is published. Multiple text messages can be selected for the same Mod Type, and when such mod types occur in a single transaction, all the configured Text Messages are published. When order is shipped, Shipment Confirmation Text message is published so that an email marketing system can send the customer a ship confirmation text. Email Message Templates Email Message Templates are available for the below mentioned Email Message Types ShipConfirmation ReturnConfirmationNonReceipt ReceiptExpectedReturnConfirmation The above mentioned base Email Message Templates cannot be customized. However, new customized Email Message Templates can be created. Please refer to Order Orchestration Configuration for more information. Given below are the use cases which uses the out of the box Email Templates: Email Message Template Use Case ShipConfirmation Ship To Address order line is shipped ReturnConfirmationNonReceipt Return Order with all the Return Lines having Is Receipt Expected set to False. Return Order with all the Return Lines having Is Receipt Expected set to False and one or more Even Exchange lines. Return Order with all the Return Lines having Is Receipt Expected set to False and one or more Uneven Exchange lines. ReceiptExpectedReturnConfirmation Return Order with one or more Return Lines having Is Receipt Expected set to True, even if there are one or more Return Lines having Is Receipt Expected set to False. Return Order with one or more Return Lines having Is Receipt Expected set to True and one or more Even Exchange lines, even if there are one or more Return Lines having Is Receipt Expected set to False. Return Order with one or more Return Lines having Is Receipt Expected set to True and one or more Uneven Exchange lines, even if there are one or more Return Lines having Is Receipt Expected set to False. Text Message Templates Text Message Templates are available for the below mentioned Text Message Types OrderConfirmation ShipConfirmation ReadyForPickupNotification The above mentioned base Text Message Templates cannot be customized. However, new customized Text Message Templates can be created. Please refer to Order Orchestration Configuration for more information. Given below are the use cases which uses the out of the box Text Templates: Text Message Template Use Case OrderConfirmation Order is confirmed ShipConfirmation Ship To Address order line is shipped ReadyForPickupNotification Quantities for a Pickup At Store Order Line is moved to 'Picked' status Modification Rules Each modification rule enables the business to restrict each modification type for orders that reach a certain state. For example, the shipping address cannot be updated for order lines which have already been released to a distribution center (DC) or store. The modification rule table allows for the following restrictions to be enabled for each mod type: Restriction Description Example Restrict Post Confirmation Prevents a mod type from occurring when the order IsConfirmed flag is set to true. If this is enabled for an order-level mod type, then the modification is not permitted for the order. If this is enabled for an order line mod type, then the modification is not permitted for the line. If this is enabled for a return line mod type, then the modification is not permitted for the return line. Once an order is confirmed, the selling location cannot be updated Restrict from Status Prevents a mod type from occurring if the relevant quantity has surpassed a configured status. If this is enabled for an order-level mod type, then the modification is not permitted for the order once the order maximum fulfillment status has reached the configured value. If this is enabled for an order line mod type, then the modification is not permitted for the line once the line maximum fulfillment status has reached the configured value. This is not applicable for return lines. Once an order is released, the shipping address cannot be updated Restrict from Return Status Prevents a mod type from occurring if the relevant return quantity has surpassed a configured status. If this is enabled for an order-level mod type, then the modification is not permitted for the order once the order maximum return status has reached the configured value. If this is enabled for a return line mod type, then the modification is not permitted for the line once the line maximum return status has reached the configured value. This is not applicable for sale order lines. Once a return has been received, it cannot be canceled Order Monitoring Order monitoring is required to ensure that orders are progressing in a timely manner, and that action is taken on any orders which might not meet the timeframe committed to the customer. The monitoring tools can also be used to automate or improve manual processes, such as working orders which are in danger of missing their service level agreement (SLA). The Order component provides monitoring tools that can, for example: Auto-cancel an order if the order is not confirmed after X hours of creation Raise an alert if an order is not allocated after X hours A Milestone is a significant point in the order lifecycle which the business wants to measure against time, either to adhere to customer commitments or for reporting purposes. A milestone is considered reached when the order meets the milestone definition criteria configured for the milestone. The milestone definition criteria can include the order confirmation state as well as any order status. The following milestone definitions are provided out of the box: Confirmed: When order IsConfirmed = true Allocated: When all eligible quantity gets allocated in an order (Order MinFulfimentStatus >= 2000) Released: When all eligible quantity gets released in order (Order MinFulfimentStatus >= 3000) Fulfilled: When all eligible quantity gets fulfilled in order (Order MinFulfimentStatus >= 7000) Milestone rule definitions cannot be modified. A Milestone Scheduler runs frequently to evaluate is milestones have been met, and if so, to invoke the next set of actions. For example, for remorse periods, the Milestone Scheduler evaluates if the DoNotReleaseBefore date is in the past, and if so, it triggers release. There is currently no UI to monitor this scheduled job. An expected time can be configured for a milestone, with respect to the amount of time between the previous milestone and the current milestone. In the below diagram, the expected times are defined for each milestone: Confirmed is expected 60 minutes after Created Allocated is expected 180 minutes after Created Released is expected 240 minutes after Confirmed Shipped is expected 1440 minutes after Released If a milestone is not met in the expected time, then a monitoring rule can be used to trigger action based on the missed milestone. A monitoring rule can be used for two purposes: Raise an event after the expected time if milestone is not met. For example, raise event "ConfirmationDue" after 1 second if the milestone "Confirmed" is not met. Raise an event before the expected time if milestone is not met. For example, raise event "Before6Hours" before 6 hours of "Shipped". In the milestone configuration, the Restrict By Date has significance only with respect to the Released milestone. For example, the Released milestone is configured with "Expected 3 hours after Confirmed Milestone" and "Restrict By Date" enabled. This indicates that after the Order has been Confirmed, it will not get released for next 3 hours. When "Restrict By Date" is checked, the system populates the attribute "DoNotReleaseBefore". This Restrict By Date functionality is not supported for any milestones other than Released. For each order configuration, monitoring rules can be configured with unique milestones, expected time rules, and monitoring rules. Refer Order Orchestration Configuration / Order Configuration / Order Monitoring Configuration. Exception Handling Exceptions can occur during order processing due to invalid data or system connectivity issues. For example, the Pricing component might be down during order creation, and prices cannot be retrieved. If such situations are encountered, an exception is thrown with an error code. Each scenario has an error code which is provided regardless of the locale. Error message, however, can be translated based on the user's locale. Type "Error" is used for responses which require immediate user action. Type "Warning" is used for responses which do not require immediate user action, but indicate that there may be an underlying issue. Type "Info" is used for responses which are purely informational and do not require user action. The following table provides sample error codes. Error Code Description ord::10002 Order cannot be processed because connectivity cannot be established with a dependent component (e.g. Customer, Price, Tax, S&H) ord::10006 The request cannot be completed because the order ID does not exist ord::10007 The requested order modification is not permitted at status <order status> ord::10008 The requested order line modification is not permitted at status <order line status> Another method of handling system exceptions is to apply system holds. Order Summary The majority of internal interaction between components being asynchronous, it is always possible to have discrepancies between: the order object, the payments associated to that orders and the final invoice objects created at the end of the order lifecycle This feature aims to reduce and highlight such discrepancies by regrouping all important fields for an order across payment and invoices on a flat table easily readable. Note: Order summary is an asynchronous process and is designed with enough delay to avoid too many updates before the order and payment transactions are settled. The order summary will not be computed for historical orders (Orders created with IsImport = true) as we assume the external system importing orders made sure all orders were properly invoiced before sending them to Active Omni system. Order summary record is purged when an order is archived. Create date, Updated date, Created by and Updated by in the order payload are not honored. These are always calculated values Once computed, the order summary is accessible in the “Order Summary UI” that enables you to: Refresh the order summary to the latest situation of the order. Write off the discrepancy to close the financial reconciliation. Order summary table Each order will have an entry in the order summary table. This table has a flat structure containing the following fields Order summary json tag Original object Computation logic OrderId Order Order ID of the order, comes from the order table OrderTotal Order Order total field from the order table InvoiceTotal Invoice Sum of all invoices existing in the invoices - consider all Invoice Types (Shipping as well as Adjustment) AmountProcessed Invoice Sum of all settled amounts existing in the invoices - consider all Invoice Types (Shipping as well as Adjustment) FailedAmount Invoice Sum of all failed amounts existing in the invoices - consider all Invoice Types (Shipping as well as Adjustment) PaymentMethodAmountTotal Payment Method Sum of all the payment method amount on a payment header OrderPaymentStatus Order Status of the payment in the order object PaymentStatus Payment header Status of the payment in the payment header CurrentAuthAmountTotal Payment Method Sum of the current authorized amount across payment methods CurrentRefundAmountTotal Payment Method Sum of the current refund amount across payment methods CurrentSettledAmountTotal Payment Method Sum of the current settled amount across payment methods CurrentFailedAmountTotal Payment Method Sum of the current failed amount across payment methods org id Order Organization of the order MaxOrderFulfillmentStatus Order Indicates the maximum fulfillment lifecycle status of all units on the order MinOrderFulfillmentStatus Order Indicates the minimum fulfillment lifecycle status of all units on the order OrderLineCount Order Total number of lines including Canceled line having deliveryMethod as ShipToAddress or ShipToStore or PickUpAtStore or Email cancelLineCount Order Total number of canceled lines in order ReturnLineCount Order Count of order lines where isReturn = true OrderType Order Order type of the order InvoicePublishedAmountTotal Invoice Invoice.AMOUNT_PROCESSED Where PUBLISH_STATUS = PUBLISHED OR READY FOR PUBLISHING totalWriteOffAmount Order Total of the charges with ChargeType WriteOff Order Change tracker Every time the order, payment or invoice is updated, a message is pushed to the Order change tracker. This Order change tracker keeps track of the Order id and the time when the order was updated. Any order will have as many records in the Order change tracker table as there were updates on the order. The order change tracker is purged when the order summary job runs and process the order change tracker records to update the order summary Order summary job and job schedules Entity URL Sample JSON Order summary job type /order/api/batch/jobTypeDefinition { "JobTypeDescription": "Job to calculate the order summary for the recently modified orders", "InvocationServiceId": null, "CreateContextFromJobParams": false, "FaultTolerance": null, "Process": null, "JobStatusCallbackHandlerBean": null, "IsDBStatusMonitor": false, "TriggerMissingExecutions": null, "ChunkSize": 1, "JobTypeId": "orderSummaryJob", "JobType": "FUNCTIONAL", "StatusMonitorLevel": "CHUNK", "IsHeelToToe": false } Order Summary job schedule /order/api/batch/jobSchedule { "IsDisabled": false, "IsAdHoc": false, "Process": null, "StartDelay": "1000", "TriggerKey": "orderSummaryJobTrigger", "TimeZone": null, "JobTypeId": "orderSummaryJob", "CronExpression": "0 0/10 * 1/1 * ? *", "JobParameters": [ { "InputValue": "select distinct oct1.orderId from OrderChangeTrackerEntity oct1 where oct1.createdTimestamp < SQL('(? - interval :DelayTime :TimeUnit)', CURRENT_TIMESTAMP)", "InputKey": "QueryString" }, { "InputValue": "minute", "InputKey": "TimeUnit" }, { "InputValue": "30", "InputKey": "DelayTime" }, { "InputKey":"AddSecurityCriteria", "InputValue":"true" }, { "InputKey":"Limit", "InputValue":"2000" } ], "JobScheduleId": "orderSummaryJob", "RepeatInterval": "20000" } Order summary job schedule parameters Parameter (inputKey) Default value (InputValue) Purpose QueryString select distinct oct1.orderId from OrderChangeTrackerEntity oct1 where oct1.createdTimestamp < SQL('(? - interval :DelayTime :TimeUnit)', CURRENT_TIMESTAMP) Query used to select which change tracker events should be considered to update the Order summary. TimeUnit minute Unit used for the delay time in the job schedule query DelayTime 30 The Delay time is used to determine how long the order summary job should wait after the latest update on an order to update the Order summary. As all updates between order and payment are asynchronous, if the order summary is updated in between two updates happening with few seconds delay, this may result in a false alert at the payment summary level AddSecurityCriteria true If true, the security criteria will add the org Id and the profile Id to the query Limit 2000 Maximum number of order change tracker record processed by the job at each run. We recommend every project team to check their volume and adapt the limit depending on the volumes. Queues and message types Functionality queue message types service definition Order change tracker order queue.OrderChangeTracker IB message type: { "MessageType": "OrderChangeTrackerMSGType", "NoOfConsumer": 10, "MinNoOfConsumer": 1, "Idempotent": true, "ExternalIntegrationRequired": false, "MaxDesiredInstances": 6, "ScaleUpTimeWindow": 10, "ScaleDownTimeWindow": 20, "Description": "", "ServiceId": "processPaymentChangeTrackerEvent", "InBoundQueues": { "QueueName": "queue.OrderChangeTracker" } } { "ComponentId": "Order", "ServiceId": "processPaymentChangeTrackerEvent", "BeanName": "orderChangeTrackerHandler", "BusinessMethod": "processPaymentChangeTrackerEvent", "Url": null } payment OB message type: { "MessageType": "OrderChangeTrackerMSGType", "Transactional": true, "PersistMessageToMsgStore": false, "OutBoundQueues": { "QueueName": "queue.OrderChangeTracker" } } NA autocorrection queue.OrderAutoCorrection IB message type: { "MessageType": "OrderAutoCorrectionMSGType", "NoOfConsumer": 10, "MinNoOfConsumer": 1, "Idempotent": true, "ExternalIntegrationRequired": false, "MaxDesiredInstances": 6, "ScaleUpTimeWindow": 10, "ScaleDownTimeWindow": 20, "Description": "", "ServiceId": "OrderAutoCorrection", "InBoundQueues": { "QueueName": "queue.OrderAutoCorrection" } } OB message type: { "MessageType": "OrderAutoCorrectionMSGType", "Transactional": true, "PersistMessageToMsgStore": false, "OutBoundQueues": { "QueueName": "queue.OrderAutoCorrection" } } { "ComponentId": "Order", "ServiceId": "OrderAutoCorrection", "BeanName": "orderAutoCorrectionService", "BusinessMethod": "autoCorrectOrder" } orderSummaryJob IB message type: { "MessageType": "orderSummaryJob", "NoOfConsumer": 10, "MinNoOfConsumer": 1, "Idempotent": true, "ExternalIntegrationRequired": false, "MaxDesiredInstances": 6, "ScaleUpTimeWindow": 10, "ScaleDownTimeWindow": 20, "Description": "", "ServiceId": "calculateOrderSummary" } OB message type: { "MessageType": "orderSummaryJob", "Transactional": true, "PersistMessageToMsgStore": false, "MessageCategory": "batchmsg" } { "ComponentId": "Order", "ServiceId": "calculateOrderSummary", "BeanName": "orderSyncService", "BusinessMethod": "calculateOrderSummary" Important APIs API Method URL Get the order change tracker GET {{url}}/order/api/order/orderChangeTracker Calculate the summary for one order POST {{url}}/order/api/order/order/calculateOrderSummary Body: {“OrderId” : “<orderID>” } GET the order summary GET {{url}}/order/api/order/orderSummary Autocorrection scenario The order summary table will also be used by the system to trigger auto corrections on the system data. Autocorrection is the action of retriggering asynchronous communication in case the message was nor processed properly in the first place. It will not change the amount of the order/payment or over/under capture funds. Any type of action that has financial impact needs to be triggered manually by the user Autocorrection action is not available from the UI yet. It will be enabled in a case by case basis with the scheduler before being made available in the UI for every customer. If you are interested in autocorrection scenarios, you will need to: Enable the parameter in the Kv store com-manh-cp-order/order.enableOrderSummaryAutoCorrection to true Test the API directly Enable the autocorrection scheduler Auto correction scenario Trigger System action Order is bridged in with a payment, but the payment is not sent to the payment component PaymentMethodAmountTotal <> OrderTotal Check the payment temp table in order component if payment is stuck in order component. If it is still here, trigger payment re-creation in the payment component. Invoice is not closed even if all associated payment transaction have been processed successfully invoice amount <> amount processed total + failed amount The system will check the status of the different settlement payment transactions. If a transaction associated with an open invoice is closed, the system will try to close the existing open invoice. Services The APIs listed in the following table are related to order orchestration. Refer to the API documentation for additional details on each service. Service Component Group Service Endpoint Save Order Order Order Services /order/api/order/order Get Order* Order Order Services /order/api/order/order/orderId/{orderId} Note: The Get order API response is controlled via template. Use the template to define what entities and attributes are included in the API response. To include the parent order for a return or exchange order, include the 'RelatedOrders' tag in the template. To include related returns for an order, include the 'RelatedReturns' field in the template. Related Articles Shipping RestrictionDelivery TrackingOrder Audit Order CancellationPublishing Order Order ArchivingOrder Orchestration ConfigurationMod TypesOrder TaggingCart and Preview ModeHoldsCreating and Updating Order