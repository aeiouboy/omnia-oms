# Advanced Shipping Restrictions

**Permalink:** advance-shipping-restrictions
**Path:** Manhattan Active® Omni/Order Management/Process & Configuration Guides/Order Promising/Advanced Shipping Restrictions
**Content Length:** 34,278 characters
**Scraped:** 2025-08-09T21:55:57.557540

---

Home ››Manhattan Active® Omni››Order Management››Process & Configuration Guides››Order Promising ››Advanced Shipping Restrictions Advanced Shipping Restrictions OverviewHow Shipping Restrictions WorkProcess Flow Restriction TypesSoft CheckHard CheckShipping Restriction Order Line HoldShipping Restrictions in Contact CenterConfigurationHow to Enable Advanced Shipping RestrictionsHow to Configure Advanced Shipping Restrictions RulesHow to Enable Shipping Restrictions for promising and ATP(Product and Cart)Configuring Service for Evaluating Shipping RestrictionsUser ExitsImplementation Flavors Existing/New customers who want to use advanced shipping restrictions How to stop shipping restriction evaluation for imported ordersHow to prevent orders from getting allocated or released (with Shipping Restriction Hold)How to implement shipping restrictions on a PO Box addressHow to Add Item Extended Attributes in Shipping Restrictions MUP UI Related Articles Overview There are certain rules and restrictions which have to be evaluated by the retailer at the time of capturing or modifying an order. These restrictions are mostly shipping restrictions enforced by state/country laws that have to be evaluated before providing the appropriate shipping and delivery options to customers. The retailers may also have some restrictions to exclude specific supplies and locations before promising an order to the customer. For example : Fur or leather goods cannot be shipped to California. Flammables like nail polish or perfume cannot be shipped through Air Freight. USPS Ground is the only shipping method allowed for PO Boxes or Military Zones (APO/FPO) or diplomatic offices (DTO) in the US. Express cannot ship from future inventory. Air can ship Hazmat Items only from DCs (not Stores & Suppliers). Express cannot ship VAS order line. For Ship to Store orders, only ground shipping is eligible (not Express or Air). Carrier DHL and Service Level DHL_GROUND cannot ship items more than 2 m in length. Items more than 5 m in length cannot be shipped to a specific region using UPS and UPS GROUND. These restrictions can be configured using the item, order line, and address attributes. Below is the list of attributes supported from base on which restrictions can be applied. Refer here for configuration. Item attributes : Item.isHazmat, Item.Item Length, Item.Product Class Order Line Attributes : OrderLine.Carrier, OrderLine.ShippingMethod, OrderLine.DeliveryMethodID, OrderLine.ServiceLevel, OrderLine.isVAS Address Attributes : Address.State, Address.Country, Address.PostalCode, Address.isRestrictedForPOBox, Address.DestinationRegion Note: Item extended attributes can also be used to configure shipping restrictions. Follow this link to add extended attributes. How Shipping Restrictions Work Retailers can choose to configure shipping restriction rules in the promising component, which helps to notify customers of any shipping restriction applicable during the order capture or modification process. Refer here for more details on configuration. If rules are configured, then every time an order is captured or modified with a change in shipping address, shipping method, or delivery method will result in evaluating shipping restrictions. The following modification types are triggered during the order capture or modification process: Update Address Update Shipping Info Update Delivery Method Add Line This shipping restrictions evaluation can be enabled/disabled from the Order Configuration UI in modification rules. This shipping restrictions evaluation can also be called by custom mod types. Once the EvaluateShippingRestriction service is called and a response is received from the shipping and handling component, the configured restrictions are returned as an error message and displayed in the Customer Service UI, so that the contact center agent can update the shipping method or shipping address to which the item can be shipped. Below are the sample request and response for Shipping Restrictions Sample Request for Shipping Restrictions{{url}}/promising/api/promising/evaluateShippingRestrictions { "RequestId": "123", "ShippingDetails": [ { "Id": "1234", "ItemId": "Hazmat_item", "IsVAS": true, "ShippingMethodId": "Standard", "CarrierCode": "UPS", "ServiceLevelCode": "UPS_GROUND", "DeliveryMethodId": "ShipToAddress", "Address": { "PostalCode": "75250", "Country": "US", "State": "NY", "IsPoBox": false } } ] } { "RequestId": "123", "ShippingDetails": [ { "Id": "1234", "ItemId": "Hazmat_item", "ShippingRestrictions": [ { "ExcludedSupplyTypes": [], "ExcludedLocationTypes": [], "RuleName": "Hazmat item Restrictions", "ErrorMessage": "Hazmat Items cannot be shipped to state NY", "IsRestricted": true } ], "IsRestricted": true } ] } Note: Shipping restriction evaluation is applicable to ship to address and ship to store order lines. Process Flow Restriction Types Shipping restriction rules can be configured either as soft checks or hard checks. The "Is Warning" flag on the promising entity while configuring shipping restrictions rules determines whether a configured restriction is a soft check or hard check. If "Is Warning" = false ; restriction is a hard check If "Is Warning" = true ; restriction is a soft check Retailers can choose to configure restrictions as soft checks when they want to provide an opportunity for the contact center agent to read out restrictions to the customer and correct the shipping method or address, but also give an option to ignore the restriction without updating the valid address or shipping method and proceed with the order. On the contrary, restrictions are configured as hard checks when restrictions should not be ignored and valid shipping method or shipping address should always be updated for the restricted line. Soft Check If rules are configured as soft checks, then configured restrictions are populated as an error message for the contact center agent to acknowledge any restrictions on the order, but they do not restrict those order lines in any form. Order populates the restrictions in the order header message so that the Customer Service UI can display the message as an error pop-up, but these restrictions are not persisted anywhere in the order component. Hard Check If rules are configured as hard checks, then the configured restriction populates as an error message and the order line with the corresponding restriction is then put on hold. Shipping Restriction Order Line Hold Order lines having hard bound restriction on them should be prevented from moving ahead in the order fulfillment process like allocation, release, etc., because eventually such order lines are not shippable to the customer's address. Hence, hard restricted lines are always flagged by an order line hold with holdType as ShippingRestriction and error message for the shipping restrictions are captured in OrderHold.ApplyReasonComments. Once the shipping address or shipping method is modified, and order line is no longer restricted with a hard check, the system automatically resolves the order line hold. When order line hold is applied - Sample JSON{ "OrderLineHold": [ { "UpdatedTimestamp": "2022-01-17T10:44:36.574", "HoldTypeId": "ShippingRestriction", "CreatedBy": "admin@ecomorg.com", "CreatedTimestamp": "2022-01-17T10:44:36.574", "Process": null, "ResolveReasonId": null, "ExternalCreatedDate": null, "ResolveReasonComments": null, "OrgId": "ecomorg", "UpdatedBy": "admin@ecomorg.com", "ExternalCreatedBy": null, "ContextId": "7f66968d-5a13-448f-a962-dce5135f5134", "StatusId": "1000", "ApplyReasonComments": "10004:Product class: Tops cannot be shipped to Country: US State: GA Postal Code: 30339 Po Box .", "PK": "6424162765742478777", "Unique_Identifier": "6424162765742478777__ShippingRestriction" } ] } When order line hold is resolved - Sample JSON{ "OrderLineHold": [ { "UpdatedTimestamp": "2022-01-17T10:44:36.574", "HoldTypeId": "ShippingRestriction", "CreatedBy": "admin@ecomorg.com", "CreatedTimestamp": "2022-01-17T10:44:36.574", "Process": null, "ResolveReasonId": "ShippingRestrictionResolved", "ExternalCreatedDate": null, "ResolveReasonComments": null, "OrgId": "ecomorg", "UpdatedBy": "admin@ecomorg.com", "ExternalCreatedBy": null, "ContextId": "7f66968d-5a13-448f-a962-dce5135f5134", "StatusId": "2000", "ApplyReasonComments": "", "PK": "6424162765742478777", "Unique_Identifier": "6424162765742478777__ShippingRestriction" } ] } Shipping Restrictions in Contact Center The existing 'Evaluate Shipping Restrictions' option in the Call center config mentioned will soon be depreciated. To evaluate shipping restriction as a warning/ soft check (no change in order line status) or hard check (order line goes on hold if there is a shipping restriction). Until the 'Evaluate Shipping Restrictions' option in the Call center config is depreciated. Users will see two pop-ups with the shipping restrictions info if the call center config and Order config shipping restrictions are both turned on at the same time. To avoid seeing 2 popups for the same functionality. Please uncheck the call center config and use only the Shipping restrictions config to set shipping restrictions. Configuration How to Enable Advanced Shipping Restrictions Advanced Shipping Restrictions can be enabled using the following steps : Navigate to Application Configuration > Manage Selling Configuration > Shipping & Handling Config Parameters. Select a shipping and handling config parameter and click Edit. Select the "Use Advanced Shipping Restrictions" checkbox. How to Configure Advanced Shipping Restrictions Rules Advanced Shipping Restrictions Rules can be configured using the following steps : Navigate to Application Configuration > Manage Selling Configuration > Shipping & Handling > Shipping Restrictions. Step 1: On the Shipping Restriction page, select an existing shipping restriction to update or view the details or click Create to create a new shipping restriction. Enter the Config Name, Description, Rank, Error Description(Enter the error message that needs to be displayed in contact center UI), is Warning (If "yes" it is a soft check, else "No" means hard check), select the Delivery Method Id(Ship To Address and/or Ship To Store) and click Save and Continue to take you to step 2. Step 2: Click Create to create a rule for shipping restrictions. On the Shipping Restriction Config Rule page, enter a rule name. In the Attribute section, Select the attribute based on which restrictions need to be applied Select the required operator Enter or select the values for the selected attribute. Based on the attribute that we select, the value can be boolean, list of drop-downs, or a textbox to enter the comma-separated values. Click Save and Finish. Step 3: This step provides the option to configure exclusions for specific supply types and location types by selecting them from the corresponding drop-downs. If nothing is selected, it excludes everything. How to Enable Shipping Restrictions for promising and ATP(Product and Cart) To enable the shipping restrictions evaluation during cart and product ATP, follow the below steps : Navigate to Menu > Application Configuration > Manage Enterprise Fulfillment Configuration > Fulfillment Optimization. In the Fulfillment Optimization strategy, select the fulfillment optimization for which shipping restrictions need to be evaluated, and then click Edit. Select "Evaluate Shipping Restrictions" to enable evaluation during product/cart ATP. Alternatively, you can use the following API to enable this configuration. {{url}}/promising/api/promising/promisingConfig/save { "PromisingConfigId": "PCN1723195803705", "PromisingConfigName": "Ecom", "EvaluateShippingRestrictions": true } Configuring Service for Evaluating Shipping Restrictions The EvaluateShippingRestriction service can be enabled from the modification rules in Order Configuration UI. Refer here for more details on how to configure. Shipping restrictions are evaluated when some of the following modification types are triggered during order capture or modification. Add Line Update Delivery Method Update Shipping Info Update Address User Exits Access the user exit documentation for more details on the below user exit User Exit Input Order:Order:UserExit:PreEvaluateShippingRestriction ShippingRestrictionRequestDTO Order How to access Omnifacade app -> Developer Resource -> Order -> Order User Exit Documentation Grants required omnifacade::order::userexit::read Implementation Flavors Existing/New customers who want to use advanced shipping restrictions Manually create the existing restriction along with the new restriction rules using these steps. Enable advanced shipping restrictions using these steps. Configure which Order Mod types will trigger evaluate shipping restrictions using these steps. Enable advanced shipping restrictions from fulfillment optimization (If required) using these steps. How to stop shipping restriction evaluation for imported orders "ShippingRestrictionsEvaluated" flag should be set to true under OrderActions while importing Order so that EvaluateShippingRestrictions service is not called during Order Create/update process. { "OrderActions": { "IsAlreadyPriced": true, "IsAlreadyCharged": true, "IsAlreadyTaxed": true, "IsImport": true, "ShippingRestrictionsEvaluated": true } } How to prevent orders from getting allocated or released (with Shipping Restriction Hold) Extended attributes need to be configured manually in fulfillment optimization and release configuration templates, which considers the shipping restriction hold type as an order line criterion to restrict allocation/release of order lines with shipping restrictions hold (filter criteria having holdType=ShippingRestriction) Or Enable "Evaluate Shipping Restrictions" flag in fulfillment optimization template using these steps. How to implement shipping restrictions on a PO Box address Enable isRestrictedForPobox to true while configuring shipping restrictions and identify the shipping address as a PO box address using Order:Order:UserExit:PreEvaluateShippingRestriction. How to Add Item Extended Attributes in Shipping Restrictions MUP UI Step 1 : Add Available Entity {{url}}/api/rules/availableEntity/save { "AvailableEntityId": "item", "TopLevelEntity": 1, "EntityLabel": "Item" } Step 2 : Add Available Attribute as "style" if extended attribute needs to be item.style. {{url}}/api/rules/availableAttribute/save { "AvailableEntityId": "item", "AvailableAttributeId": "style", "AttributeDataType": { "AttributeDataTypeId": "text" }, "ListDataType": null, "ListFunctions": null, "SourceValue": null, "SourceType": null, "AttributeLabel": "Style" } Step 3 : Add Rule Type Available Attribute a) {{url}}/api/rules/ruleTypeAvailableEntityXref/save { "RuleType": { "RuleTypeId": "ShippingRestrictionConfigRule" }, "AvailableEntity": { "AvailableEntityId": "item" }, "TopLevelEntity": 1 } b) {{url}}/api/rules/ruleTypeAvailableAttributeXref/save { "RuleType": { "RuleTypeId": "ShippingRestrictionConfigRule" }, "AvailableAttribute": { "AvailableEntityId": "item", "AvailableAttributeId": "style" } } Related Articles Customer Engagement ConfigurationsTroubleshootingOverviewForce AllocateProcure To SellSubstitution During AllocationForecast ReservationREST APIs and User ExitsHow Promising WorksHow Optimization Works