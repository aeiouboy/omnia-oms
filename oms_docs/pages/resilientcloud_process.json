{
  "id": "2342338",
  "permalink": "resilientcloud_process",
  "title": "Resilient cloud process",
  "type": "topic",
  "level": 7,
  "path": "Manhattan Active® Omni/Store/Process & Configuration Guides/Point of Sale/POS Classic Guides/Resilient Cloud for POS/Process/Resilient Cloud Process",
  "raw_item": {
    "id": "2342338",
    "text": "Resilient Cloud Process",
    "title": "Resilient Cloud Process",
    "permalink": "resilientcloud_process",
    "leaf": false,
    "droppable": true,
    "expanded": true,
    "closed": true,
    "visible": true,
    "editable": true,
    "type": "topic",
    "topicType": "0",
    "status": "1",
    "iconCls": "icon-topic",
    "cls": "",
    "folder_id": "225075",
    "parent": "f;225075",
    "created_date": "1571867652",
    "modified_date": "1735237396",
    "instructor_id": null,
    "loaded": true,
    "haschildren": false,
    "callout": "0",
    "order": "1"
  },
  "success": true,
  "content": "\r\n\r\n\r\n<div class=\"hiq-page-wrap\">\r\n<div class=\"hiq-t-wrap\">\r\n\t\t\r\n  \t  <div class=\"hiq-t \">\r\n\t\t\t\t<ul class=\"breadcrumbs\"><li><a class=\"breadcrumb-links\" hqid=\"1788908\"  href=\"/home\">Home</a></li> <li><span>&rsaquo;&rsaquo;</span><a hqid=\"3500940\" href=\"/omni\" class=\"breadcrumb-links\">Manhattan Active® Omni</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"3426481\" href=\"/store-3\" class=\"breadcrumb-links\">Store</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2158412\" href=\"/process-configuration-guides-3\" class=\"breadcrumb-links\">Process & Configuration Guides</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2158737\" href=\"/point-of-sale\" class=\"breadcrumb-links\">Point of Sale</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2225114\" href=\"/process-configuration-guides-4\" class=\"breadcrumb-links\">POS Classic Guides</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2342333\" href=\"/20.1-resilient-cloud-for-pos-draft\" class=\"breadcrumb-links\">Resilient Cloud for POS</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2342335\" href=\"/process-guide\" class=\"breadcrumb-links\">Process</a></li><li> <span>››</span>Resilient cloud process</li></ul>  \t\r\n\t\t<h2>Resilient Cloud Process</h2>\r\n\r\n<p></p>\r\n\r\n<div class=\"tip\"><ul><li><a href=\"/resilientcloud_process$inbound-sync-for-resilient-cloud\">Inbound Sync for Resilient Cloud</a><ul><li><a href=\"/resilientcloud_process$export-process-creating-the-inbound-sync-bundle-at-central\">Export Process - Creating the Inbound Sync Bundle at Central</a></li><li><a href=\"/resilientcloud_process$import-process-downloading-and-consuming-the-inbound-sync-bundle-at-edge\">Import Process - Downloading and Consuming the Inbound Sync Bundle at Edge</a><ul><li><a href=\"/resilientcloud_process$inbound-job-workflow\">Inbound Job Workflow</a></li></ul></li><li><a href=\"/resilientcloud_process$inbound-sync-processing-errors-alerts\">Inbound Sync Processing Errors - Alerts</a></li></ul></li><li><a href=\"/resilientcloud_process$outbound-sync-nbsp-for-resilient-cloud\">Outbound Sync&nbsp;for Resilient Cloud</a><ul><li><a href=\"/resilientcloud_process$outbound-sync-process-orders\">Outbound Sync Process- Orders</a><ul><li><a href=\"/resilientcloud_process$process-flow-outbound-sync-orders-nbsp\">Process Flow: Outbound Sync - Orders&nbsp;</a></li><li><a href=\"/resilientcloud_process$alternate-flow\">Alternate Flow</a></li></ul></li></ul></li><li><a href=\"/resilientcloud_process$backoffice-process\">Backoffice Process</a><ul><li><a href=\"/resilientcloud_process$backoffice-in-resilient-cloud-nbsp-mode\">BackOffice in Resilient Cloud&nbsp;mode</a></li><li><a href=\"/resilientcloud_process$inbound-sync-from-central-cloud-to-local-resilient-cloud\">Inbound Sync from Central Cloud to local Resilient Cloud</a></li><li><a href=\"/resilientcloud_process$outbound-sync-process-nbsp-back-office-transactions\">Outbound Sync Process-&nbsp;Back Office Transactions</a><ul><li><a href=\"/resilientcloud_process$process-flow-back-office\">Process Flow: Back Office</a></li></ul></li></ul></li><li><a href=\"/resilientcloud_process$edge-health-dashboard-and-servers\">Edge Health Dashboard and Servers</a><ul><li><a href=\"/resilientcloud_process$modules\">Modules</a></li></ul></li><li><a href=\"/resilientcloud_process$edge-server-logging\">Edge Server Logging</a></li><li><a href=\"/resilientcloud_process$services\">Services</a></li></ul></div>\r\n\r\n<h3><a name=\"inbound-sync-for-resilient-cloud\" id=\"inbound-sync-for-resilient-cloud\"></a>Inbound Sync for Resilient Cloud</h3>\r\n\r\n<p>Resilient Cloud for POS is a feature that allows POS device to perform certain POS and Backoffice operations even when connectivity to central Cloud Services are unavailable for whatever reason, by maintaining a local subset of components on the edge&nbsp;server.&nbsp;</p>\r\n\r\n<p>The Resilient Cloud &quot;edge&quot; server is designed to run in&nbsp;the store, isolated from&nbsp;the central cloud server.&nbsp;When deployed and connected,&nbsp;it needs to keep data such as configurations and master data available via periodic import&nbsp;from the central server through a scheduled inbound sync process.</p>\r\n\r\n<p>This process can be included as the very first step or as part of the final step in the installation of the local server.&nbsp;For this requirement, we need to download the config&nbsp;and master data from the central server down to the store server. We will be leveraging the component-config&nbsp;functionality&nbsp;to perform these actions. These actions need to be scheduled to be exported as form of packages/files which can be consumed by store server.</p>\r\n\r\n<p>During or after deploying&nbsp;the Resilient Cloud&nbsp;server on store, it is a pre-requisite to get the config and master data to the store server before&nbsp;using the resilient cloud server to perform any transaction. Export process will get the config and master data from the central and put it into an object repository. Store server can reach out to this repository to get the latest export file and import these files&nbsp;back to the resilient cloud server after performing a delta which is termed as different from the previous successful import jobs.</p>\r\n\r\n<h4><a name=\"export-process-creating-the-inbound-sync-bundle-at-central\" id=\"export-process-creating-the-inbound-sync-bundle-at-central\"></a>Export Process - Creating the Inbound Sync Bundle at Central</h4>\r\n\r\n<p>&quot;Export&quot; is the process&nbsp;by which data is packaged and posted from the Central Cloud server for consumption by the edge&nbsp;server.&nbsp;Export process is triggered from Edge when the Inbound sync process runs. This job invokes an export API which will export the config and master data as zip file into a configured S3 bucket. The detailed flow is given below:</p>\r\n\r\n<ol>\r\n\t<li>&nbsp;Configure the S3 bucket details as described in the&nbsp;<a hqid=\"2342340\" href=\"/resilientcloud_configuration_guide$application-edgeyml\">Resilient Cloud Configuration Guide</a>.</li>\r\n\t<li>&nbsp;This job invokes the export API, export API uses the orgID&nbsp;from context or from the input&nbsp;details provided while calling the API which are (OrgID, Profile Purposes and Components) profile purpose and components are optional fields.</li>\r\n\t<li>&nbsp;The export API should know the qualifier as the input fields&nbsp;(The environment from which the data needs to be exported)</li>\r\n\t<li>&nbsp;Once the export API is executed, a zip file is uploaded to the S3 bucket and exportId record is saved on the Export_master entity on config component for further reference of this export job.</li>\r\n</ol>\r\n\r\n<h4><a name=\"import-process-downloading-and-consuming-the-inbound-sync-bundle-at-edge\" id=\"import-process-downloading-and-consuming-the-inbound-sync-bundle-at-edge\"></a>Import Process - Downloading and Consuming the Inbound Sync Bundle at Edge</h4>\r\n\r\n<p>Import or Inbound&nbsp;process is invoked through a scheduler job from the&nbsp;backoffice&nbsp;component running on resilient cloud. This job invokes an&nbsp;API to insert the diff data to the resilient cloud from where the job was triggered. The detailed flow is given below:</p>\r\n\r\n<ol>\r\n\t<li>Get the latest exportId&nbsp;from the central server</li>\r\n\t<li>Fetch the Last successful import record from the resilient cloud and get the&nbsp;corresponding exportId&nbsp;reference (which is the previous successful exportId)</li>\r\n\t<li>If latest exportId fetched from central&nbsp;& previous exportId&nbsp;on resilient cloud does not match, then it checks whether the data for current exportId is available in local resilient cloud space. If no, it pulls the data from S3 bucket.</li>\r\n\t<li>Once the export zip file is identified, call DIFF API in store server to generate the delta comparing current & previous exports.</li>\r\n\t<li>Call the edge import API to import the delta data.</li>\r\n\t<li>Remove the delta data from the local directory.</li>\r\n</ol>\r\n\r\n<div class=\"tip\">\r\n<p><a id=\"InboundSyncDeletedRecords\" name=\"InboundSyncDeletedRecords\"></a>NOTE:&nbsp; If any config/master data is deleted in central server, then the daily/scheduled inbound sync job will now remove the deleted data on the edge server automatically.&nbsp;This is controlled by&nbsp;&quot;configdirector.import.deleteEntity.enable&quot; flag on configuration component and by default is set as TRUE. It will allow&nbsp;user&#39;s to reflect&nbsp;deleted data from central to be synced and removed from edge.&nbsp;</p>\r\n\r\n<p>Note&nbsp;that any&nbsp;fresh resilient cloud server installation or upgrade always completely refreshes or creates a new DB from scratch.</p>\r\n</div>\r\n\r\n<h5><a name=\"inbound-job-workflow\" id=\"inbound-job-workflow\"></a><big>Inbound Job Workflow</big></h5>\r\n\r\n<p><strong><img alt=\"\" src=\"https://dzf8vqv24eqhg.cloudfront.net/userfiles/4665/7671/ckfinder/images/Inbound%20Sync%20Job%20Flow.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9kemY4dnF2MjRlcWhnLmNsb3VkZnJvbnQubmV0L3VzZXJmaWxlcy80NjY1Lzc2NzEvY2tmaW5kZXIvaW1hZ2VzL0luYm91bmQlMjBTeW5jJTIwSm9iJTIwRmxvdy5wbmciLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NTQ3NTIxMzJ9fX1dfQ__&Signature=GSWS7e5FClT-LOJSc9N3mYPqCe3eWdMKqJcwUZEtdQ95nj5q5TSmwpOewsAvrJ2NNFxQKvc6GxvfUfpGzs59c9SAhvUmBsO9SenWmz-Sl8ApWps0MuHSWEdOxMce1c7Wegq8AZtJ90UIaN0lJ9XHIPJxeon7lizQ22LmG46SMLhkKSHMGAiBhVpvnCpWe8kIljgEblO~DIbfdwTSNPwRf0k1F8JOkaQgwmsR2Ft2zxrnSLH59YkWfWAu3wRdJ7~PYGkWH9JQurB~O0W~lYffll6D0wGffpDR9KDMjvYDZLjefBodaVpmOIWSBrIUU9u9TGgrggGYPownzhPGtAsiLQ__&Key-Pair-Id=K2TK3EG287XSFC\" style=\"width: 785px; height: 700px;\" /></strong></p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<h4><a name=\"inbound-sync-processing-errors-alerts\" id=\"inbound-sync-processing-errors-alerts\"></a>Inbound Sync Processing Errors - Alerts</h4>\r\n\r\n<p>During this process, it&#39;s possible&nbsp;that the Inbound sync process is not completed or fails. &nbsp;This can be due to multiple reasons like:</p>\r\n\r\n<ul>\r\n\t<li>Failure during the actual import of data into component entities</li>\r\n\t<li>The master and config data failed to sync</li>\r\n\t<li>Sync process aborted due to timeout.&nbsp;</li>\r\n</ul>\r\n\r\n<p>Such failures generate alert messages which are posted to the Central server and can be distributed to key support users via email.&nbsp;&nbsp;</p>\r\n\r\n<p>This provides a way to monitor the health of this process over various stores centrally without forcing user to remotely access each separate location&#39;s Edge server.&nbsp;</p>\r\n\r\n<p>It is also significant that inbound sync process logs are also&nbsp;captured at the Central server to ensure it is available for debugging purpose. This is made possible by tracing every step involved in the sync process and posting&nbsp;to central server. These trace details are further used to exhibit the data on Edge Management dashboard or to publish the alerts.&nbsp;</p>\r\n\r\n<p><strong>How is the data for Alerts obtained?</strong></p>\r\n\r\n<p>A new stats rest endpoints is exposed from Backoffice to provide the stats for InboundSync Job Status across the stores:</p>\r\n\r\n<p>/stats/status/inboundSync &ndash; This API provides the count of inboundSync jobs the last configured interval across stores.</p>\r\n\r\n<p>As part of this, three different stats are added to this metric:</p>\r\n\r\n<ul>\r\n\t<li><strong>Failed</strong>: Number of EdgeServers for which inboundsync is failing.&nbsp; That is the count of EdgeServers From EdgeEventSummary where InboundFailureCount &gt; 0</li>\r\n\t<li><strong>DelayedCompletion</strong>: If InboundSync is running beyond threshold time, count of EdgeServers from EdgeEventTrace for event type InboundSync which is Started before thresholdTime and refresh Heartbeat is active.</li>\r\n\t<li><strong>Skipped</strong>: If Inbound sync is not triggered for the last 24 hours.&nbsp;</li>\r\n</ul>\r\n\r\n<h3><a name=\"outbound-sync-nbsp-for-resilient-cloud\" id=\"outbound-sync-nbsp-for-resilient-cloud\"></a>Outbound Sync&nbsp;for Resilient Cloud</h3>\r\n\r\n<div>\r\n<p>Resilient Cloud for POS is a feature that allows POS device to perform certain POS and Backoffice operations even when connectivity to central Cloud Services is unavailable for whatever reason, by maintaining a local subset of components on the Resilient Cloud local &quot;edge&quot; server.</p>\r\n\r\n<p>Outbound sync is the process where data from local Resilient Cloud server is moved to the Central Cloud server, to keep it up to&nbsp;date in a single source.&nbsp; This is applicable to only transactional data, and&nbsp;takes place only if transactions are created in edge server and when it is able to connect with the central server.&nbsp; For this purpose, a scheduler is provided that pushes Order and BackOffice transactions to the central server, at a predefined interval.</p>\r\n\r\n<p>When a transaction is created in offline&nbsp;and later synced with the Central Server, the <code>CREATED_TIMESTAMP</code> and <code>UPDATED_TIMESTAMP</code> displayed on the Central Server reflect the time the Central Server received the transaction, not the original time the transaction was created in offline.</p>\r\n\r\n<h4><a name=\"outbound-sync-process-orders\" id=\"outbound-sync-process-orders\"></a>Outbound Sync Process- Orders</h4>\r\n</div>\r\n\r\n<p><strong>Step I: From the local Resilient Cloud server:</strong></p>\r\n\r\n<ol>\r\n\t<li>A scheduled job runs at a fixed interval on the edge server.</li>\r\n\t<li>The actual execution takes place only if it is able to contact the central server. Else, no action takes place.</li>\r\n\t<li>As part of the execution, this scheduler fetches the data from local Order Database, in ascending order of creation.&nbsp; Sends in succession to the central server for persistence by calling save order API.</li>\r\n\t<li>Since the Orders created during Resilient Cloud&nbsp;mode do not require any further process within the central Order component, the sync process sets the following transient fields, which are used by Order to prevent further actions.\r\n\t<ul style=\"margin-top: 0px; margin-left: 0px;\">\r\n\t\t<li>AlreadyPriced=true</li>\r\n\t\t<li>AlreadyTaxed=true</li>\r\n\t\t<li>IsAlreadyReturnFeeApplied=true</li>\r\n\t</ul>\r\n\t</li>\r\n\t<li>Different variations of orders and related payment are synced.&nbsp;\r\n\t<ul style=\"margin-bottom: 0px; margin-left: 0px;\">\r\n\t\t<li>Orders- Sale and Returns, tendered using cash and/or credit card.&nbsp;&nbsp;</li>\r\n\t\t<li>Orders- Incomplete- In progress</li>\r\n\t\t<li>Orders- Incomplete- Abandoned: Tendered and Non Tendered</li>\r\n\t\t<li>Orders - Suspended</li>\r\n\t</ul>\r\n\t</li>\r\n</ol>\r\n\r\n<div class=\"info\"><strong>Note</strong>: Back Office updates tied to the order(s) are not synced along with orders. As they are independent, they are handled via the&nbsp;<a href=\"/resilientcloud_process$Outbound Sync - Backoffice\">Back Office sync</a> process.</div>\r\n\r\n<div class=\"info\"><strong>Note:</strong> Order sync to central server is driven by the template.&nbsp; Hence, Order and payment data is exported.&nbsp; Other details like Audit information is included.</div>\r\n\r\n<p style=\"margin-top: 10px; margin-bottom: 0px; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;\"><strong>Step II: Within Central Server</strong></p>\r\n\r\n<ol>\r\n\t<li>Validate and persist the Order.</li>\r\n\t<li>Send the message back to the local Resilient Cloud&nbsp;based on the result.&nbsp;&nbsp;</li>\r\n\t<li>Generate events for Sales Posting, TLog, Inventory&nbsp;</li>\r\n</ol>\r\n\r\n<p id=\"EdgeOutboundSync-FunctionalDocument-Step3:WithinEdgeServer\" style=\"margin: 20px 0px 0px; padding: 0px; color: rgb(51, 51, 51); font-size: 14px; font-weight: 700; line-height: 1.42857; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;\"><span style=\"font-size:12px;\"><span style=\"font-family:Arial,Helvetica,sans-serif;\">Step III: Within Edge Server</span></span></p>\r\n\r\n<ol>\r\n\t<li>\r\n\t<p>Once the message is received from Cental server, one of the following can happen, based on the response data.</p>\r\n\t</li>\r\n</ol>\r\n\r\n<ul style=\"margin-left: 80px;\">\r\n\t<li>Delete the Order and Payment data, if the order is successfully persisted in central server.</li>\r\n\t<li>If the response from the central is not successful, the local data does not get cleared.&nbsp; An error message is logged.</li>\r\n</ul>\r\n\r\n<div class=\"info\"><strong>Note</strong>: Cleaning up&nbsp;Edge data is independent on Order generating events for other components.</div>\r\n\r\n<h5><a name=\"process-flow-outbound-sync-orders-nbsp\" id=\"process-flow-outbound-sync-orders-nbsp\"></a><big>Process Flow: Outbound Sync - Orders&nbsp;</big></h5>\r\n\r\n<p><img height=\"1200\" src=\"https://dzf8vqv24eqhg.cloudfront.net/userfiles/4665/7671/ckfinder/images/orderOutboundSyncProcess.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9kemY4dnF2MjRlcWhnLmNsb3VkZnJvbnQubmV0L3VzZXJmaWxlcy80NjY1Lzc2NzEvY2tmaW5kZXIvaW1hZ2VzL29yZGVyT3V0Ym91bmRTeW5jUHJvY2Vzcy5wbmciLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NTQ3NTIxMzJ9fX1dfQ__&Signature=SN4nPdJpdXAQbLGZ7JhdL~2dONl-rT8-Er8QYgImi9H9xv~zkFxCXXjR7edBWZUM3uEi99KEeN~c7ZsauG9b5yBkMlYHMvm77ObvZLMZ0AYbvBKbYoRGC03NzO15aq87wkpAPhJ4uRT3vnYD18sAwGQGfZxtcRwIEGaO1IqNT6SY~-z9tOt6hJ1FAKbtZJNgnpHVVgjNCGAXiMKwu6ZrhTUGkL4KLgN9SUmzL-oNM-i1Wgf15bkdbJu02OrhqUwIuwSit19E~YIhxlvFHMBaFKclqhkWAJYgu5DajZC8ofnGUZQrkykCJP9MsK0PPofbaL7o8Sw0CN6MEgodilt6Qw__&Key-Pair-Id=K2TK3EG287XSFC\" width=\"431\" /></p>\r\n\r\n<h5><a name=\"alternate-flow\" id=\"alternate-flow\"></a><big>Alternate Flow</big></h5>\r\n\r\n<p><strong>Concurrency or Orders in progress</strong>: This is the case where the store associate is in middle of creating a transaction and scheduler picks the same order to sync to the central server.&nbsp; Since there is no mechanism to differentiate this and avoid being synced along with confirmed orders, a delay is introduced; which is a&nbsp;configurable value.&nbsp; With this, the outbound sync process picks the confirmed orders without checking this configuration.&nbsp; In case the order is not confirmed, system compares the current time with creation time plus the delay.&nbsp; If it is less, skips the order being synced; if equal or greater, the unconfirmed order is picked for the outbound sync purpose.</p>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p class=\"info\"><strong>Note on Outbound Sync Properties:</strong><br />\r\n<br />\r\n<strong>WAIT_TIME_CONFIRMED_ORDERS_SYNC</strong>: This property is for confirmed orders, which will wait for 15 minutes by default before syncing to the central server. Currently, the default time is 15 minutes, which is configurable.&nbsp;<br />\r\n<br />\r\n<strong>WAIT_TIME_UNCONFIRMED_ORDERS_SYNC</strong>: This property is for unconfirmed, post-voided, and canceled orders, which will wait for 30 minutes by default before syncing to the central server.&nbsp;Currently, the default time is 30&nbsp;minutes, which is configurable.&nbsp;</p>\r\n\r\n<h3><a name=\"backoffice-process\" id=\"backoffice-process\"></a>Backoffice Process</h3>\r\n\r\n<h4><a name=\"backoffice-in-resilient-cloud-nbsp-mode\" id=\"backoffice-in-resilient-cloud-nbsp-mode\"></a>BackOffice in Resilient Cloud&nbsp;mode</h4>\r\n\r\n<p>BackOffice would be available&nbsp;in Resilient Cloud &quot;edge&quot; mode when the central is not reachable from stores network.&nbsp;This is achieved by bringing the&nbsp;backoffice component&nbsp;up locally along with other components required for&nbsp;POS&nbsp;solution. All backoffice&nbsp;operations will be supported in edge mode when backoffice&nbsp;is running locally in store apart from viewing of backoffice&nbsp;reports. There are certain key information which stands apart when store is running in edge mode, check below.&nbsp;</p>\r\n\r\n<ul>\r\n\t<li>BackOffice operations from central will be scheduled to sync to edge server (operations such as Store Open and Till Open), we would not want the retailers to have to do the same operations again after falling back to Resilient Cloud mode to have a seamless experience.</li>\r\n\t<li>Users will be able to perform all backoffice operations in local Resilient Cloud mode (Store Open, Store Close, Till Open, Till Close, Till Disengage, Till Reconcile, Bank Deposit)</li>\r\n\t<li>Viewing the SCI&nbsp;reports for backoffice&nbsp;would be restricted in Resilient Cloud mode.</li>\r\n\t<li>All backoffice operation perform in Resilient Cloud mode will be synced to central as part of the Outbound Sync process.</li>\r\n\t<li>Auto Store Close operation on central checks for outbound sync status on local server before closing the store. Only when the count for order and backoffice&nbsp;to be synced to central is zero, auto store close will be performed on central.</li>\r\n</ul>\r\n\r\n<h4><a name=\"inbound-sync-from-central-cloud-to-local-resilient-cloud\" id=\"inbound-sync-from-central-cloud-to-local-resilient-cloud\"></a>Inbound Sync from Central Cloud to local Resilient Cloud</h4>\r\n\r\n<p>Backoffice&nbsp;transaction need to be transferred from central to local&nbsp;servers. It is critical to sync backoffice&nbsp;operations&nbsp;at certain schedule interval to keep the edge server with latest updates. This helps the retailers to fall back to local server and continue with sale transaction instead&nbsp;of repeating the start of day transaction,&nbsp;and also keeps the tills&nbsp;updated.</p>\r\n\r\n<ul>\r\n\t<li>Each store&#39;s edge server will have a scheduler running at scheduled intervals. These schedulers make calls to central and fetch backoffice&nbsp;transaction during that day.</li>\r\n\t<li>Only store open and till open backoffice transactions will be pulled from central to edge server.</li>\r\n\t<li>For store open operation, the storeOps&nbsp;entity will be updated with data from central server.</li>\r\n\t<li>For till open operation, all tills in open status are updated with appropriate data and defaulting state to available.&nbsp;</li>\r\n</ul>\r\n\r\n<h4><a name=\"outbound-sync-process-nbsp-back-office-transactions\" id=\"outbound-sync-process-nbsp-back-office-transactions\"></a><a id=\"Outbound Sync - Backoffice\" name=\"Outbound Sync - Backoffice\"></a>Outbound Sync Process-&nbsp;Back Office Transactions</h4>\r\n\r\n<p><strong>Step I: From local Resilient Cloud server:</strong></p>\r\n\r\n<ol>\r\n\t<li>A scheduled job runs at a fixed interval on the local server.</li>\r\n\t<li>The actual execution takes place only if it is able to contact the central. Else, no action takes place.</li>\r\n\t<li>As part of the execution, this scheduler fetches the data from local Back Office transaction entity.</li>\r\n\t<li>Picks transactions in ascending order of creation date and time.&nbsp; Sends in succession to the central for persistence by calling relevant API.</li>\r\n</ol>\r\n\r\n<p><strong>Step II: Within Central Server:</strong></p>\r\n\r\n<ol>\r\n\t<li>All the transaction persisted in&nbsp;backOfficeTransaction gets synced.&nbsp;However, store and till operations are&nbsp;handled differently to avoid duplications.&nbsp;&nbsp;While syncing the following operation type, checks if there exists a transaction already, for the same store and date combination.&nbsp;If yes, skips syncing.&nbsp;Transaction originally created in central sever remains as is, the one in the local Resilient Cloud&nbsp;is deleted.\r\n\t<ul style=\"margin-top: 0px; margin-left: 0px;\">\r\n\t\t<li>\r\n\t\t<p style=\"margin-bottom: 0px;\">STORE_OPEN</p>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t<p style=\"margin-bottom: 0px;\">TILL_OPEN</p>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t<p style=\"margin-bottom: 0px;\">TILL_CLOSE</p>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t<p style=\"margin-bottom: 0px;\">TILL_RECONCILE</p>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t<p style=\"margin-bottom: 0px;\">AUTO_STORE_CLOSE</p>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t<p style=\"margin-bottom: 0px;\">STORE_CLOSE</p>\r\n\t\t</li>\r\n\t</ul>\r\n\t</li>\r\n\t<li>Except the above operation types, when local server sends individual Back Office transaction to central, an event is generated.&nbsp; This in turn updates other related tables.&nbsp; While persisting such transactions in central server, system skips all business validations.</li>\r\n\t<li>A response is sent to Edge confirming the result of the sync.</li>\r\n</ol>\r\n\r\n<p><strong>Step III:&nbsp;Within Edge Server</strong></p>\r\n\r\n<ol>\r\n\t<li>Once the message is received from central, one of the following can happen, based on the response data.\r\n\t<ul>\r\n\t\t<li>Delete the synced record from edge transaction entity, if it was successfully persisted in Central server or the transaction was skipped.</li>\r\n\t\t<li>If Resilient Cloud is not able to sync successfully, an error is logged.&nbsp; Corresponding transaction is not cleared from the local database.</li>\r\n\t</ul>\r\n\t</li>\r\n</ol>\r\n\r\n<h5><a name=\"process-flow-back-office\" id=\"process-flow-back-office\"></a><big>Process Flow: Back Office</big></h5>\r\n\r\n<p><img height=\"640\" src=\"https://dzf8vqv24eqhg.cloudfront.net/userfiles/4665/7671/ckfinder/images/backofficeOutboundProcess1.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9kemY4dnF2MjRlcWhnLmNsb3VkZnJvbnQubmV0L3VzZXJmaWxlcy80NjY1Lzc2NzEvY2tmaW5kZXIvaW1hZ2VzL2JhY2tvZmZpY2VPdXRib3VuZFByb2Nlc3MxLnBuZyIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc1NDc1MjEzMn19fV19&Signature=ezkuJ~dH65~SJGkYxnmHzMBaOi0sAxbV3VRxbdi4azXyt2ekH4DVSZxPPxDxkSddcIoEY1XC0i5pxMVjZgGjEbYnzYwrX3u7FUomVDxnlILlDMBzNU9FDOOVQJ1QM5krQIlR4p61OfTOjqSaGbSICMou-T-fYphGG8gN1Uz3i9uWPD8RCHOLXL5UfDM94Xt0o4ksHMoPKsNa5smuD3no234OEF9CcUd3OFphGl5luKdSDrCGH4cr2mCzzav6P~2a6SSNo2lLj43j8mbrGf7HhRWbYrSdBIPS2c3y5SUo6zsgNPdEGtbfeu5iKY0s3s2iLays0c2C~X-zkEvyJ0j7Qg__&Key-Pair-Id=K2TK3EG287XSFC\" width=\"1454\" /></p>\r\n\r\n<h3><a name=\"edge-health-dashboard-and-servers\" id=\"edge-health-dashboard-and-servers\"></a>Edge Health Dashboard and Servers</h3>\r\n\r\n<p>The Edge Dashboard provides insight&nbsp;into the overall health/status of each edge server within an organization.&nbsp; The data shown on the dashboard is for exception based reporting to allow the user a quick glance into any issues that may be occurring.&nbsp; This data will refresh every minute to show the most up to date data.</p>\r\n\r\n<h4><a name=\"modules\" id=\"modules\"></a>Modules</h4>\r\n\r\n<p>There are 5 reporting modules within the dashboard.</p>\r\n\r\n<ol>\r\n\t<li>No Heartbeat: Displays total number of servers with no heartbeat as well as store where server is located</li>\r\n\t<li>Unprocessed Transactions: Displays total number of unprocessed transactions as well as the unprocessed transaction count for each location</li>\r\n\t<li>Base Code Version: Displays the base code versions currently installed on all edge servers, as well as the number of stores running on the corresponding version</li>\r\n\t<li>Installation Status: Displays the number of failed installations for all servers</li>\r\n\t<li>Inbound Sync Status: Displays exception based statuses for all servers - Failed, In progress over threshold and Consecutive failures</li>\r\n</ol>\r\n\r\n<ul>\r\n\t<li>Users can choose to &quot;view all&quot; and will be brought to the Edge Servers screen. This screen displays all edge servers by location along with additional details on each of the 5 modules.&nbsp;</li>\r\n\t<li>Users can also choose to select a single line item from each of the module lists, and will be brought to the Edge Servers view with a pre-applied filter which corresponds to the module from which they entered.&nbsp; (Ex: Inbound Sync status = Failed. When user taps on this row they will be brought to the server list screen. The pre-applied filter will show only those stores whose inbound sync has failed.) Users can remove the filter at which point the list view will be refreshed.&nbsp;</li>\r\n\t<li>Users can also drill down even further to get additional information on each module by selecting one or multiple servers from the list and selecting the details option.</li>\r\n</ul>\r\n\r\n<h3><a name=\"edge-server-logging\" id=\"edge-server-logging\"></a>Edge Server Logging</h3>\r\n\r\n<p>As per the Edge Server Logging the system captures all the logs generated by Tomcat and all the other component&rsquo;s logs. These logs are archived from the Edge and pushed to Amazon S3 or Google Cloud Storage.</p>\r\n\r\n<p>These Edge Server Log Files are uploaded as zip files to the S3 bucket and&nbsp;are not encrypted. These log files can be downloaded by the support user as and when required.</p>\r\n\r\n<p><b>Log file location: </b>&nbsp;The log files can be found at the location:</p>\r\n\r\n<p>S3 bucket + Namespace + Store Id + Date</p>\r\n\r\n<p>Namespace is edge-server-log</p>\r\n\r\n<p>Store ID is the heartbeatKeyProperties.getLocationId()</p>\r\n\r\n<p>Date format is YYYYMMDD ex. 20190830</p>\r\n\r\n<p><b>Ex: </b>manh-stack-manhdz07/edge-server-log/tm-demo-us:80228-1448/20190905/edge_server_log_tm-demo-us__80228-1448_0_20190920183210.zip</p>\r\n\r\n<p><b>Scheduled time for log capturing:</b> The log&nbsp;is captured by a scheduled job which runs at 6AM daily. This is the local time of the Edge Server time zone. The config file stores the time of the run for this job. There is no on/off feature for this log.</p>\r\n\r\n<p>In case there is any failure in capturing the logs, there is no notification which is triggered. The only way to check is from the S3 bucket or the Backoffice logs.</p>\r\n\r\n<p>Currently these log files are retained for 7 days. However, based on the business requirement this can be changed to 30 days.</p>\r\n\r\n<p>Below are the four primary processes involved in the Edge Server Logging:</p>\r\n\r\n<ol>\r\n\t<li><b>Delete Temporary Directory</b> - Temporary directory contain previous zipped file: This is the zip file which was from packing the tomcat logs directory called zip_temp.</li>\r\n\t<li><b>Pack</b> - This step zipped all the log files in the log directory defined in the application-edge.yml. It creates a zipped file which is saved at the local tomcat zip_temp directory. The zipped filename convention is edge + store id + timestamp (&quot;yyyyMMddHHmmss&quot;)</li>\r\n\t<li><b>Upload</b> - The upload procedure will rely on the Core API&#39;s object store functionality. The object store needs three attributes. Namespace is &quot;edge-server-log&quot;. exportId is the store ID + timestamp (&quot;yyyyMMdd&quot;). file object is the zipped file reference. Below is the sample S3 bucket structure.&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\r\n\t<ul>\r\n\t\t<li>The bucket: manh-stack-manhdz07.</li>\r\n\t\t<li>The namespace: edge-server-log.</li>\r\n\t\t<li>The Store Id: tm-demo-us:80228-1448 and tm-demo-us: 80228:1558.</li>\r\n\t\t<li>Sequence: default 0, this is reserved for multiple edge servers.</li>\r\n\t\t<li>The uploaded date: 20190905, 20190906 ... etc.</li>\r\n\t\t<li>The zip file uploaded: edge_server_log_tm-demo-us__80228-1448_0_20190920183210.zip&nbsp;&nbsp;</li>\r\n\t</ul>\r\n\t</li>\r\n\t<li><b>Delete</b> &ndash;&nbsp;\r\n\t<ul>\r\n\t\t<li>Delete Serial Rolling files: There may be multiple log files which have file extension like .1, .2 etc. If the rolling files changed during the process, the process will keep the main logs and log.1 file otherwise only leave the main log files</li>\r\n\t\t<li>Delete Dated Rolling files: The web server generate some log files which used a date stamp in the file name. So, the current date file or the latest file will be left after the deletion process.</li>\r\n\t</ul>\r\n\t</li>\r\n</ol>\r\n\r\n<h3><a name=\"services\" id=\"services\"></a>Services</h3>\r\n\r\n<p>The relevant APIs are listed.&nbsp; Refer to API documentation for additional details on&nbsp;each service.</p>\r\n\r\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 946px;\">\r\n\t<thead>\r\n\t\t<tr>\r\n\t\t\t<th scope=\"col\" style=\"width: 168px;\">Service</th>\r\n\t\t\t<th scope=\"col\" style=\"width: 123px;\">Component</th>\r\n\t\t\t<th scope=\"col\" style=\"width: 220px;\">Group</th>\r\n\t\t\t<th scope=\"col\" style=\"width: 398px;\">Service Endpoint</th>\r\n\t\t</tr>\r\n\t</thead>\r\n\t<tbody>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\">Config&nbsp;Director</td>\r\n\t\t\t<td style=\"width: 120px;\">config</td>\r\n\t\t\t<td style=\"width: 217px;\">Get Export Id</td>\r\n\t\t\t<td style=\"width: 395px;\">cfg/api/cfg/configDirector/export</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\">Config&nbsp;Director</td>\r\n\t\t\t<td style=\"width: 120px;\">config</td>\r\n\t\t\t<td style=\"width: 217px;\">Post Import API</td>\r\n\t\t\t<td style=\"width: 395px;\">cfg/api/cfg/configDirector/import</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\">Config<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">&nbsp;Director</span></td>\r\n\t\t\t<td style=\"width: 120px;\"><span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">conf</span><span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">ig</span></td>\r\n\t\t\t<td style=\"width: 217px;\">get latest Export Id</td>\r\n\t\t\t<td style=\"width: 395px;\">cfg<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">/</span>api<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">/</span>cfg<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">/</span>configDirector<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">/export/{latestExportId}</span></td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\">Config<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif; background-color: rgb(230, 230, 230);\">&nbsp;Director</span></td>\r\n\t\t\t<td style=\"width: 120px;\"><span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif; background-color: rgb(230, 230, 230);\">config</span></td>\r\n\t\t\t<td style=\"width: 217px;\">get latest Import Id</td>\r\n\t\t\t<td style=\"width: 395px;\">cfg<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif; background-color: rgb(230, 230, 230);\">/</span>api<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif; background-color: rgb(230, 230, 230);\">/</span>cfg<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif; background-color: rgb(230, 230, 230);\">/</span>configDirector<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif; background-color: rgb(230, 230, 230);\">/import/{latestimportId}</span></td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\"><span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">Component&nbsp;</span>Config</td>\r\n\t\t\t<td style=\"width: 120px;\"><span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">conf</span><span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">ig</span></td>\r\n\t\t\t<td style=\"width: 217px;\">Post Diff API</td>\r\n\t\t\t<td style=\"width: 395px;\">cfg<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">/</span>api<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">/</span>cfg<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">/</span>configDirector<span style=\"font-family: &quot;Open Sans&quot;, arial, sans-serif;\">/Diff</span></td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\">Edge</td>\r\n\t\t\t<td style=\"width: 120px;\">backoffice</td>\r\n\t\t\t<td style=\"width: 217px;\">Upload Log Central&nbsp;(only available on edge not on central)</td>\r\n\t\t\t<td style=\"width: 395px;\">/api/backoffice/edge/uploadLogCentral</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\">Central Dashboard Config</td>\r\n\t\t\t<td style=\"width: 120px;\">backoffice</td>\r\n\t\t\t<td style=\"width: 217px;\">get dashboard layout</td>\r\n\t\t\t<td style=\"width: 395px;\">/api/backoffice/dashboard/layout</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\">Central Dashboard Config</td>\r\n\t\t\t<td style=\"width: 120px;\">backoffice</td>\r\n\t\t\t<td style=\"width: 217px;\">get dashboard module information</td>\r\n\t\t\t<td style=\"width: 395px;\">/api/backoffice/dashboard/modules</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\">Central Dashboard Config</td>\r\n\t\t\t<td style=\"width: 120px;\">backoffice</td>\r\n\t\t\t<td style=\"width: 217px;\">filter edge server list</td>\r\n\t\t\t<td style=\"width: 395px;\">/api/backoffice/dashboard/modules/filter</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 165px;\">Central Inbound Sync Alerts</td>\r\n\t\t\t<td style=\"width: 120px;\">backoffice</td>\r\n\t\t\t<td style=\"width: 217px;\">list the inbound stats acros stores</td>\r\n\t\t\t<td style=\"width: 395px;\">/stats/status/inboundSync</td>\r\n\t\t</tr>\r\n\t</tbody>\r\n</table>\r\n\r\n<p>&nbsp;</p>\r\n\r\n\t  </div>\r\n </div>\r\n <div id=\"ui-page-fb-wrap\"></div>\r\n <div class=\"hiq-footer-wrap\">\r\n    \r\n                \r\n  </div>\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n\r\n\r\n",
  "content_length": 36176,
  "scraped_at": "2025-08-09T22:03:53.061522",
  "content_clean": "Home ››Manhattan Active® Omni››Store››Process & Configuration Guides››Point of Sale››POS Classic Guides››Resilient Cloud for POS››Process ››Resilient cloud process Resilient Cloud Process Inbound Sync for Resilient CloudExport Process - Creating the Inbound Sync Bundle at CentralImport Process - Downloading and Consuming the Inbound Sync Bundle at EdgeInbound Job WorkflowInbound Sync Processing Errors - AlertsOutbound Sync for Resilient CloudOutbound Sync Process- OrdersProcess Flow: Outbound Sync - Orders Alternate FlowBackoffice ProcessBackOffice in Resilient Cloud modeInbound Sync from Central Cloud to local Resilient CloudOutbound Sync Process- Back Office TransactionsProcess Flow: Back OfficeEdge Health Dashboard and ServersModulesEdge Server LoggingServices Inbound Sync for Resilient Cloud Resilient Cloud for POS is a feature that allows POS device to perform certain POS and Backoffice operations even when connectivity to central Cloud Services are unavailable for whatever reason, by maintaining a local subset of components on the edge server. The Resilient Cloud \"edge\" server is designed to run in the store, isolated from the central cloud server. When deployed and connected, it needs to keep data such as configurations and master data available via periodic import from the central server through a scheduled inbound sync process. This process can be included as the very first step or as part of the final step in the installation of the local server. For this requirement, we need to download the config and master data from the central server down to the store server. We will be leveraging the component-config functionality to perform these actions. These actions need to be scheduled to be exported as form of packages/files which can be consumed by store server. During or after deploying the Resilient Cloud server on store, it is a pre-requisite to get the config and master data to the store server before using the resilient cloud server to perform any transaction. Export process will get the config and master data from the central and put it into an object repository. Store server can reach out to this repository to get the latest export file and import these files back to the resilient cloud server after performing a delta which is termed as different from the previous successful import jobs. Export Process - Creating the Inbound Sync Bundle at Central \"Export\" is the process by which data is packaged and posted from the Central Cloud server for consumption by the edge server. Export process is triggered from Edge when the Inbound sync process runs. This job invokes an export API which will export the config and master data as zip file into a configured S3 bucket. The detailed flow is given below: Configure the S3 bucket details as described in the Resilient Cloud Configuration Guide. This job invokes the export API, export API uses the orgID from context or from the input details provided while calling the API which are (OrgID, Profile Purposes and Components) profile purpose and components are optional fields. The export API should know the qualifier as the input fields (The environment from which the data needs to be exported) Once the export API is executed, a zip file is uploaded to the S3 bucket and exportId record is saved on the Export_master entity on config component for further reference of this export job. Import Process - Downloading and Consuming the Inbound Sync Bundle at Edge Import or Inbound process is invoked through a scheduler job from the backoffice component running on resilient cloud. This job invokes an API to insert the diff data to the resilient cloud from where the job was triggered. The detailed flow is given below: Get the latest exportId from the central server Fetch the Last successful import record from the resilient cloud and get the corresponding exportId reference (which is the previous successful exportId) If latest exportId fetched from central & previous exportId on resilient cloud does not match, then it checks whether the data for current exportId is available in local resilient cloud space. If no, it pulls the data from S3 bucket. Once the export zip file is identified, call DIFF API in store server to generate the delta comparing current & previous exports. Call the edge import API to import the delta data. Remove the delta data from the local directory. NOTE:  If any config/master data is deleted in central server, then the daily/scheduled inbound sync job will now remove the deleted data on the edge server automatically. This is controlled by \"configdirector.import.deleteEntity.enable\" flag on configuration component and by default is set as TRUE. It will allow user's to reflect deleted data from central to be synced and removed from edge. Note that any fresh resilient cloud server installation or upgrade always completely refreshes or creates a new DB from scratch. Inbound Job Workflow Inbound Sync Processing Errors - Alerts During this process, it's possible that the Inbound sync process is not completed or fails.  This can be due to multiple reasons like: Failure during the actual import of data into component entities The master and config data failed to sync Sync process aborted due to timeout. Such failures generate alert messages which are posted to the Central server and can be distributed to key support users via email. This provides a way to monitor the health of this process over various stores centrally without forcing user to remotely access each separate location's Edge server. It is also significant that inbound sync process logs are also captured at the Central server to ensure it is available for debugging purpose. This is made possible by tracing every step involved in the sync process and posting to central server. These trace details are further used to exhibit the data on Edge Management dashboard or to publish the alerts. How is the data for Alerts obtained? A new stats rest endpoints is exposed from Backoffice to provide the stats for InboundSync Job Status across the stores: /stats/status/inboundSync – This API provides the count of inboundSync jobs the last configured interval across stores. As part of this, three different stats are added to this metric: Failed: Number of EdgeServers for which inboundsync is failing.  That is the count of EdgeServers From EdgeEventSummary where InboundFailureCount > 0 DelayedCompletion: If InboundSync is running beyond threshold time, count of EdgeServers from EdgeEventTrace for event type InboundSync which is Started before thresholdTime and refresh Heartbeat is active. Skipped: If Inbound sync is not triggered for the last 24 hours. Outbound Sync for Resilient Cloud Resilient Cloud for POS is a feature that allows POS device to perform certain POS and Backoffice operations even when connectivity to central Cloud Services is unavailable for whatever reason, by maintaining a local subset of components on the Resilient Cloud local \"edge\" server. Outbound sync is the process where data from local Resilient Cloud server is moved to the Central Cloud server, to keep it up to date in a single source.  This is applicable to only transactional data, and takes place only if transactions are created in edge server and when it is able to connect with the central server.  For this purpose, a scheduler is provided that pushes Order and BackOffice transactions to the central server, at a predefined interval. When a transaction is created in offline and later synced with the Central Server, the CREATED_TIMESTAMP and UPDATED_TIMESTAMP displayed on the Central Server reflect the time the Central Server received the transaction, not the original time the transaction was created in offline. Outbound Sync Process- Orders Step I: From the local Resilient Cloud server: A scheduled job runs at a fixed interval on the edge server. The actual execution takes place only if it is able to contact the central server. Else, no action takes place. As part of the execution, this scheduler fetches the data from local Order Database, in ascending order of creation.  Sends in succession to the central server for persistence by calling save order API. Since the Orders created during Resilient Cloud mode do not require any further process within the central Order component, the sync process sets the following transient fields, which are used by Order to prevent further actions. AlreadyPriced=true AlreadyTaxed=true IsAlreadyReturnFeeApplied=true Different variations of orders and related payment are synced. Orders- Sale and Returns, tendered using cash and/or credit card. Orders- Incomplete- In progress Orders- Incomplete- Abandoned: Tendered and Non Tendered Orders - Suspended Note: Back Office updates tied to the order(s) are not synced along with orders. As they are independent, they are handled via the Back Office sync process. Note: Order sync to central server is driven by the template.  Hence, Order and payment data is exported.  Other details like Audit information is included. Step II: Within Central Server Validate and persist the Order. Send the message back to the local Resilient Cloud based on the result. Generate events for Sales Posting, TLog, Inventory Step III: Within Edge Server Once the message is received from Cental server, one of the following can happen, based on the response data. Delete the Order and Payment data, if the order is successfully persisted in central server. If the response from the central is not successful, the local data does not get cleared.  An error message is logged. Note: Cleaning up Edge data is independent on Order generating events for other components. Process Flow: Outbound Sync - Orders Alternate Flow Concurrency or Orders in progress: This is the case where the store associate is in middle of creating a transaction and scheduler picks the same order to sync to the central server.  Since there is no mechanism to differentiate this and avoid being synced along with confirmed orders, a delay is introduced; which is a configurable value.  With this, the outbound sync process picks the confirmed orders without checking this configuration.  In case the order is not confirmed, system compares the current time with creation time plus the delay.  If it is less, skips the order being synced; if equal or greater, the unconfirmed order is picked for the outbound sync purpose. Note on Outbound Sync Properties: WAIT_TIME_CONFIRMED_ORDERS_SYNC: This property is for confirmed orders, which will wait for 15 minutes by default before syncing to the central server. Currently, the default time is 15 minutes, which is configurable. WAIT_TIME_UNCONFIRMED_ORDERS_SYNC: This property is for unconfirmed, post-voided, and canceled orders, which will wait for 30 minutes by default before syncing to the central server. Currently, the default time is 30 minutes, which is configurable. Backoffice Process BackOffice in Resilient Cloud mode BackOffice would be available in Resilient Cloud \"edge\" mode when the central is not reachable from stores network. This is achieved by bringing the backoffice component up locally along with other components required for POS solution. All backoffice operations will be supported in edge mode when backoffice is running locally in store apart from viewing of backoffice reports. There are certain key information which stands apart when store is running in edge mode, check below. BackOffice operations from central will be scheduled to sync to edge server (operations such as Store Open and Till Open), we would not want the retailers to have to do the same operations again after falling back to Resilient Cloud mode to have a seamless experience. Users will be able to perform all backoffice operations in local Resilient Cloud mode (Store Open, Store Close, Till Open, Till Close, Till Disengage, Till Reconcile, Bank Deposit) Viewing the SCI reports for backoffice would be restricted in Resilient Cloud mode. All backoffice operation perform in Resilient Cloud mode will be synced to central as part of the Outbound Sync process. Auto Store Close operation on central checks for outbound sync status on local server before closing the store. Only when the count for order and backoffice to be synced to central is zero, auto store close will be performed on central. Inbound Sync from Central Cloud to local Resilient Cloud Backoffice transaction need to be transferred from central to local servers. It is critical to sync backoffice operations at certain schedule interval to keep the edge server with latest updates. This helps the retailers to fall back to local server and continue with sale transaction instead of repeating the start of day transaction, and also keeps the tills updated. Each store's edge server will have a scheduler running at scheduled intervals. These schedulers make calls to central and fetch backoffice transaction during that day. Only store open and till open backoffice transactions will be pulled from central to edge server. For store open operation, the storeOps entity will be updated with data from central server. For till open operation, all tills in open status are updated with appropriate data and defaulting state to available. Outbound Sync Process- Back Office Transactions Step I: From local Resilient Cloud server: A scheduled job runs at a fixed interval on the local server. The actual execution takes place only if it is able to contact the central. Else, no action takes place. As part of the execution, this scheduler fetches the data from local Back Office transaction entity. Picks transactions in ascending order of creation date and time.  Sends in succession to the central for persistence by calling relevant API. Step II: Within Central Server: All the transaction persisted in backOfficeTransaction gets synced. However, store and till operations are handled differently to avoid duplications.  While syncing the following operation type, checks if there exists a transaction already, for the same store and date combination. If yes, skips syncing. Transaction originally created in central sever remains as is, the one in the local Resilient Cloud is deleted. STORE_OPEN TILL_OPEN TILL_CLOSE TILL_RECONCILE AUTO_STORE_CLOSE STORE_CLOSE Except the above operation types, when local server sends individual Back Office transaction to central, an event is generated.  This in turn updates other related tables.  While persisting such transactions in central server, system skips all business validations. A response is sent to Edge confirming the result of the sync. Step III: Within Edge Server Once the message is received from central, one of the following can happen, based on the response data. Delete the synced record from edge transaction entity, if it was successfully persisted in Central server or the transaction was skipped. If Resilient Cloud is not able to sync successfully, an error is logged.  Corresponding transaction is not cleared from the local database. Process Flow: Back Office Edge Health Dashboard and Servers The Edge Dashboard provides insight into the overall health/status of each edge server within an organization.  The data shown on the dashboard is for exception based reporting to allow the user a quick glance into any issues that may be occurring.  This data will refresh every minute to show the most up to date data. Modules There are 5 reporting modules within the dashboard. No Heartbeat: Displays total number of servers with no heartbeat as well as store where server is located Unprocessed Transactions: Displays total number of unprocessed transactions as well as the unprocessed transaction count for each location Base Code Version: Displays the base code versions currently installed on all edge servers, as well as the number of stores running on the corresponding version Installation Status: Displays the number of failed installations for all servers Inbound Sync Status: Displays exception based statuses for all servers - Failed, In progress over threshold and Consecutive failures Users can choose to \"view all\" and will be brought to the Edge Servers screen. This screen displays all edge servers by location along with additional details on each of the 5 modules. Users can also choose to select a single line item from each of the module lists, and will be brought to the Edge Servers view with a pre-applied filter which corresponds to the module from which they entered.  (Ex: Inbound Sync status = Failed. When user taps on this row they will be brought to the server list screen. The pre-applied filter will show only those stores whose inbound sync has failed.) Users can remove the filter at which point the list view will be refreshed. Users can also drill down even further to get additional information on each module by selecting one or multiple servers from the list and selecting the details option. Edge Server Logging As per the Edge Server Logging the system captures all the logs generated by Tomcat and all the other component’s logs. These logs are archived from the Edge and pushed to Amazon S3 or Google Cloud Storage. These Edge Server Log Files are uploaded as zip files to the S3 bucket and are not encrypted. These log files can be downloaded by the support user as and when required. Log file location:  The log files can be found at the location: S3 bucket + Namespace + Store Id + Date Namespace is edge-server-log Store ID is the heartbeatKeyProperties.getLocationId() Date format is YYYYMMDD ex. 20190830 Ex: manh-stack-manhdz07/edge-server-log/tm-demo-us:80228-1448/20190905/edge_server_log_tm-demo-us__80228-1448_0_20190920183210.zip Scheduled time for log capturing: The log is captured by a scheduled job which runs at 6AM daily. This is the local time of the Edge Server time zone. The config file stores the time of the run for this job. There is no on/off feature for this log. In case there is any failure in capturing the logs, there is no notification which is triggered. The only way to check is from the S3 bucket or the Backoffice logs. Currently these log files are retained for 7 days. However, based on the business requirement this can be changed to 30 days. Below are the four primary processes involved in the Edge Server Logging: Delete Temporary Directory - Temporary directory contain previous zipped file: This is the zip file which was from packing the tomcat logs directory called zip_temp. Pack - This step zipped all the log files in the log directory defined in the application-edge.yml. It creates a zipped file which is saved at the local tomcat zip_temp directory. The zipped filename convention is edge + store id + timestamp (\"yyyyMMddHHmmss\") Upload - The upload procedure will rely on the Core API's object store functionality. The object store needs three attributes. Namespace is \"edge-server-log\". exportId is the store ID + timestamp (\"yyyyMMdd\"). file object is the zipped file reference. Below is the sample S3 bucket structure. The bucket: manh-stack-manhdz07. The namespace: edge-server-log. The Store Id: tm-demo-us:80228-1448 and tm-demo-us: 80228:1558. Sequence: default 0, this is reserved for multiple edge servers. The uploaded date: 20190905, 20190906 ... etc. The zip file uploaded: edge_server_log_tm-demo-us__80228-1448_0_20190920183210.zip Delete – Delete Serial Rolling files: There may be multiple log files which have file extension like .1, .2 etc. If the rolling files changed during the process, the process will keep the main logs and log.1 file otherwise only leave the main log files Delete Dated Rolling files: The web server generate some log files which used a date stamp in the file name. So, the current date file or the latest file will be left after the deletion process. Services The relevant APIs are listed.  Refer to API documentation for additional details on each service. Service Component Group Service Endpoint Config Director config Get Export Id cfg/api/cfg/configDirector/export Config Director config Post Import API cfg/api/cfg/configDirector/import Config Director config get latest Export Id cfg/api/cfg/configDirector/export/{latestExportId} Config Director config get latest Import Id cfg/api/cfg/configDirector/import/{latestimportId} Component Config config Post Diff API cfg/api/cfg/configDirector/Diff Edge backoffice Upload Log Central (only available on edge not on central) /api/backoffice/edge/uploadLogCentral Central Dashboard Config backoffice get dashboard layout /api/backoffice/dashboard/layout Central Dashboard Config backoffice get dashboard module information /api/backoffice/dashboard/modules Central Dashboard Config backoffice filter edge server list /api/backoffice/dashboard/modules/filter Central Inbound Sync Alerts backoffice list the inbound stats acros stores /stats/status/inboundSync"
}