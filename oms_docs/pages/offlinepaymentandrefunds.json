{
  "success": true,
  "permalink": "offlinepaymentandrefunds",
  "title": "Offline Payment and Refunds",
  "content": "\r\n\r\n\r\n<div class=\"hiq-page-wrap\">\r\n<div class=\"hiq-t-wrap\">\r\n\t\t\r\n  \t  <div class=\"hiq-t \">\r\n\t\t\t\t<ul class=\"breadcrumbs\"><li><a class=\"breadcrumb-links\" hqid=\"1788908\"  href=\"/home\">Home</a></li> <li><span>&rsaquo;&rsaquo;</span><a hqid=\"3500940\" href=\"/omni\" class=\"breadcrumb-links\">Manhattan Active® Omni</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"3426481\" href=\"/store-3\" class=\"breadcrumb-links\">Store</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2158412\" href=\"/process-configuration-guides-3\" class=\"breadcrumb-links\">Process & Configuration Guides</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2158737\" href=\"/point-of-sale\" class=\"breadcrumb-links\">Point of Sale</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2225114\" href=\"/process-configuration-guides-4\" class=\"breadcrumb-links\">POS Classic Guides</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2342333\" href=\"/20.1-resilient-cloud-for-pos-draft\" class=\"breadcrumb-links\">Resilient Cloud for POS</a></li><li><span>&rsaquo;&rsaquo;</span><a hqid=\"2342335\" href=\"/process-guide\" class=\"breadcrumb-links\">Process</a></li><li> <span>››</span>Offline Payment and Refunds</li></ul>  \t\r\n\t\t<h2>Offline Payment and Refunds</h2>\r\n\r\n<p></p>\r\n\r\n<div class=\"info\"><ul><li><a href=\"/offlinepaymentandrefunds$overview\">Overview</a></li><li><a href=\"/offlinepaymentandrefunds$glossary\">Glossary</a></li><li><a href=\"/offlinepaymentandrefunds$process-flow-payments-tendering\">Process Flow: Payments/Tendering</a></li><li><a href=\"/offlinepaymentandrefunds$assumptions\">Assumptions</a></li><li><a href=\"/offlinepaymentandrefunds$handling-returns-and-refunds\">Handling returns and Refunds</a></li><li><a href=\"/offlinepaymentandrefunds$configurations\">Configurations</a></li></ul></div>\r\n\r\n<div>\r\n<h4><a name=\"overview\" id=\"overview\"></a>Overview</h4>\r\n</div>\r\n\r\n<p>While running Manhattan Active&trade; Point of Sale application in Resilient Cloud, there can be situations wherein&nbsp;a payment terminal / payment collecting device is unable to connect to payment systems to process tenders.&nbsp; As an alternate, transactions go through tendering without the actual approval from the payment system.&nbsp;This is subjected to the floor limit being met by the transaction. This is referred to as Store and Forward (SAF).&nbsp;In case the floor limit is not met, system prompts the user to go for voice authorization, if configured. This is applicable to return transactions too.</p>\r\n\r\n<p>Return transactions&nbsp;completed of SAF, might not be able to process the refunds, by contacting the payment processors automatically.&nbsp;In such situations, system provides the user, the ability to&nbsp;complete the transaction by going through additional step of reprocessing through override mechanism.</p>\r\n\r\n<h4><a name=\"glossary\" id=\"glossary\"></a>Glossary</h4>\r\n\r\n<ul>\r\n\t<li>Store and Forward (SAF):&nbsp; Ability to allow payment transactions to be stored on the payment terminal if they meet floor limit configured in the payment terminal.</li>\r\n\t<li>Voice Authorization: Process to get the authorization for the credit card tendering, in case the payment terminal is not able to contact the processors and SAF criteria is not met.&nbsp; In this case, store associate calls up the support, provides the card details and gets the response.&nbsp; If this is approved, an authorization code is also provided, which the store associate enters on the POS application.</li>\r\n\t<li>Floor limit: It is the maximum amount allowed per transaction or per day.&nbsp; If this criteria is not met, payment terminal does not create SAF transaction.&nbsp; Instead, prompts the user to proceed with voice authorization.</li>\r\n\t<li>SAF_NUM:&nbsp; It is the number returned, instead of CTROUTD/TROUTD, when transaction has been put&nbsp;under SAF.&nbsp;&nbsp;</li>\r\n</ul>\r\n\r\n<h4><a name=\"process-flow-payments-tendering\" id=\"process-flow-payments-tendering\"></a>Process Flow: Payments/Tendering</h4>\r\n\r\n<ul>\r\n\t<li>User swipes credit card on the terminal.&nbsp;&nbsp;</li>\r\n\t<li>Terminal tries to contact the payment system to get it processed.&nbsp; In case it goes successfully, SAF flow is not triggered.&nbsp; &nbsp;In case it does not go through, terminal saves the request in device SAF storage and compares the floor limit specified.\r\n\t<ul>\r\n\t\t<li>If the floor limit is met, saves within the terminal, provides the response with SAF number to POS application.</li>\r\n\t\t<li>In case the floor limit is not met, an error code is generated.&nbsp; POS application prompts the user to proceed with Voice Authorization, if configured.&nbsp; Else, cannot proceed with the current payment.</li>\r\n\t\t<li>Once Voice authorization is obtained, system moves it to SAF transactions storage&nbsp; Thus, payments with Voice Authorization too are treated similarly to offline payments under floor limit, which were stored in SAF.&nbsp; Both records have SAF numbers.</li>\r\n\t</ul>\r\n\t</li>\r\n\t<li>The response is saved in payment with Store and Forward number and capturedInEdgeMode=True</li>\r\n</ul>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p><img height=\"1200\" src=\"https://dzf8vqv24eqhg.cloudfront.net/userfiles/4665/7671/ckfinder/images/SAFAndVoiceAuth.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9kemY4dnF2MjRlcWhnLmNsb3VkZnJvbnQubmV0L3VzZXJmaWxlcy80NjY1Lzc2NzEvY2tmaW5kZXIvaW1hZ2VzL1NBRkFuZFZvaWNlQXV0aC5wbmciLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NTQ3NTQwNTd9fX1dfQ__&Signature=lwpN5MOjaKqHcczfXIUl-2rF5TyrDIiCVg6AdWWLA1YmqoP3g6E7WLUXFK4lPEJtc0bmdUAizmqKw3DWdN8xGypVldmmZVlXf~op2hHilw1c8wVZA~KJBD6VtvzYpEsDmYxDraqBve8-GCedX8UNTNTKi3-CDIg7jE19j058Q~G6PJ~2Aall3gkOQD-0AIZFLJ0XzRcpOgOSruMUfmmcqNqG2070HcELsXaa5jOZptkl1ZR6UHEl8w-k4VwM5lrSxkpWRyVeJ-imHrGO1hss2bGQxA0Ohh4EzKeqAExPIJ7yybOzNS7xFMZ6oZgWB2CJ~6O5VLgPOnXg1SVTRPpBdA__&Key-Pair-Id=K2TK3EG287XSFC\" style=\"width: 1305.99px; height: 1193.99px;\" width=\"1313\" /></p>\r\n\r\n<h4><a name=\"assumptions\" id=\"assumptions\"></a>Assumptions</h4>\r\n\r\n<ul>\r\n\t<li>SAF and Voice Auth support only Credit Card flows.&nbsp;&nbsp;</li>\r\n\t<li>\r\n\t<p style=\"margin-bottom: 0px;\">SAF and Voice Auth flows are supported in MX and e355 devices.</p>\r\n\t</li>\r\n\t<li>\r\n\t<p style=\"margin-bottom: 0px;\">Payment collecting devices (payment terminal) has the capability to determine when to move to SAF flow.</p>\r\n\t</li>\r\n\t<li>\r\n\t<p style=\"margin-bottom: 0px;\">SAF / Voice Auth can take place when the application is online, not necessarily in Resilient Cloud (edge) mode, since connection to the Authorizer can be lost even if while connected to Central Cloud.</p>\r\n\t</li>\r\n\t<li>\r\n\t<p style=\"margin-bottom: 0px;\">There is no limit to the amount authorized via voice authorization.</p>\r\n\t</li>\r\n</ul>\r\n\r\n<h4 style=\"margin-bottom: 0px;\"><a name=\"handling-returns-and-refunds\" id=\"handling-returns-and-refunds\"></a>Handling returns and Refunds</h4>\r\n\r\n<p>&nbsp;</p>\r\n\r\n<p style=\"margin-bottom: 0px;\">Handling Returns and Refunds - Sale transaction created online/ resilient cloud, being returned in&nbsp;resilient cloud.</p>\r\n\r\n<p>In case of resilient cloud, system does not allow scanning orders being returned as the central database is not available to fetch the original order details.&nbsp; Hence, all returns go as standalone/non-validated.&nbsp; The refund tender options vary from the normal ones.&nbsp; Only those tender types which can be processed in resilient cloud get listed.&nbsp; This is driven of the configuration listed in below section.&nbsp;&nbsp;</p>\r\n\r\n<p>Process flow:</p>\r\n\r\n<ul>\r\n\t<li>Return order is created with no <span style=\"display: inline !important; float: none; background-color: rgb(255, 255, 255); color: rgb(61, 61, 61); font-family: &quot;Open Sans&quot;,Arial,Helvetica,sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: 450; letter-spacing: normal; line-height: 160%; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;\">parent</span> order reference.</li>\r\n\t<li>Customer may choose to buy more items while returning.</li>\r\n\t<li>Once done, transaction is ready for tendering or refund</li>\r\n\t<li>System gets the list of tender types with permitInOffline=True</li>\r\n\t<li>Process refund/payments</li>\r\n</ul>\r\n\r\n<p><img height=\"261\" src=\"https://dzf8vqv24eqhg.cloudfront.net/userfiles/4665/7671/ckfinder/images/OfflineRefund.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9kemY4dnF2MjRlcWhnLmNsb3VkZnJvbnQubmV0L3VzZXJmaWxlcy80NjY1Lzc2NzEvY2tmaW5kZXIvaW1hZ2VzL09mZmxpbmVSZWZ1bmQucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzU0NzU0MDU3fX19XX0_&Signature=qxk~iQIUHjMa1SA9-QWXt1Ijm~FdYtWgtGQzyPcpsIfjrXixMukamIrq3wJYqTS40I64qvhNxD0cP-~gVnEGbDVAQJHmCsfIz4ybL92tSb7EsYPtMUxzfrB5o9GNLhOiezNLTB28DEtQ8KJVdNuPzbqKc0OcjM3~UNFHYhgl35rzm8PwSwtEnwfaz65dAYPqqy884ENwM5gP9al~Bom-dWQ74qmzDZtFfMGgg7C9sbvEWSLatDYOV~rPzv~JRxiV5A66fWCrAVuRxNlJTnm~YOHH6b8KKn7w~tPmBldxXOUe9UzZVVsVn3pKSukayYOQ71LjpzeNCUEPv9fCfgf0sw__&Key-Pair-Id=K2TK3EG287XSFC\" width=\"1600\" /></p>\r\n\r\n<h5 class=\"auto-cursor-target\">Handling Returns and Refunds - Sale transaction created online/ resilient cloud, being returned in Online</h5>\r\n\r\n<p>A return order in online application&nbsp;can be created against a sale created in online or resilient cloud.&nbsp; For the ones completed online, refunds may occur using the original transaction codes of the card payments.&nbsp; For the ones completed in resilient cloud, refunds of the original payment transactions may not happen due to unavailability of the codes to process the follow-on transactions.&nbsp; A new configuration is added in payment type which controls the refund process which controls the refund behavior of the payments captured in edge mode.&nbsp; The default value is to create a New payment method, which prevents follow on processing by payment systems.&nbsp; The new payment method&nbsp;is processed by POS application based on the tender type.&nbsp; If credit card, customer is prompted to swipe the card to which the amount is to be refunded.</p>\r\n\r\n<p>Process flow:</p>\r\n\r\n<ul>\r\n\t<li>Return order is created with and/or with no parent order reference.&nbsp; Original sale is completed in online or offline application.</li>\r\n\t<li>User chooses Process Refund.&nbsp;</li>\r\n\t<li>New payment method is created if capturedInEdgeMode=True on the <span style=\"text-align: left; color: rgb(61, 61, 61); text-transform: none; line-height: 160%; text-indent: 0px; letter-spacing: normal; font-family: &quot;Open Sans&quot;,Arial,Helvetica,sans-serif; font-size: 12px; font-style: normal; font-variant: normal; text-decoration: none; word-spacing: 0px; display: inline !important; white-space: normal; orphans: 2; float: none; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\">parent</span> payment method.</li>\r\n\t<li>POS UI prompts the user to complete by swiping the card to be refunded with.&nbsp;&nbsp;</li>\r\n\t<li>The tenders which were completed in online go through&nbsp;&nbsp;follow on refund using original approval code.</li>\r\n</ul>\r\n\r\n<div class=\"info\">Auto reversal of SAF transactions is not supported in payware.</div>\r\n\r\n<ul>\r\n\t<li>\r\n\t<p><strong>Post Void with POS Online and Payment Terminal Offline</strong>: If a SAF payment is made and the user tries to post void while the POS is online and the payment terminal is offline, the payment reversal will fail, but the order will still be voided. Retailers should handle this outside the Manhattan Active&reg; Omni POS system.</p>\r\n\t</li>\r\n\t<li>\r\n\t<p><strong>Post Void with POS and Terminal Offline (Edge Mode)</strong>: In Edge mode, the post void option is unavailable. If the user switches to online mode, the system will prevent post voiding orders created in offline mode based on the &quot;IsCapturedInOffline&quot; flag.</p>\r\n\t</li>\r\n</ul>\r\n\r\n<h4><a name=\"configurations\" id=\"configurations\"></a>Configurations</h4>\r\n\r\n<div>Following configuration is added to&nbsp;&nbsp;<em>posStoreConfigurations&gt;&gt;storeCommonConfig </em>to enable Voice Authorization</div>\r\n\r\n<div>&nbsp;</div>\r\n\r\n<div>&nbsp;</div>\r\n\r\n<div>\r\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 753px;\">\r\n\t<thead>\r\n\t\t<tr>\r\n\t\t\t<th scope=\"col\" style=\"width: 434px;\">Store common config</th>\r\n\t\t\t<th scope=\"col\" style=\"width: 559px;\">Purpose</th>\r\n\t\t</tr>\r\n\t</thead>\r\n\t<tbody>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 431px;\">permitVoiceAuthorization</td>\r\n\t\t\t<td style=\"width: 556px;\">\r\n\t\t\t<p>If this option is set to True, POS UI application prompts the user to contact the payment support center to get the offline authorization by calling the support number.&nbsp; If set to False, this prompt does not appear.&nbsp; Application displays an error message,&nbsp;&ldquo;SAF Transaction amount limit exceeded. Transaction declined&rdquo;. There are no changes to the tenders.&nbsp; Default value=True.</p>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 431px;\">&nbsp;</td>\r\n\t\t\t<td style=\"width: 556px;\">&nbsp;</td>\r\n\t\t</tr>\r\n\t</tbody>\r\n</table>\r\n\r\n<p>Following configuration is added to&nbsp;paycaptureconfig to indicate if the payment type can be processed when the application is running in offline mode.</p>\r\n\r\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 753px;\">\r\n\t<thead>\r\n\t\t<tr>\r\n\t\t\t<th scope=\"col\" style=\"width: 338px;\">payCaptureConfig</th>\r\n\t\t\t<th scope=\"col\" style=\"width: 383px;\">Purpose</th>\r\n\t\t</tr>\r\n\t</thead>\r\n\t<tbody>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 336px;\">permitInOffline</td>\r\n\t\t\t<td style=\"width: 380px;\">This flag indicates if the payment method can be processed in offline mode.&nbsp; This is relevant to customer present flows.&nbsp; Typically, Cash and Credit card are the tender types supported in offline application.&nbsp; Default is False.&nbsp;&nbsp;</td>\r\n\t\t</tr>\r\n\t</tbody>\r\n</table>\r\n\r\n<h4 style=\"margin-top: 0px; margin-right: 0px; margin-left: 0px; padding: 0px;\">&nbsp;</h4>\r\n\r\n<p>Following configuration is added in paymentType to handle refund processing if original sale was completed in offline.&nbsp;&nbsp;</p>\r\n\r\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 753px;\">\r\n\t<thead>\r\n\t\t<tr>\r\n\t\t\t<th scope=\"col\" style=\"width: 338px;\">paymentType&nbsp;</th>\r\n\t\t\t<th scope=\"col\" style=\"width: 384px;\">Purpose</th>\r\n\t\t</tr>\r\n\t</thead>\r\n\t<tbody>\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 335px;\">refundBehaviorForEdge</td>\r\n\t\t\t<td style=\"width: 381px;\">Defines how the refunds is processed if payment is completed in edge mode.&nbsp; This is used where <span style=\"text-align: left; color: rgb(61, 61, 61); text-transform: none; line-height: 160%; text-indent: 0px; letter-spacing: normal; font-family: &quot;Open Sans&quot;,Arial,Helvetica,sans-serif; font-size: 12px; font-style: normal; font-variant: normal; text-decoration: none; word-spacing: 0px; display: inline !important; white-space: normal; orphans: 2; float: none; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);\">parent</span> paymentMethod.capturedInEdgeMode=True.&nbsp; Default value is &quot;New Payment Method&quot;.&nbsp;&nbsp;</td>\r\n\t\t</tr>\r\n\t</tbody>\r\n</table>\r\n\r\n<div style=\"color: rgb(0, 0, 0); background-color: rgb(255, 255, 254); font-family: SFMono-Medium, &quot;SF Mono&quot;, &quot;Segoe UI Mono&quot;, &quot;Roboto Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 13px; line-height: 18px; white-space: pre;\">\r\n<div style=\"color: rgb(0, 0, 0); background-color: rgb(255, 255, 254); font-family: SFMono-Medium, &quot;SF Mono&quot;, &quot;Segoe UI Mono&quot;, &quot;Roboto Mono&quot;, &quot;Ubuntu Mono&quot;, Menlo, monospace; font-size: 13px; line-height: 18px; white-space: pre;\">\r\n<div>&nbsp;</div>\r\n</div>\r\n</div>\r\n</div>\r\n\r\n\t  </div>\r\n </div>\r\n <div id=\"ui-page-fb-wrap\"></div>\r\n <div class=\"hiq-footer-wrap\">\r\n    \r\n                \r\n  </div>\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n\r\n\r\n",
  "content_length": 15817,
  "scraped_at": "2025-08-09T22:35:57.989743"
}